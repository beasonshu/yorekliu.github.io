<!--
  Copyright (c) 2016-2020 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="An Android Developer."><link href=https://blog.yorek.xyz/about-me/android/other/琐碎知识点/ rel=canonical><meta name=author content="Yorek Liu"><meta name=lang:clipboard.copy content=复制><meta name=lang:clipboard.copied content=已复制><meta name=lang:search.language content=ja><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content=没有找到符合条件的结果><meta name=lang:search.result.one content="找到 1 个符合条件的结果"><meta name=lang:search.result.other content="# 个符合条件的结果"><meta name=lang:search.tokenizer content=[\uff0c\u3002]+><link rel="shortcut icon" href=../../../assets/images/favicon.ico><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.6.0"><title>琐碎知识点</title><link rel=stylesheet href=../../../assets/stylesheets/application.1b62728e.css><link rel=stylesheet href=../../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content><script src=../../../assets/javascripts/modernizr.268332fc.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../assets/fonts/material-icons.css><link rel=manifest href=../../../manifest.webmanifest><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-155096376-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script><!-- Determine title --><!-- The image needs to have an absolute URL --><!-- Open graph meta tags --><meta property=og:type content=website><meta property=og:title content="Yorek's - 琐碎知识点"><meta property=og:description content="An Android Developer."><meta content=https://blog.yorek.xyz/about-me/android/other/琐碎知识点/ property=og:url><meta property=og:image content=https://blog.yorek.xyz/about-meassets/images/banner.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><!-- Twitter meta tags --><meta name=twitter:card content=summary_large_image><meta name=twitter:site content=@squidfunk><meta name=twitter:creator content=@squidfunk><meta name=twitter:title content="Yorek's - 琐碎知识点"><meta name=twitter:description content="An Android Developer."><meta name=twitter:image content=https://blog.yorek.xyz/about-meassets/images/banner.png></head> <body dir=ltr data-md-color-primary=white data-md-color-accent=blue> <svg class=md-svg> <defs> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#copyonwritearraylist tabindex=1 class=md-skip> 跳转至 </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://blog.yorek.xyz/about-me title="Yorek's" class="md-header-nav__button md-logo"> <img src=../../../assets/images/favicon.ico width=24 height=24> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Yorek's </span> <span class=md-header-nav__topic> 琐碎知识点 </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> 键入以开始搜索 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../3rd-library/3rd-library-source-code/ class=md-tabs__link> Android </a> </li> <li class=md-tabs__item> <a href=../../../flutter/flutter_first_project_1/ class=md-tabs__link> Flutter </a> </li> <li class=md-tabs__item> <a href=../../../leetcode/ class=md-tabs__link> LeetCode </a> </li> <li class=md-tabs__item> <a href=../../../design-pattern/design-pattern/ class=md-tabs__link> Books </a> </li> </ul> </div> </nav> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://blog.yorek.xyz/about-me title="Yorek's" class="md-nav__button md-logo"> <img src=../../../assets/images/favicon.ico width=48 height=48> </a> Yorek's </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. title=Home class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> Android </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Android </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-1 type=checkbox id=nav-2-1> <label class=md-nav__link for=nav-2-1> 三方库源码解析 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-1> 三方库源码解析 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../3rd-library/3rd-library-source-code/ title=Android三方库源码分析 class=md-nav__link> Android三方库源码分析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/matrix/ title="微信APM Matrix解析" class=md-nav__link> 微信APM Matrix解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/matrix-trace/ title=Matrix-TraceCanary解析 class=md-nav__link> Matrix-TraceCanary解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/matrix-io/ title=Matrix-IOCanary解析 class=md-nav__link> Matrix-IOCanary解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/matrix-resource/ title=Matrix-ResourceCanary解析 class=md-nav__link> Matrix-ResourceCanary解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/matrix-sqlitelint/ title=Matrix-SQLiteLint解析 class=md-nav__link> Matrix-SQLiteLint解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/okhttp/ title=OkHttp3源码解析 class=md-nav__link> OkHttp3源码解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/retrofit/ title=Retrofit2源码解析 class=md-nav__link> Retrofit2源码解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/rxjava&rxandroid/ title=RxJava源码解析及使用实例 class=md-nav__link> RxJava源码解析及使用实例 </a> </li> <li class=md-nav__item> <a href=../RxJava/ title=RxJava操作符大全 class=md-nav__link> RxJava操作符大全 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide1/ title="Glide v4 源码解析（一）" class=md-nav__link> Glide v4 源码解析（一） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide2/ title="Glide v4 源码解析（二）" class=md-nav__link> Glide v4 源码解析（二） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide3/ title="Glide v4 源码解析（三）" class=md-nav__link> Glide v4 源码解析（三） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide4/ title="Glide v4 源码解析（四）" class=md-nav__link> Glide v4 源码解析（四） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide5/ title="Glide v4 源码解析（五）" class=md-nav__link> Glide v4 源码解析（五） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide6/ title="Glide v4 源码解析（六）" class=md-nav__link> Glide v4 源码解析（六） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide7/ title="Glide v4 源码解析（七）" class=md-nav__link> Glide v4 源码解析（七） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/migrate-to-glide/ title=杂记：从Picasso迁移至Glide class=md-nav__link> 杂记：从Picasso迁移至Glide </a> </li> <li class=md-nav__item> <a href=../../3rd-library/eventbus/ title=EventBus源码解析 class=md-nav__link> EventBus源码解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/leakcanary/ title=LeakCanary2源码解析 class=md-nav__link> LeakCanary2源码解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/permissiondispatcher/ title=PermissionDispatcher源码解析 class=md-nav__link> PermissionDispatcher源码解析 </a> </li> <li class=md-nav__item> <a href=../constraintlayout/ title=ConstraintLayout使用大全 class=md-nav__link> ConstraintLayout使用大全 </a> </li> <li class=md-nav__item> <a href=../dagger2/ title=初学者的Dagger2教程 class=md-nav__link> 初学者的Dagger2教程 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-2 type=checkbox id=nav-2-2> <label class=md-nav__link for=nav-2-2> Android开发高手课 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-2> Android开发高手课 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../paid/master/ title=Android开发高手课 class=md-nav__link> Android开发高手课 </a> </li> <li class=md-nav__item> <a href=../../paid/master/crash_1/ title="01 | 崩溃优化（上）：关于“崩溃”那些事儿" class=md-nav__link> 01 | 崩溃优化（上）：关于“崩溃”那些事儿 </a> </li> <li class=md-nav__item> <a href=../../paid/master/crash_2/ title="02 | 崩溃优化（下）：应用崩溃了，你应该如何去分析？" class=md-nav__link> 02 | 崩溃优化（下）：应用崩溃了，你应该如何去分析？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/memory_1/ title="03 | 内存优化（上）：4GB内存时代，再谈内存优化" class=md-nav__link> 03 | 内存优化（上）：4GB内存时代，再谈内存优化 </a> </li> <li class=md-nav__item> <a href=../../paid/master/memory_2/ title="04 | 内存优化（下）：内存优化这件事，应该从哪里着手？" class=md-nav__link> 04 | 内存优化（下）：内存优化这件事，应该从哪里着手？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/stuck_1/ title="05 | 卡顿优化（上）：你要掌握的卡顿分析方法" class=md-nav__link> 05 | 卡顿优化（上）：你要掌握的卡顿分析方法 </a> </li> <li class=md-nav__item> <a href=../../paid/master/stuck_2/ title="06 | 卡顿优化（下）：如何监控应用卡顿？" class=md-nav__link> 06 | 卡顿优化（下）：如何监控应用卡顿？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/stuck_3/ title="06补充篇 | 卡顿优化：卡顿现场与卡顿分析" class=md-nav__link> 06补充篇 | 卡顿优化：卡顿现场与卡顿分析 </a> </li> <li class=md-nav__item> <a href=../../paid/master/start_1/ title="07 | 启动优化（上）：从启动过程看启动速度优化" class=md-nav__link> 07 | 启动优化（上）：从启动过程看启动速度优化 </a> </li> <li class=md-nav__item> <a href=../../paid/master/start_2/ title="08 | 启动优化（下）：优化启动速度的进阶方法" class=md-nav__link> 08 | 启动优化（下）：优化启动速度的进阶方法 </a> </li> <li class=md-nav__item> <a href=../../paid/master/io_1/ title="09 | I/O优化（上）：开发工程师必备的I/O优化知识" class=md-nav__link> 09 | I/O优化（上）：开发工程师必备的I/O优化知识 </a> </li> <li class=md-nav__item> <a href=../../paid/master/io_2/ title="10 | I/O优化（中）：不同I/O方式的使用场景是什么？" class=md-nav__link> 10 | I/O优化（中）：不同I/O方式的使用场景是什么？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/io_3/ title="11 | I/O优化（下）：如何监控线上I/O操作？" class=md-nav__link> 11 | I/O优化（下）：如何监控线上I/O操作？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/storage_1/ title="12 | 存储优化（上）：常见的数据存储方法有哪些？" class=md-nav__link> 12 | 存储优化（上）：常见的数据存储方法有哪些？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/storage_2/ title="13 | 存储优化（中）：如何优化数据存储？" class=md-nav__link> 13 | 存储优化（中）：如何优化数据存储？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/storage_3/ title="14 | 存储优化（下）：数据库SQLite的使用和优化" class=md-nav__link> 14 | 存储优化（下）：数据库SQLite的使用和优化 </a> </li> <li class=md-nav__item> <a href=../../paid/master/network_1/ title="15 | 网络优化（上）：移动开发工程师必备的网络优化知识" class=md-nav__link> 15 | 网络优化（上）：移动开发工程师必备的网络优化知识 </a> </li> <li class=md-nav__item> <a href=../../paid/master/network_2/ title="16 | 网络优化（中）：复杂多变的移动网络该如何优化？" class=md-nav__link> 16 | 网络优化（中）：复杂多变的移动网络该如何优化？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/network_3/ title="17 | 网络优化（下）：大数据下网络该如何监控？" class=md-nav__link> 17 | 网络优化（下）：大数据下网络该如何监控？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/battery_1/ title="18 | 耗电优化（上）：从电量优化的演进看耗电分析" class=md-nav__link> 18 | 耗电优化（上）：从电量优化的演进看耗电分析 </a> </li> <li class=md-nav__item> <a href=../../paid/master/battery_2/ title="19 | 耗电优化（下）：耗电的优化方法与线上监控" class=md-nav__link> 19 | 耗电优化（下）：耗电的优化方法与线上监控 </a> </li> <li class=md-nav__item> <a href=../../paid/master/ui_1/ title="20 | UI 优化（上）：UI 渲染的几个关键概念" class=md-nav__link> 20 | UI 优化（上）：UI 渲染的几个关键概念 </a> </li> <li class=md-nav__item> <a href=../../paid/master/ui_2/ title="21 | UI 优化（下）：如何优化 UI 渲染？" class=md-nav__link> 21 | UI 优化（下）：如何优化 UI 渲染？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/package_1/ title="22 | 包体积优化（上）：如何减少安装包大小？" class=md-nav__link> 22 | 包体积优化（上）：如何减少安装包大小？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/package_2/ title="23 | 包体积优化（下）：资源优化的进阶实践" class=md-nav__link> 23 | 包体积优化（下）：资源优化的进阶实践 </a> </li> <li class=md-nav__item> <a href=../../paid/master/compile/ title="26 | 关于编译，你需要了解什么？" class=md-nav__link> 26 | 关于编译，你需要了解什么？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/bytecode/ title="27 | 编译插桩的三种方法：AspectJ、ASM、ReDex" class=md-nav__link> 27 | 编译插桩的三种方法：AspectJ、ASM、ReDex </a> </li> <li class=md-nav__item> <a href=../../paid/master/native_hook/ title="35 | Native Hook 技术，天使还是魔鬼？" class=md-nav__link> 35 | Native Hook 技术，天使还是魔鬼？ </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-3 type=checkbox id=nav-2-3> <label class=md-nav__link for=nav-2-3> Framework系列 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-3> Framework系列 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../framework/Android四大组件(1)/ title=Activity class=md-nav__link> Activity </a> </li> <li class=md-nav__item> <a href=../../framework/Android四大组件(2)/ title=Service class=md-nav__link> Service </a> </li> <li class=md-nav__item> <a href=../../framework/Android四大组件(3)/ title=Broadcasts class=md-nav__link> Broadcasts </a> </li> <li class=md-nav__item> <a href=../../framework/Android四大组件(4)/ title="Content Providers与Fragment" class=md-nav__link> Content Providers与Fragment </a> </li> <li class=md-nav__item> <a href=../../framework/IPC机制/ title=IPC机制 class=md-nav__link> IPC机制 </a> </li> <li class=md-nav__item> <a href=../../framework/View的事件体系/ title=View的事件体系 class=md-nav__link> View的事件体系 </a> </li> <li class=md-nav__item> <a href=../../framework/View的绘制原理/ title=View的绘制原理 class=md-nav__link> View的绘制原理 </a> </li> <li class=md-nav__item> <a href=../../framework/RemoteViews/ title=RemoteViews class=md-nav__link> RemoteViews </a> </li> <li class=md-nav__item> <a href=../../framework/Drawable/ title=Android中的Drawable资源 class=md-nav__link> Android中的Drawable资源 </a> </li> <li class=md-nav__item> <a href=../../framework/Android动画/ title=Android动画 class=md-nav__link> Android动画 </a> </li> <li class=md-nav__item> <a href=../../framework/Window与WindowManager/ title=Window与WindowManager class=md-nav__link> Window与WindowManager </a> </li> <li class=md-nav__item> <a href=../../framework/四大组件启动过程/ title=四大组件启动过程 class=md-nav__link> 四大组件启动过程 </a> </li> <li class=md-nav__item> <a href=../../framework/Android消息机制/ title=Android消息机制 class=md-nav__link> Android消息机制 </a> </li> <li class=md-nav__item> <a href=../../framework/Android线程与线程池/ title=Android线程与线程池 class=md-nav__link> Android线程与线程池 </a> </li> <li class=md-nav__item> <a href=../../framework/Bitmap的缓存与加载/ title=Bitmap的缓存与加载 class=md-nav__link> Bitmap的缓存与加载 </a> </li> <li class=md-nav__item> <a href=../../framework/JNI与NDK/ title=JNI与NDK编程简介 class=md-nav__link> JNI与NDK编程简介 </a> </li> <li class=md-nav__item> <a href=../../framework/性能优化/ title=Android性能优化 class=md-nav__link> Android性能优化 </a> </li> <li class=md-nav__item> <a href=../../framework/binder1-mediaservice/ title=Binder深入理解——以MediaService为例 class=md-nav__link> Binder深入理解——以MediaService为例 </a> </li> <li class=md-nav__item> <a href=../../framework/binder2/ title=Binder深入理解——罗老师系列 class=md-nav__link> Binder深入理解——罗老师系列 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-4 type=checkbox id=nav-2-4> <label class=md-nav__link for=nav-2-4> 付费知识归档 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-4> 付费知识归档 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-4-1 type=checkbox id=nav-2-4-1> <label class=md-nav__link for=nav-2-4-1> 某圈问题索引 </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-2-4-1> 某圈问题索引 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../paid/zsxq/zsxq_index/ title=某圈问题索引 class=md-nav__link> 某圈问题索引 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week1-synchronized/ title=理解Java中synchronized关键词 class=md-nav__link> 理解Java中synchronized关键词 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week2-service/ title=理解Service class=md-nav__link> 理解Service </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week3-activity/ title=理解Activity的启动模式 class=md-nav__link> 理解Activity的启动模式 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week4-startActivityForResult/ title=关于startActivityForResult class=md-nav__link> 关于startActivityForResult </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week5-view/ title=关于View的知识 class=md-nav__link> 关于View的知识 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week6-gradle/ title=关于Gradle的知识 class=md-nav__link> 关于Gradle的知识 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week7-serialization/ title=关于序列化的知识 class=md-nav__link> 关于序列化的知识 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week10-classloader/ title=Android中的ClassLoader class=md-nav__link> Android中的ClassLoader </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week11-binder/ title=Binder简介 class=md-nav__link> Binder简介 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week12-retrofit-okhttp/ title=OkHttp和Retrofit的作用以及两者之间的联系 class=md-nav__link> OkHttp和Retrofit的作用以及两者之间的联系 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week14-jvm-gc/ title=JVM中垃圾回收策略 class=md-nav__link> JVM中垃圾回收策略 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week16-keep-app-alive/ title=进程保活 class=md-nav__link> 进程保活 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week17-android-components/ title=四大组件的作用以及多进程 class=md-nav__link> 四大组件的作用以及多进程 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week20-network-protocol/ title=网络协议 class=md-nav__link> 网络协议 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week21-mvc&amp;mvp&mvvm/ title=MVC、MVP和MVVM class=md-nav__link> MVC、MVP和MVVM </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week22-android-studio-build/ title="Android Studio build过程" class=md-nav__link> Android Studio build过程 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week23-load-large-bitmap/ title=大尺寸图片加载问题 class=md-nav__link> 大尺寸图片加载问题 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-5 type=checkbox id=nav-2-5 checked> <label class=md-nav__link for=nav-2-5> 日常记录 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-5> 日常记录 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../annotation/ title=注解的定义及解析 class=md-nav__link> 注解的定义及解析 </a> </li> <li class=md-nav__item> <a href=../best_throttle_in_mvvm/ title=这可能是MVVM中最优雅的按键防抖方案 class=md-nav__link> 这可能是MVVM中最优雅的按键防抖方案 </a> </li> <li class=md-nav__item> <a href=../android-jenkins/ title="Jenkins for android" class=md-nav__link> Jenkins for android </a> </li> <li class=md-nav__item> <a href=../SystemProrities/ title=普通Android程序使用SystemProrities class=md-nav__link> 普通Android程序使用SystemProrities </a> </li> <li class=md-nav__item> <a href=../recyclerview-cache/ title=ListView、RecyclerView缓存策略解析 class=md-nav__link> ListView、RecyclerView缓存策略解析 </a> </li> <li class=md-nav__item> <a href=../recyclerview-item-docoration/ title=RecyclerView高级特性——ItemDecoration class=md-nav__link> RecyclerView高级特性——ItemDecoration </a> </li> <li class=md-nav__item> <a href=../recyclerview-others/ title=RecyclerView的一些使用细节 class=md-nav__link> RecyclerView的一些使用细节 </a> </li> <li class=md-nav__item> <a href=../RecyclerView-Sort&Delete/ title=RecyclerView高级特性——拖拽排序以及滑动删除 class=md-nav__link> RecyclerView高级特性——拖拽排序以及滑动删除 </a> </li> <li class=md-nav__item> <a href=../FAB-Behavior/ title=FloatingActionButton上滑隐藏下滑显示 class=md-nav__link> FloatingActionButton上滑隐藏下滑显示 </a> </li> <li class=md-nav__item> <a href=../nestedscrolling/ title=NestedScrolling机制 class=md-nav__link> NestedScrolling机制 </a> </li> <li class=md-nav__item> <a href=../porterduff/ title=使用Porter-Duff合成数字图像 class=md-nav__link> 使用Porter-Duff合成数字图像 </a> </li> <li class=md-nav__item> <a href=../runtime/ title="Android Runtime" class=md-nav__link> Android Runtime </a> </li> <li class=md-nav__item> <a href=../android_alias/ title=Android马甲包的那些事儿 class=md-nav__link> Android马甲包的那些事儿 </a> </li> <li class=md-nav__item> <a href=../Android-Development-Tool/ title=Android神兵利器 class=md-nav__link> Android神兵利器 </a> </li> <li class=md-nav__item> <a href=../FileProvider/ title=FileProvider class=md-nav__link> FileProvider </a> </li> <li class=md-nav__item> <a href=../Android判断导航栏高度/ title=Android判断虚拟按键(导航栏)显示与否、高度以及获取屏幕实际高度 class=md-nav__link> Android判断虚拟按键(导航栏)显示与否、高度以及获取屏幕实际高度 </a> </li> <li class=md-nav__item> <a href=../Android图片选择器/ title=Android图片选择器 class=md-nav__link> Android图片选择器 </a> </li> <li class=md-nav__item> <a href=../Android底部导航栏框架/ title=Android原生底部导航栏 class=md-nav__link> Android原生底部导航栏 </a> </li> <li class=md-nav__item> <a href=../Android搜索栏的实现/ title=Android搜索栏的实现 class=md-nav__link> Android搜索栏的实现 </a> </li> <li class=md-nav__item> <a href=../Android暂停音乐播放器的播放/ title=Android暂停酷狗、网易云音乐等音乐播放器的播放 class=md-nav__link> Android暂停酷狗、网易云音乐等音乐播放器的播放 </a> </li> <li class=md-nav__item> <a href=../Android滑动返回实践/ title=Android滑动返回实践 class=md-nav__link> Android滑动返回实践 </a> </li> <li class=md-nav__item> <a href=../Android程序反编译/ title=MacOS下Android程序反编译 class=md-nav__link> MacOS下Android程序反编译 </a> </li> <li class=md-nav__item> <a href=../Android通讯录快速读取/ title=Android通讯录快速读取 class=md-nav__link> Android通讯录快速读取 </a> </li> <li class=md-nav__item> <a href=../soft-keyboard-in-app/ title=App内自定义软键盘 class=md-nav__link> App内自定义软键盘 </a> </li> <li class=md-nav__item> <a href=../腾讯X5内核入坑指南/ title="腾讯TBS X5浏览器内核入坑指南" class=md-nav__link> 腾讯TBS X5浏览器内核入坑指南 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 琐碎知识点 </label> <a href=./ title=琐碎知识点 class="md-nav__link md-nav__link--active"> 琐碎知识点 </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>目录</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#copyonwritearraylist class=md-nav__link> CopyOnWriteArrayList </a> </li> <li class=md-nav__item> <a href=#remotecallbacklist class=md-nav__link> RemoteCallbackList </a> </li> <li class=md-nav__item> <a href=#androidwindowsoftinputmode class=md-nav__link> android:windowSoftInputMode </a> </li> <li class=md-nav__item> <a href=#intent class=md-nav__link> 常用Intent </a> </li> <li class=md-nav__item> <a href=#collectionssort class=md-nav__link> Collections.sort </a> </li> <li class=md-nav__item> <a href=#gif class=md-nav__link> Gif加载 </a> </li> <li class=md-nav__item> <a href=#drawable class=md-nav__link> 代码设置drawable </a> </li> <li class=md-nav__item> <a href=#responsebodystring class=md-nav__link> response.body().string()只能调用一次 </a> </li> <li class=md-nav__item> <a href=#glide class=md-nav__link> Glide加载圆形图片 </a> </li> <li class=md-nav__item> <a href=#tab3 class=md-nav__link> 好人好信Tab3下拉冲突问题 </a> </li> <li class=md-nav__item> <a href=#android class=md-nav__link> Android中字体的加载 </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 判断应用通知权限是否打开 </a> </li> <li class=md-nav__item> <a href=#viewpager class=md-nav__link> ViewPager实现画廊效果 </a> </li> <li class=md-nav__item> <a href=#splash class=md-nav__link> 全面屏Splash以及广告页适配指北 </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 震动反馈 </a> </li> <li class=md-nav__item> <a href=#android-50 class=md-nav__link> Android 5.0 平台共享元素动画 </a> </li> <li class=md-nav__item> <a href=#webviewjs class=md-nav__link> 向WebView注入本地JS并调用 </a> </li> <li class=md-nav__item> <a href=#navigationview class=md-nav__link> NavigationView菜单分割线 </a> </li> <li class=md-nav__item> <a href=#cardview class=md-nav__link> CardView背景色 </a> </li> <li class=md-nav__item> <a href=#attrid class=md-nav__link> 从attr中提取资源id </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 跳微信扫一扫 </a> </li> <li class=md-nav__item> <a href=#radiogroup class=md-nav__link> RadioGroup互斥 </a> </li> <li class=md-nav__item> <a href=#flatdiraar class=md-nav__link> 不flatDir使用aar包 </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 自定义资源目录 </a> </li> <li class=md-nav__item> <a href=#gradle class=md-nav__link> 修改gradle输出包的名字 </a> </li> <li class=md-nav__item> <a href=#gradle-copy class=md-nav__link> gradle copy函数 </a> </li> <li class=md-nav__item> <a href=#scrollviewscrollbar class=md-nav__link> ScrollView始终显示scrollbar </a> </li> <li class=md-nav__item> <a href=#alertdialog class=md-nav__link> AlertDialog消息换行 </a> </li> <li class=md-nav__item> <a href=#accentcolor class=md-nav__link> accentColor </a> </li> <li class=md-nav__item> <a href=#zipunzip class=md-nav__link> zip/unzip </a> </li> <li class=md-nav__item> <a href=#maclauncher class=md-nav__link> Mac调整Launcher行列数 </a> </li> <li class=md-nav__item> <a href=#okhttp class=md-nav__link> OkHttp下载文件 </a> </li> <li class=md-nav__item> <a href=#monkey class=md-nav__link> monkey测试： </a> </li> <li class=md-nav__item> <a href=#app class=md-nav__link> App物料尺寸 </a> </li> <li class=md-nav__item> <a href=#statusbarnavigationbar class=md-nav__link> StatusBar和NavigationBar完全透明 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 查看签名证书信息 </a> </li> <li class=md-nav__item> <a href=#dynamic-permission class=md-nav__link> Dynamic Permission </a> </li> <li class=md-nav__item> <a href=#google-chromedarkmode class=md-nav__link> Google Chrome强制禁用darkmode </a> </li> <li class=md-nav__item> <a href=#anr class=md-nav__link> ANR的判定 </a> </li> <li class=md-nav__item> <a href=#recyclerview class=md-nav__link> RecyclerView是否到顶部 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 判断程序是否运行在主进程 </a> </li> <li class=md-nav__item> <a href=#drawable2bitmap class=md-nav__link> Drawable2Bitmap </a> </li> <li class=md-nav__item> <a href=#gravity class=md-nav__link> Gravity的妙用 </a> </li> <li class=md-nav__item> <a href=#9patch class=md-nav__link> 9patch </a> </li> <li class=md-nav__item> <a href=#__comments class="md-nav__link md-nav__link--active"> 评论 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> Flutter </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Flutter </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../flutter/flutter_first_project_1/ title=年轻人的第一个Flutter程序(1) class=md-nav__link> 年轻人的第一个Flutter程序(1) </a> </li> <li class=md-nav__item> <a href=../../../flutter/flutter_first_project_2/ title=年轻人的第一个Flutter程序(2) class=md-nav__link> 年轻人的第一个Flutter程序(2) </a> </li> <li class=md-nav__item> <a href=../../../flutter/flutter_first_project_3/ title=年轻人的第一个Flutter程序(3) class=md-nav__link> 年轻人的第一个Flutter程序(3) </a> </li> <li class=md-nav__item> <a href=../../../flutter/flutter_first_project_4/ title=年轻人的第一个Flutter程序(4) class=md-nav__link> 年轻人的第一个Flutter程序(4) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> LeetCode </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> LeetCode </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../leetcode/ title=算法目录 class=md-nav__link> 算法目录 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/code_interviews_1/ title=数据结构、算法和数据操作 class=md-nav__link> 数据结构、算法和数据操作 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/code_interviews_3/ title=高质量的代码 class=md-nav__link> 高质量的代码 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/code_interviews_4/ title=解决问题的思路 class=md-nav__link> 解决问题的思路 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/code_interviews_5/ title=优化时间和空间效率 class=md-nav__link> 优化时间和空间效率 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/code_interviews_6/ title=面试中的各项能力 class=md-nav__link> 面试中的各项能力 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/array/ title=Array class=md-nav__link> Array </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode1-10/ title=LeetCode(1-10) class=md-nav__link> LeetCode(1-10) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode11-20/ title=LeetCode(11-20) class=md-nav__link> LeetCode(11-20) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode21-30/ title=LeetCode(21-30) class=md-nav__link> LeetCode(21-30) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode31-40/ title=LeetCode(31-40) class=md-nav__link> LeetCode(31-40) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode41-50/ title=LeetCode(41-50) class=md-nav__link> LeetCode(41-50) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode51-60/ title=LeetCode(51-60) class=md-nav__link> LeetCode(51-60) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode61-70/ title=LeetCode(61-70) class=md-nav__link> LeetCode(61-70) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode71-80/ title=LeetCode(71-80) class=md-nav__link> LeetCode(71-80) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode81-90/ title=LeetCode(81-90) class=md-nav__link> LeetCode(81-90) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode91-100/ title=LeetCode(91-100) class=md-nav__link> LeetCode(91-100) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode101-110/ title=LeetCode(101-110) class=md-nav__link> LeetCode(101-110) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode111-120/ title=LeetCode(111-120) class=md-nav__link> LeetCode(111-120) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Books </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Books </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-1 type=checkbox id=nav-5-1> <label class=md-nav__link for=nav-5-1> Design Pattern </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-1> Design Pattern </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../design-pattern/design-pattern/ title=设计模式概述 class=md-nav__link> 设计模式概述 </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/design-principle/ title=面向对象的六大原则 class=md-nav__link> 面向对象的六大原则 </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/singleton/ title=单例模式(Singleton) class=md-nav__link> 单例模式(Singleton) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/builder/ title=建造者模式(Builder) class=md-nav__link> 建造者模式(Builder) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/prototype/ title=原型模式(Prototype) class=md-nav__link> 原型模式(Prototype) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/factory-method/ title="工厂方法模式(Factory method)" class=md-nav__link> 工厂方法模式(Factory method) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/abstract-factory/ title="抽象工厂模式(Abstract factory)" class=md-nav__link> 抽象工厂模式(Abstract factory) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/proxy/ title=代理模式(Proxy) class=md-nav__link> 代理模式(Proxy) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/composite/ title=组合模式(Composite) class=md-nav__link> 组合模式(Composite) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/adapter/ title=适配器模式(Adapter) class=md-nav__link> 适配器模式(Adapter) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/decorator/ title=装饰模式(Decorator) class=md-nav__link> 装饰模式(Decorator) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/flyweight/ title=享元模式(Flyweight) class=md-nav__link> 享元模式(Flyweight) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/facade/ title=外观模式(Facade) class=md-nav__link> 外观模式(Facade) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/bridge/ title=桥接模式(Bridge) class=md-nav__link> 桥接模式(Bridge) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/strategy/ title=策略模式(Strategy) class=md-nav__link> 策略模式(Strategy) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/state/ title=状态模式(State) class=md-nav__link> 状态模式(State) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/chain-of-responsibility/ title="责任链模式(Chain of responsibility)" class=md-nav__link> 责任链模式(Chain of responsibility) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/interpreter/ title=解释器模式(Interpreter) class=md-nav__link> 解释器模式(Interpreter) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/command/ title=命令模式(Command) class=md-nav__link> 命令模式(Command) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/observer/ title=观察者模式(Observer) class=md-nav__link> 观察者模式(Observer) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/memento/ title=备忘录模式(Memento) class=md-nav__link> 备忘录模式(Memento) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/iterator/ title=迭代器模式(Iterator) class=md-nav__link> 迭代器模式(Iterator) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/template-method/ title="模版方法模式(Template method)" class=md-nav__link> 模版方法模式(Template method) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/visitor/ title=访问者模式(Visitor) class=md-nav__link> 访问者模式(Visitor) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/mediator/ title=中介者模式(Mediator) class=md-nav__link> 中介者模式(Mediator) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/confusing-design-pattern/ title=易混淆的设计模式 class=md-nav__link> 易混淆的设计模式 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2 type=checkbox id=nav-5-2> <label class=md-nav__link for=nav-5-2> Effective Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-2> Effective Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../effective-java/effective-java/ title="Effective Java概述" class=md-nav__link> Effective Java概述 </a> </li> <li class=md-nav__item> <a href=../../../effective-java/chapter1/ title=创建和销毁对象 class=md-nav__link> 创建和销毁对象 </a> </li> <li class=md-nav__item> <a href=../../../effective-java/chapter2/ title=对于所有对象都通用的方法 class=md-nav__link> 对于所有对象都通用的方法 </a> </li> <li class=md-nav__item> <a href=../../../effective-java/chapter3/ title=类和接口 class=md-nav__link> 类和接口 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3 type=checkbox id=nav-5-3> <label class=md-nav__link for=nav-5-3> JVM </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-3> JVM </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jvm/jvm-content/ title=深入理解Java虚拟机 class=md-nav__link> 深入理解Java虚拟机 </a> </li> <li class=md-nav__item> <a href=../../../jvm/java-memory-area-oom/ title=Java内存区域与内存溢出异常 class=md-nav__link> Java内存区域与内存溢出异常 </a> </li> <li class=md-nav__item> <a href=../../../jvm/java-gc/ title=垃圾收集器与内存分配策略 class=md-nav__link> 垃圾收集器与内存分配策略 </a> </li> <li class=md-nav__item> <a href=../../../jvm/class-struct/ title=类文件结构 class=md-nav__link> 类文件结构 </a> </li> <li class=md-nav__item> <a href=../../../jvm/load-class/ title=虚拟机类加载机制 class=md-nav__link> 虚拟机类加载机制 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-4 type=checkbox id=nav-5-4> <label class=md-nav__link for=nav-5-4> Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-4> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../java/generics-java-kotlin/ title=Java&Kotlin在泛型方面的区别 class=md-nav__link> Java&Kotlin在泛型方面的区别 </a> </li> <li class=md-nav__item> <a href=../../../java/java-collections/ title=Java集合总结 class=md-nav__link> Java集合总结 </a> </li> <li class=md-nav__item> <a href=../../../java/java-foundation/ title=Java常见概念 class=md-nav__link> Java常见概念 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-5 type=checkbox id=nav-5-5> <label class=md-nav__link for=nav-5-5> Refactoring </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-5> Refactoring </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../refactoring/refactoring/ title=重构：改善既有代码的设计 class=md-nav__link> 重构：改善既有代码的设计 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>目录</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#copyonwritearraylist class=md-nav__link> CopyOnWriteArrayList </a> </li> <li class=md-nav__item> <a href=#remotecallbacklist class=md-nav__link> RemoteCallbackList </a> </li> <li class=md-nav__item> <a href=#androidwindowsoftinputmode class=md-nav__link> android:windowSoftInputMode </a> </li> <li class=md-nav__item> <a href=#intent class=md-nav__link> 常用Intent </a> </li> <li class=md-nav__item> <a href=#collectionssort class=md-nav__link> Collections.sort </a> </li> <li class=md-nav__item> <a href=#gif class=md-nav__link> Gif加载 </a> </li> <li class=md-nav__item> <a href=#drawable class=md-nav__link> 代码设置drawable </a> </li> <li class=md-nav__item> <a href=#responsebodystring class=md-nav__link> response.body().string()只能调用一次 </a> </li> <li class=md-nav__item> <a href=#glide class=md-nav__link> Glide加载圆形图片 </a> </li> <li class=md-nav__item> <a href=#tab3 class=md-nav__link> 好人好信Tab3下拉冲突问题 </a> </li> <li class=md-nav__item> <a href=#android class=md-nav__link> Android中字体的加载 </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 判断应用通知权限是否打开 </a> </li> <li class=md-nav__item> <a href=#viewpager class=md-nav__link> ViewPager实现画廊效果 </a> </li> <li class=md-nav__item> <a href=#splash class=md-nav__link> 全面屏Splash以及广告页适配指北 </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 震动反馈 </a> </li> <li class=md-nav__item> <a href=#android-50 class=md-nav__link> Android 5.0 平台共享元素动画 </a> </li> <li class=md-nav__item> <a href=#webviewjs class=md-nav__link> 向WebView注入本地JS并调用 </a> </li> <li class=md-nav__item> <a href=#navigationview class=md-nav__link> NavigationView菜单分割线 </a> </li> <li class=md-nav__item> <a href=#cardview class=md-nav__link> CardView背景色 </a> </li> <li class=md-nav__item> <a href=#attrid class=md-nav__link> 从attr中提取资源id </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 跳微信扫一扫 </a> </li> <li class=md-nav__item> <a href=#radiogroup class=md-nav__link> RadioGroup互斥 </a> </li> <li class=md-nav__item> <a href=#flatdiraar class=md-nav__link> 不flatDir使用aar包 </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 自定义资源目录 </a> </li> <li class=md-nav__item> <a href=#gradle class=md-nav__link> 修改gradle输出包的名字 </a> </li> <li class=md-nav__item> <a href=#gradle-copy class=md-nav__link> gradle copy函数 </a> </li> <li class=md-nav__item> <a href=#scrollviewscrollbar class=md-nav__link> ScrollView始终显示scrollbar </a> </li> <li class=md-nav__item> <a href=#alertdialog class=md-nav__link> AlertDialog消息换行 </a> </li> <li class=md-nav__item> <a href=#accentcolor class=md-nav__link> accentColor </a> </li> <li class=md-nav__item> <a href=#zipunzip class=md-nav__link> zip/unzip </a> </li> <li class=md-nav__item> <a href=#maclauncher class=md-nav__link> Mac调整Launcher行列数 </a> </li> <li class=md-nav__item> <a href=#okhttp class=md-nav__link> OkHttp下载文件 </a> </li> <li class=md-nav__item> <a href=#monkey class=md-nav__link> monkey测试： </a> </li> <li class=md-nav__item> <a href=#app class=md-nav__link> App物料尺寸 </a> </li> <li class=md-nav__item> <a href=#statusbarnavigationbar class=md-nav__link> StatusBar和NavigationBar完全透明 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 查看签名证书信息 </a> </li> <li class=md-nav__item> <a href=#dynamic-permission class=md-nav__link> Dynamic Permission </a> </li> <li class=md-nav__item> <a href=#google-chromedarkmode class=md-nav__link> Google Chrome强制禁用darkmode </a> </li> <li class=md-nav__item> <a href=#anr class=md-nav__link> ANR的判定 </a> </li> <li class=md-nav__item> <a href=#recyclerview class=md-nav__link> RecyclerView是否到顶部 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 判断程序是否运行在主进程 </a> </li> <li class=md-nav__item> <a href=#drawable2bitmap class=md-nav__link> Drawable2Bitmap </a> </li> <li class=md-nav__item> <a href=#gravity class=md-nav__link> Gravity的妙用 </a> </li> <li class=md-nav__item> <a href=#9patch class=md-nav__link> 9patch </a> </li> <li class=md-nav__item> <a href=#__comments class="md-nav__link md-nav__link--active"> 评论 </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1>琐碎知识点</h1> <h2 id=copyonwritearraylist>CopyOnWriteArrayList<a class=headerlink href=#copyonwritearraylist title="Permanent link">&para;</a></h2> <p>CopyOnWriteArrayList支持并发读写。</p> <h2 id=remotecallbacklist>RemoteCallbackList<a class=headerlink href=#remotecallbacklist title="Permanent link">&para;</a></h2> <p>RemoteCallbackList支持跨进程删除listener，原理是<code>ArrayMap&lt;IBinder, Callback&gt;</code>。IPC时Parcelable对象会序列化、反序列化，因此不会是同一个对象，但底层IBinder不会变。 它同时具有以下特点： 1. 客户端进程终止后，能够自动移除客户端注册的listener 2. RemoteCallbackList内部自动实现了线程同步功能，所以使用它来进行注册、取消注册时不需要做额外的线程同步工作。</p> <h2 id=androidwindowsoftinputmode>android:windowSoftInputMode<a class=headerlink href=#androidwindowsoftinputmode title="Permanent link">&para;</a></h2> <p>EditText禁止进入时弹出键盘： <div class=codehilite><pre><span></span>android:windowSoftInputMode=&quot;stateHidden&quot;
</pre></div> 键盘弹出时禁止顶动View： <div class=codehilite><pre><span></span>android:windowSoftInputMode=&quot;adjustPan&quot;
</pre></div></p> <h2 id=intent>常用Intent<a class=headerlink href=#intent title="Permanent link">&para;</a></h2> <p>跳转拨号盘 <div class=codehilite><pre><span></span><span class=k>new</span> <span class=n>Intent</span><span class=p>(</span><span class=n>Intent</span><span class=p>.</span><span class=na>ACTION_DIAL</span><span class=p>,</span> <span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&quot;tel:12306&quot;</span><span class=p>));</span>
</pre></div> 直接拨打电话 <div class=codehilite><pre><span></span><span class=k>new</span> <span class=n>Intent</span><span class=p>(</span><span class=n>Intent</span><span class=p>.</span><span class=na>ACTION_CALL</span><span class=p>,</span> <span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&quot;tel:12306&quot;</span><span class=p>));</span>
</pre></div> 发送短信 <div class=codehilite><pre><span></span><span class=k>new</span> <span class=n>Intent</span><span class=p>(</span><span class=n>Intent</span><span class=p>.</span><span class=na>ACTION_SENDTO</span><span class=p>,</span> <span class=n>Uri</span><span class=p>.</span><span class=na>parse</span><span class=p>(</span><span class=s>&quot;smsto:12306&quot;</span><span class=p>));</span>
</pre></div></p> <h2 id=collectionssort>Collections.sort<a class=headerlink href=#collectionssort title="Permanent link">&para;</a></h2> <p>Java Bean实体进行排序 <div class=codehilite><pre><span></span><span class=n>Collections</span><span class=p>.</span><span class=na>sort</span><span class=p>(</span><span class=n>mRowsBeanList</span><span class=p>,</span> <span class=k>new</span> <span class=n>Number2zComparator</span><span class=p>());</span>

<span class=kd>private</span> <span class=kd>class</span> <span class=nc>Number2zComparator</span> <span class=kd>implements</span> <span class=n>Comparator</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=p>{</span>
    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>compare</span><span class=p>(</span><span class=n>T</span> <span class=n>o1</span><span class=p>,</span> <span class=n>T</span> <span class=n>o2</span><span class=p>)</span> <span class=p>{</span>
        <span class=kt>boolean</span> <span class=n>o1IsHot</span> <span class=o>=</span> <span class=n>o1</span><span class=p>.</span><span class=na>getHotFlag</span><span class=p>()</span> <span class=o>==</span> <span class=mi>1</span><span class=p>;</span>
        <span class=kt>boolean</span> <span class=n>o2IsHot</span> <span class=o>=</span> <span class=n>o2</span><span class=p>.</span><span class=na>getHotFlag</span><span class=p>()</span> <span class=o>==</span> <span class=mi>1</span><span class=p>;</span>
        <span class=n>String</span> <span class=n>o1Letter</span> <span class=o>=</span> <span class=n>PinyinUtils</span><span class=p>.</span><span class=na>ccs2Pinyin</span><span class=p>(</span><span class=n>o1</span><span class=p>.</span><span class=na>getPlatformName</span><span class=p>());</span>
        <span class=n>String</span> <span class=n>o2Letter</span> <span class=o>=</span> <span class=n>PinyinUtils</span><span class=p>.</span><span class=na>ccs2Pinyin</span><span class=p>(</span><span class=n>o2</span><span class=p>.</span><span class=na>getPlatformName</span><span class=p>());</span>

        <span class=k>if</span> <span class=p>(</span><span class=n>o1IsHot</span> <span class=o>&amp;&amp;</span> <span class=n>o2IsHot</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=n>o1Letter</span><span class=p>.</span><span class=na>compareToIgnoreCase</span><span class=p>(</span><span class=n>o2Letter</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>o1IsHot</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
        <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>o2IsHot</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=mi>1</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=k>return</span> <span class=n>o1Letter</span><span class=p>.</span><span class=na>compareToIgnoreCase</span><span class=p>(</span><span class=n>o2Letter</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div> o1与o2进行比较，如果o1要排在o2前面，返回-1;<br> 如果两者相等，返回0;<br> 如果o1排在o2后面，返回1。</p> <h2 id=gif>Gif加载<a class=headerlink href=#gif title="Permanent link">&para;</a></h2> <p>Gif加载<br> 在尝试Glide加载(不卡，但是图片错乱了)、帧动画实现(超级耗内存，30帧，每帧8k原图，耗内存大约20M)、android-gif-drawable库(Android O上非常卡顿，耗内存大约10M)加载失败之后，找到了一种新奇的思路：每隔一段时间调用<code>setBackgroundResource</code>，内存消耗基本不计。</p> <h2 id=drawable>代码设置drawable<a class=headerlink href=#drawable title="Permanent link">&para;</a></h2> <p><code>setCompoundDrawablesWithIntrinsicBounds</code></p> <h2 id=responsebodystring>response.body().string()只能调用一次<a class=headerlink href=#responsebodystring title="Permanent link">&para;</a></h2> <p>OkHttp访问网络成功的回调中，<code>Response response</code>的<code>response.body().string()</code>只能调用一次，否则</p> <div class=codehilite><pre><span></span><span class=n>E</span><span class=o>/</span><span class=n>AndroidRuntime</span><span class=p>:</span> <span class=n>FATAL</span> <span class=n>EXCEPTION</span><span class=p>:</span> <span class=n>OkHttp</span> <span class=n>Dispatcher</span>
                  <span class=n>Process</span><span class=p>:</span> <span class=n>yorek</span><span class=p>.</span><span class=na>demoandtest</span><span class=p>,</span> <span class=n>PID</span><span class=p>:</span> <span class=mi>24671</span>
                  <span class=n>java</span><span class=p>.</span><span class=na>lang</span><span class=p>.</span><span class=na>IllegalStateException</span><span class=p>:</span> <span class=n>closed</span>
</pre></div> <p>因为这是一个流，使用过后就被关闭了：</p> <div class=codehilite><pre><span></span>  <span class=kd>public</span> <span class=kd>final</span> <span class=n>String</span> <span class=nf>string</span><span class=p>()</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=p>{</span>
    <span class=n>BufferedSource</span> <span class=n>source</span> <span class=o>=</span> <span class=n>source</span><span class=p>();</span>
    <span class=k>try</span> <span class=p>{</span>
      <span class=n>Charset</span> <span class=n>charset</span> <span class=o>=</span> <span class=n>Util</span><span class=p>.</span><span class=na>bomAwareCharset</span><span class=p>(</span><span class=n>source</span><span class=p>,</span> <span class=n>charset</span><span class=p>());</span>
      <span class=k>return</span> <span class=n>source</span><span class=p>.</span><span class=na>readString</span><span class=p>(</span><span class=n>charset</span><span class=p>);</span>
    <span class=p>}</span> <span class=k>finally</span> <span class=p>{</span>
      <span class=n>Util</span><span class=p>.</span><span class=na>closeQuietly</span><span class=p>(</span><span class=n>source</span><span class=p>);</span>
    <span class=p>}</span>
  <span class=p>}</span>
</pre></div> <h2 id=glide>Glide加载圆形图片<a class=headerlink href=#glide title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span><span class=n>Glide</span><span class=p>.</span><span class=na>with</span><span class=p>(</span><span class=n>mContext</span><span class=p>)</span>
    <span class=p>.</span><span class=na>load</span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>platformLogo</span><span class=p>)</span>
    <span class=p>.</span><span class=na>bitmapTransform</span><span class=p>(</span><span class=n>CropCircleTransformation</span><span class=p>(</span><span class=n>mContext</span><span class=p>))</span>
    <span class=p>.</span><span class=na>into</span><span class=p>(</span><span class=n>iv_logo</span><span class=p>)</span>
</pre></div> <p>其中，<code>.bitmapTransform(CropCircleTransformation(mContext))</code>是其中的重点， <code>CropCircleTransformation</code>使用了<code>jp.wasabeef:glide-transformations:2.0.2</code>这个lib</p> <div class=codehilite><pre><span></span>compile &#39;jp.wasabeef:glide-transformations:2.0.2&#39;
</pre></div> <p>Glide v4已经内置了圆形、圆角等常用的Trasform了。上面是Glide v3时的做法。</p> <h2 id=tab3>好人好信Tab3下拉冲突问题<a class=headerlink href=#tab3 title="Permanent link">&para;</a></h2> <p><code>SwipeRefreshLayout</code>与<code>CollapsingToolbarLayout</code>和充满<code>RecyclerView</code>的<code>ViewPager</code>联用出现的滑动冲突问题</p> <p>解决办法是自定义<code>SwipeRefreshLayout</code>，在<code>AppBarLayout</code>元素没有到顶时允许child向上滑，到顶后不允许滑动，这样就触发了下拉刷新。</p> <div class=codehilite><pre><span></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>CreditFragmentSwipeRefreshLayout</span> <span class=kd>extends</span> <span class=n>SwipeRefreshLayout</span> <span class=p>{</span>
    <span class=kd>private</span> <span class=n>AppBarLayout</span> <span class=n>targetView</span><span class=p>;</span>

    <span class=kd>public</span> <span class=nf>CreditFragmentSwipeRefreshLayout</span><span class=p>(</span><span class=n>Context</span> <span class=n>context</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>(</span><span class=n>context</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kd>public</span> <span class=nf>CreditFragmentSwipeRefreshLayout</span><span class=p>(</span><span class=n>Context</span> <span class=n>context</span><span class=p>,</span> <span class=n>AttributeSet</span> <span class=n>attrs</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=n>attrs</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onFinishInflate</span><span class=p>()</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>.</span><span class=na>onFinishInflate</span><span class=p>();</span>
        <span class=n>targetView</span> <span class=o>=</span> <span class=p>(</span><span class=n>AppBarLayout</span><span class=p>)</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>abl</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>canChildScrollUp</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>targetView</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=n>targetView</span><span class=p>.</span><span class=na>getTop</span><span class=p>()</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>;</span>
        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
            <span class=k>return</span> <span class=kd>super</span><span class=p>.</span><span class=na>canChildScrollUp</span><span class=p>();</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div> <h2 id=android>Android中字体的加载<a class=headerlink href=#android title="Permanent link">&para;</a></h2> <p>在<code>app/src/main/assets</code>下面放置字体文件，然后使用下面的代码加载 <br> <div class=codehilite><pre><span></span><span class=k>class</span> <span class=nc>KTypeface</span> <span class=p>{</span>
    <span class=k>companion</span> <span class=k>object</span> <span class=p>{</span>
        <span class=k>val</span> <span class=py>DIN_PRO_MIDIUM</span> <span class=p>=</span>
            <span class=n>Typeface</span><span class=p>.</span><span class=n>createFromAsset</span><span class=p>(</span><span class=n>MyApp</span><span class=p>.</span><span class=n>getInstance</span><span class=p>().</span><span class=n>assets</span><span class=p>,</span> <span class=s>&quot;DINPro-Medium.otf&quot;</span><span class=p>)</span>
        <span class=k>val</span> <span class=py>ROBOTO_MIDIUM</span> <span class=p>=</span>
            <span class=n>Typeface</span><span class=p>.</span><span class=n>createFromAsset</span><span class=p>(</span><span class=n>MyApp</span><span class=p>.</span><span class=n>getInstance</span><span class=p>().</span><span class=n>assets</span><span class=p>,</span> <span class=s>&quot;Roboto-Medium.ttf&quot;</span><span class=p>)</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div></p> <p>这么使用：<br> <div class=codehilite><pre><span></span><span class=n>tvMyScore</span><span class=p>.</span><span class=n>typeface</span> <span class=p>=</span> <span class=n>KTypeface</span><span class=p>.</span><span class=n>DIN_PRO_MIDIUM</span>
</pre></div></p> <p>Android中字体最好加载一次之后缓存起来，因为每次加载需要消耗时间。</p> <h2 id=_1>判断应用通知权限是否打开<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span><span class=cm>/**</span>
<span class=cm> * 只能检查KITKAT及以上的系统，以下会返回true</span>
<span class=cm> */</span>
<span class=kd>public</span> <span class=kd>static</span> <span class=kt>boolean</span> <span class=nf>isNotificationEnabled</span><span class=p>(</span><span class=n>Context</span> <span class=n>context</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>NotificationManagerCompat</span> <span class=n>notificationManagerCompat</span> <span class=o>=</span> <span class=n>NotificationManagerCompat</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>context</span><span class=p>);</span>
    <span class=k>return</span> <span class=n>notificationManagerCompat</span><span class=p>.</span><span class=na>areNotificationsEnabled</span><span class=p>();</span>
<span class=p>}</span>
</pre></div> <h2 id=viewpager>ViewPager实现画廊效果<a class=headerlink href=#viewpager title="Permanent link">&para;</a></h2> <iframe width=320 height=568 src=/assets/videos/viewpager_clipparent.mp4 frameborder=0 allowfullscreen></iframe> <p>实现原理很简单</p> <ol> <li><code>ViewPager</code>的父布局需要设置<code>clipChildren = false</code>，同时最好设置背景色(pageMargin的部分需要背景色填充)</li> <li><code>ViewPager</code>也需要设置<code>clipChildren = false</code></li> <li><code>ViewPager</code>宽度为<code>MATCH_PARENT</code>，但需要为其设置<code>leftMargin</code>和<code>rightMargin</code>，这样才有画廊的效果</li> <li>两张卡片之间的间距由<code>ViewPager</code>的<code>pageMargin</code>控制</li> </ol> <p><code>ViewPager</code>里面的子元素距离边框最好不要有<code>padding</code>以及<code>margin</code>，这样不利于控制效果</p> <h2 id=splash>全面屏Splash以及广告页适配指北<a class=headerlink href=#splash title="Permanent link">&para;</a></h2> <p><strong><code>SplashActivity</code>适配</strong></p> <ol> <li>新建<code>drawable-xxhdpi-2016x1080</code>文件夹，里面放入为全面屏准备的开屏页(一般是1080x2160)</li> <li>在<code>SplashActivity</code>的主题中加入<code>&lt;item name="android:windowBackground"&gt;@drawable/img_splash&lt;/item&gt;</code>(所谓程序秒开主要指这个)</li> </ol> <p>上述直接放图片的方式不太适用了，因为手机高宽比越来越大，这样总会被拉长的。如果图片底部是纯色的话，可以使用layer-list包裹一下图片，其他位置用纯色就好了。</p> <p><strong>广告页适配(我家广告页就是与<code>SplashActivity</code> style一样的第二屏)</strong><br> 这个位置麻烦的地方就是需要显示从网络下载的图片，而且有多种尺寸，所以为了在全面屏上显示更好，我们需要加载一张1080x2160大小的图片然后显示。<br> 所以，我们会先判断是不是全面屏，如果是就下载1080x2160大小的图片，否则一律下载1080x1920大小的图片。</p> <div class=codehilite><pre><span></span><span class=c1>// 下载图片的判断逻辑</span>
<span class=n>String</span> <span class=n>screenType</span> <span class=o>=</span> <span class=s>&quot;1080x1920&quot;</span><span class=p>;</span>
<span class=n>Point</span> <span class=n>point</span> <span class=o>=</span> <span class=n>HRScreenUtils</span><span class=p>.</span><span class=na>Companion</span><span class=p>.</span><span class=na>getScreenSize</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
<span class=k>if</span> <span class=p>(</span><span class=n>HRScreenUtils</span><span class=p>.</span><span class=na>Companion</span><span class=p>.</span><span class=na>isFullScreen</span><span class=p>(</span><span class=n>point</span><span class=p>.</span><span class=na>x</span><span class=p>,</span> <span class=n>point</span><span class=p>.</span><span class=na>y</span><span class=p>))</span> <span class=p>{</span>
    <span class=n>screenType</span> <span class=o>=</span> <span class=s>&quot;1080x2160&quot;</span><span class=p>;</span>
<span class=p>}</span>
<span class=n>Call</span><span class=o>&lt;</span><span class=n>FestivalImgRes</span><span class=o>&gt;</span> <span class=n>call</span> <span class=o>=</span> <span class=n>HttpHelper</span><span class=p>.</span><span class=na>getApiService</span><span class=p>().</span><span class=na>getFestivalHead</span><span class=p>(</span><span class=s>&quot;android&quot;</span><span class=p>,</span> <span class=n>screenType</span><span class=p>);</span>

<span class=c1>// ------------------------------</span>
<span class=c1>// HRScreenUtils.kt</span>
<span class=kd>class</span> <span class=nc>HRScreenUtils</span> <span class=p>{</span>
    <span class=n>companion</span> <span class=n>object</span> <span class=p>{</span>
        <span class=n>fun</span> <span class=nf>isFullScreen</span><span class=p>(</span><span class=n>width</span><span class=p>:</span> <span class=n>Int</span><span class=p>,</span> <span class=n>height</span><span class=p>:</span> <span class=n>Int</span><span class=p>)</span> <span class=p>:</span> <span class=n>Boolean</span> <span class=o>=</span> <span class=p>(</span><span class=mf>1.0f</span> <span class=o>*</span> <span class=n>height</span> <span class=o>/</span> <span class=n>width</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mf>1.86f</span>

        <span class=n>fun</span> <span class=nf>getScreenSize</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=n>Context</span><span class=p>):</span> <span class=n>Point</span> <span class=p>{</span>
            <span class=n>val</span> <span class=n>point</span> <span class=o>=</span> <span class=n>Point</span><span class=p>()</span>
            <span class=n>val</span> <span class=n>windowManager</span> <span class=o>=</span> <span class=n>context</span><span class=p>.</span><span class=na>getSystemService</span><span class=p>(</span><span class=n>Context</span><span class=p>.</span><span class=na>WINDOW_SERVICE</span><span class=p>)</span> <span class=n>as</span> <span class=n>WindowManager</span>
            <span class=nf>if</span> <span class=p>(</span><span class=n>Build</span><span class=p>.</span><span class=na>VERSION</span><span class=p>.</span><span class=na>SDK_INT</span> <span class=o>&gt;=</span> <span class=n>Build</span><span class=p>.</span><span class=na>VERSION_CODES</span><span class=p>.</span><span class=na>JELLY_BEAN_MR1</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>windowManager</span><span class=p>.</span><span class=na>defaultDisplay</span><span class=p>.</span><span class=na>getRealSize</span><span class=p>(</span><span class=n>point</span><span class=p>)</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=n>windowManager</span><span class=p>.</span><span class=na>defaultDisplay</span><span class=p>.</span><span class=na>getSize</span><span class=p>(</span><span class=n>point</span><span class=p>)</span>
            <span class=p>}</span>

            <span class=k>return</span> <span class=n>point</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div> <p>同样，这里需要考虑一下手机高宽比越来越大的情况。</p> <h2 id=_2>震动反馈<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <p>不调用<code>Vibrator</code>实现震动反馈的两种方式 - 在<code>View</code>的<code>OnLongClickListener</code>中返回<code>true</code> - 调用<code>View#performHapticFeedback(HapticFeedbackConstants.KEYBOARD_TAP);</code>方法</p> <blockquote> <p>震动反馈能否发生还取决与系统的震动反馈设置，通过<code>performHapticFeedback</code>重载方法实现震动反馈可以忽略系统设置。</p> </blockquote> <h2 id=android-50>Android 5.0 平台共享元素动画<a class=headerlink href=#android-50 title="Permanent link">&para;</a></h2> <ol> <li>为两个<code>Activity</code>中需要进行动画的<code>View</code>取上相同的<code>transitionName</code>，若需要同时进行多个元素的动画，每个元素的<code>transitionName</code>都要不同</li> <li>跳转<code>Activity</code>时，</li> <li>若只有一个元素，可以调用<code>startActivity(intent, ActivityOptions.makeSceneTransitionAnimation(this, tv_right, getString(R.string.transition_name)).toBundle())</code></li> <li>若多个元素，如下 <br> <div class=codehilite><pre><span></span><span class=n>ActivityOptions</span> <span class=n>activityOptions</span> <span class=o>=</span> <span class=n>ActivityOptions</span><span class=p>.</span><span class=na>makeSceneTransitionAnimation</span><span class=p>(</span><span class=n>getActivity</span><span class=p>(),</span>
      <span class=k>new</span> <span class=n>Pair</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>view</span><span class=p>.</span><span class=na>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>iv_folder_icon</span><span class=p>),</span> <span class=n>getContext</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>string</span><span class=p>.</span><span class=na>transition_task_icon</span><span class=p>)),</span>
      <span class=k>new</span> <span class=n>Pair</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>view</span><span class=p>.</span><span class=na>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>tv_folder_progress_value</span><span class=p>),</span> <span class=n>getContext</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>string</span><span class=p>.</span><span class=na>transition_task_progress_value</span><span class=p>)),</span>
      <span class=k>new</span> <span class=n>Pair</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>view</span><span class=p>.</span><span class=na>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>pb_folder_progress</span><span class=p>),</span> <span class=n>getContext</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>string</span><span class=p>.</span><span class=na>transition_task_progress</span><span class=p>)),</span>
      <span class=k>new</span> <span class=n>Pair</span><span class=o>&lt;&gt;</span><span class=p>(</span><span class=n>view</span><span class=p>.</span><span class=na>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>tv_folder_count</span><span class=p>),</span> <span class=n>getContext</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>string</span><span class=p>.</span><span class=na>transition_task_count</span><span class=p>)));</span>
<span class=n>Intent</span> <span class=n>intent</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Intent</span><span class=p>(</span><span class=n>getContext</span><span class=p>(),</span> <span class=n>TodoFolderActivity</span><span class=p>.</span><span class=na>class</span><span class=p>);</span>
<span class=n>getContext</span><span class=p>().</span><span class=na>startActivity</span><span class=p>(</span><span class=n>intent</span><span class=p>,</span> <span class=n>activityOptions</span><span class=p>.</span><span class=na>toBundle</span><span class=p>());</span>
</pre></div></li> </ol> <blockquote> <p>由B返回A时，一般情况都也会默认进行共享元素动画返回，特殊情况下可以调用<code>finishAfterTransition()</code>进行共享元素动画返回</p> </blockquote> <p>共享元素动画执行的过程也有监听方法，<code>SharedElementCallback</code>里面方法比较多，具体可以看源码注释</p> <ul> <li>Activity#setEnterSharedElementCallback(SharedElementCallback)</li> <li>Activity#setExitSharedElementCallback(SharedElementCallback)</li> <li>Fragment#setEnterSharedElementCallback(SharedElementCallback)</li> <li>Fragment#setExitSharedElementCallback(SharedElementCallback)</li> <li>SharedElementCallback</li> <li>onSharedElementStart</li> <li>onSharedElementEnd</li> <li>onRejectSharedElements</li> <li>onMapSharedElements</li> <li>onSharedElementsArrived</li> </ul> <h2 id=webviewjs>向WebView注入本地JS并调用<a class=headerlink href=#webviewjs title="Permanent link">&para;</a></h2> <p>1.定义本地JS文件(test.js)，放到assets目录下</p> <div class=codehilite><pre><span></span><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>

<span class=kd>function</span> <span class=nx>test</span><span class=p>()</span> <span class=p>{</span>
  <span class=nx>$</span><span class=p>(</span><span class=s2>&quot;.fake-box input&quot;</span><span class=p>).</span><span class=nx>val</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>);</span>
  <span class=nx>angular</span><span class=p>.</span><span class=nx>element</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;pwd-input&#39;</span><span class=p>)).</span><span class=nx>scope</span><span class=p>().</span><span class=nx>$apply</span><span class=p>(</span><span class=s1>&#39;verify_code = &quot;123458&quot;&#39;</span><span class=p>);</span>
<span class=p>}</span>
</pre></div> <p>2.定义webview注入本地js文件的方法</p> <div class=codehilite><pre><span></span><span class=kd>private</span> <span class=kt>void</span> <span class=nf>injectScriptFile</span><span class=p>(</span><span class=n>WebView</span> <span class=n>view</span><span class=p>,</span> <span class=n>String</span> <span class=n>scriptFile</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>InputStream</span> <span class=n>input</span><span class=p>;</span>
    <span class=k>try</span> <span class=p>{</span>
        <span class=n>input</span> <span class=o>=</span> <span class=n>getAssets</span><span class=p>().</span><span class=na>open</span><span class=p>(</span><span class=n>scriptFile</span><span class=p>);</span>
        <span class=kt>byte</span><span class=o>[]</span> <span class=n>buffer</span> <span class=o>=</span> <span class=k>new</span> <span class=kt>byte</span><span class=o>[</span><span class=n>input</span><span class=p>.</span><span class=na>available</span><span class=p>()</span><span class=o>]</span><span class=p>;</span>
        <span class=n>input</span><span class=p>.</span><span class=na>read</span><span class=p>(</span><span class=n>buffer</span><span class=p>);</span>
        <span class=n>input</span><span class=p>.</span><span class=na>close</span><span class=p>();</span>

        <span class=c1>// String-ify the script byte-array using BASE64 encoding !!!</span>
        <span class=n>String</span> <span class=n>encoded</span> <span class=o>=</span> <span class=n>Base64</span><span class=p>.</span><span class=na>encodeToString</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span> <span class=n>Base64</span><span class=p>.</span><span class=na>NO_WRAP</span><span class=p>);</span>
        <span class=n>view</span><span class=p>.</span><span class=na>loadUrl</span><span class=p>(</span><span class=s>&quot;javascript:(function() {&quot;</span> <span class=o>+</span>
                <span class=s>&quot;var parent = document.getElementsByTagName(&#39;head&#39;).item(0);&quot;</span> <span class=o>+</span>
                <span class=s>&quot;var script = document.createElement(&#39;script&#39;);&quot;</span> <span class=o>+</span>
                <span class=s>&quot;script.type = &#39;text/javascript&#39;;&quot;</span> <span class=o>+</span>
                <span class=c1>// Tell the browser to BASE64-decode the string into your script !!!</span>
                <span class=s>&quot;script.innerHTML = window.atob(&#39;&quot;</span> <span class=o>+</span> <span class=n>encoded</span> <span class=o>+</span> <span class=s>&quot;&#39;);&quot;</span> <span class=o>+</span>
                <span class=s>&quot;parent.appendChild(script)&quot;</span> <span class=o>+</span>
                <span class=s>&quot;})()&quot;</span><span class=p>);</span>
    <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=n>IOException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// TODO Auto-generated catch block</span>
        <span class=n>e</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div> <p>3.注入并调用</p> <div class=codehilite><pre><span></span><span class=n>injectScriptFile</span><span class=p>(</span><span class=n>webView</span><span class=p>,</span> <span class=s>&quot;test.js&quot;</span><span class=p>);</span>                   <span class=c1>// 注入</span>
<span class=n>webView</span><span class=p>.</span><span class=na>loadUrl</span><span class=p>(</span><span class=s>&quot;javascript:setTimeout(test(), 500)&quot;</span><span class=p>);</span>  <span class=c1>// 调用</span>
</pre></div> <h2 id=navigationview>NavigationView菜单分割线<a class=headerlink href=#navigationview title="Permanent link">&para;</a></h2> <p>给<code>NavigationView</code>中的菜单添加分割线，只要给每个group添加id即可。</p> <div class=codehilite><pre><span></span><span class=cp>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class=nt>&lt;menu</span> <span class=na>xmlns:android=</span><span class=s>&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class=na>xmlns:tools=</span><span class=s>&quot;http://schemas.android.com/tools&quot;</span>
    <span class=na>tools:showIn=</span><span class=s>&quot;navigation_view&quot;</span><span class=nt>&gt;</span>

    <span class=nt>&lt;group</span>
        <span class=na>android:id=</span><span class=s>&quot;@+id/group_all&quot;</span>
        <span class=na>android:checkableBehavior=</span><span class=s>&quot;single&quot;</span><span class=nt>&gt;</span>
        <span class=nt>&lt;item</span>
            <span class=na>android:id=</span><span class=s>&quot;@+id/nav_all&quot;</span>
            <span class=na>android:icon=</span><span class=s>&quot;@drawable/ic_menu_lightbulb&quot;</span>
            <span class=na>android:title=</span><span class=s>&quot;@string/nav_menu_all&quot;</span>
            <span class=na>android:checked=</span><span class=s>&quot;true&quot;</span><span class=nt>/&gt;</span>
    <span class=nt>&lt;/group&gt;</span>

    <span class=nt>&lt;item</span> <span class=na>android:title=</span><span class=s>&quot;@string/nav_menu_labels&quot;</span><span class=nt>&gt;</span>
        <span class=nt>&lt;menu&gt;</span>
            <span class=nt>&lt;group</span> <span class=na>android:checkableBehavior=</span><span class=s>&quot;single&quot;</span><span class=nt>&gt;</span>
                <span class=nt>&lt;item</span>
                    <span class=na>android:id=</span><span class=s>&quot;@+id/nav_new_label11&quot;</span>
                    <span class=na>android:icon=</span><span class=s>&quot;@drawable/ic_menu_lightbulb&quot;</span>
                    <span class=na>android:title=</span><span class=s>&quot;测试1&quot;</span><span class=nt>/&gt;</span>
                <span class=nt>&lt;item</span>
                    <span class=na>android:id=</span><span class=s>&quot;@+id/nav_new_label&quot;</span>
                    <span class=na>android:icon=</span><span class=s>&quot;@drawable/ic_menu_lightbulb&quot;</span>
                    <span class=na>android:title=</span><span class=s>&quot;@string/nav_menu_create_new_label&quot;</span> <span class=nt>/&gt;</span>
            <span class=nt>&lt;/group&gt;</span>
        <span class=nt>&lt;/menu&gt;</span>
    <span class=nt>&lt;/item&gt;</span>

    <span class=nt>&lt;group</span>
        <span class=na>android:id=</span><span class=s>&quot;@+id/group_collection&quot;</span>
        <span class=na>android:checkableBehavior=</span><span class=s>&quot;single&quot;</span><span class=nt>&gt;</span>
        <span class=nt>&lt;item</span>
            <span class=na>android:id=</span><span class=s>&quot;@+id/nav_archive&quot;</span>
            <span class=na>android:icon=</span><span class=s>&quot;@drawable/ic_menu_lightbulb&quot;</span>
            <span class=na>android:title=</span><span class=s>&quot;@string/nav_menu_archive&quot;</span> <span class=nt>/&gt;</span>
        <span class=nt>&lt;item</span>
            <span class=na>android:id=</span><span class=s>&quot;@+id/nav_trash&quot;</span>
            <span class=na>android:icon=</span><span class=s>&quot;@drawable/ic_menu_lightbulb&quot;</span>
            <span class=na>android:title=</span><span class=s>&quot;@string/nav_menu_trash&quot;</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;/group&gt;</span>

    <span class=nt>&lt;group</span>
        <span class=na>android:id=</span><span class=s>&quot;@+id/group_settings&quot;</span>
        <span class=na>android:checkableBehavior=</span><span class=s>&quot;single&quot;</span><span class=nt>&gt;</span>
        <span class=nt>&lt;item</span>
            <span class=na>android:id=</span><span class=s>&quot;@+id/nav_settings&quot;</span>
            <span class=na>android:icon=</span><span class=s>&quot;@drawable/ic_menu_lightbulb&quot;</span>
            <span class=na>android:title=</span><span class=s>&quot;@string/nav_menu_settings&quot;</span> <span class=nt>/&gt;</span>
        <span class=nt>&lt;item</span>
            <span class=na>android:id=</span><span class=s>&quot;@+id/nav_help&quot;</span>
            <span class=na>android:icon=</span><span class=s>&quot;@drawable/ic_menu_lightbulb&quot;</span>
            <span class=na>android:title=</span><span class=s>&quot;@string/nav_menu_help_and_feedback&quot;</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;/group&gt;</span>
<span class=nt>&lt;/menu&gt;</span>
</pre></div> <h2 id=cardview>CardView背景色<a class=headerlink href=#cardview title="Permanent link">&para;</a></h2> <p>给<code>CardView</code>添加背景色要使用<code>app:cardBackgroundColor</code>，不然会导致<code>app:cardCornerRadius</code>不生效</p> <h2 id=attrid>从attr中提取资源id<a class=headerlink href=#attrid title="Permanent link">&para;</a></h2> <p>从attr中提取资源id，可以使用<code>TypedValue</code></p> <div class=codehilite><pre><span></span><span class=k>val</span> <span class=py>typedValue</span> <span class=p>=</span> <span class=n>TypedValue</span><span class=p>()</span>
<span class=n>theme</span><span class=p>.</span><span class=n>resolveAttribute</span><span class=p>(</span><span class=n>android</span><span class=p>.</span><span class=n>R</span><span class=p>.</span><span class=n>attr</span><span class=p>.</span><span class=n>colorControlNormal</span><span class=p>,</span> <span class=n>typedValue</span><span class=p>,</span> <span class=k>true</span><span class=p>)</span>
<span class=k>val</span> <span class=py>resourceId</span> <span class=p>=</span> <span class=n>typedValue</span><span class=p>.</span><span class=n>resourceId</span>
</pre></div> <h2 id=_3>跳微信扫一扫<a class=headerlink href=#_3 title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span><span class=k>try</span> <span class=p>{</span>
    <span class=k>val</span> <span class=py>intent</span> <span class=p>=</span> <span class=n>mActivity</span><span class=p>.</span><span class=n>packageManager</span><span class=p>.</span><span class=n>getLaunchIntentForPackage</span><span class=p>(</span><span class=s>&quot;com.tencent.mm&quot;</span><span class=p>)</span>
    <span class=n>intent</span><span class=p>.</span><span class=n>putExtra</span><span class=p>(</span><span class=s>&quot;LauncherUI.From.Scaner.Shortcut&quot;</span><span class=p>,</span> <span class=k>true</span><span class=p>)</span>
    <span class=n>startActivity</span><span class=p>(</span><span class=n>intent</span><span class=p>)</span>
<span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=n>e</span><span class=p>:</span> <span class=n>Exception</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>ToastUtils</span><span class=p>.</span><span class=n>showLongToast</span><span class=p>(</span><span class=s>&quot;无法跳转到微信，请检查您是否安装了微信！&quot;</span><span class=p>)</span>
<span class=p>}</span>
</pre></div> <h2 id=radiogroup>RadioGroup互斥<a class=headerlink href=#radiogroup title="Permanent link">&para;</a></h2> <p>RadioGroup里面RadioButton最好都设置id,不然给其中一个设置为默认选中后，其他的RadioButton不会互斥。</p> <h2 id=flatdiraar>不flatDir使用aar包<a class=headerlink href=#flatdiraar title="Permanent link">&para;</a></h2> <p>使用aar包不用flatDir，一句代码就好</p> <div class=codehilite><pre><span></span>implementation fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;, &#39;*.aar&#39;])
</pre></div> <h2 id=_4>自定义资源目录<a class=headerlink href=#_4 title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span>android {
    sourceSets {
        main {
            java.srcDirs += &#39;src/main/kotlin&#39;
            res.srcDirs = [
                    &#39;src/main/res&#39;,
                    &#39;src/main/res_overlay&#39;
            ]
        }
    }
}
</pre></div> <h2 id=gradle>修改gradle输出包的名字<a class=headerlink href=#gradle title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span>// -----------------------------------------------------------------------------------------
// build script
android {
    applicationVariants.all { variant -&gt;
        variant.outputs.all { output -&gt;
            def newName
            def timeNow
            if (&quot;true&quot; == IS_JENKINS) {
                // Jenkins编译
                newName = APP_NAME + &#39;-&#39; + variant.buildType.name + &#39;-&#39; + BUILD_TIME + &#39;.apk&#39;
                outputFileName = new File(&quot;../../../../..&quot;, newName)
            } else {
                // Android Studio编译
                timeNow = new Date().format(&quot;yyyyMMddHHmm&quot;)
                newName = APP_NAME + &quot;-v&quot; + variant.versionName + &#39;-&#39; + variant.buildType.name + &#39;-&#39; + timeNow + &#39;.apk&#39;
                outputFileName = newName
            }
        }
    }
}
// -----------------------------------------------------------------------------------------
</pre></div> <h2 id=gradle-copy>gradle copy函数<a class=headerlink href=#gradle-copy title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span><span class=n>android</span><span class=o>.</span><span class=na>libraryVariants</span><span class=o>.</span><span class=na>all</span> <span class=o>{</span>
    <span class=n>it</span><span class=o>.</span><span class=na>outputs</span><span class=o>.</span><span class=na>all</span> <span class=o>{</span>
        <span class=n>outputFileName</span> <span class=o>=</span> <span class=s2>&quot;hruilib-${version}-${it.name}.aar&quot;</span>
    <span class=o>}</span>
<span class=o>}</span>

<span class=n>project</span><span class=o>.</span><span class=na>afterEvaluate</span> <span class=o>{</span>
    <span class=n>android</span><span class=o>.</span><span class=na>libraryVariants</span><span class=o>.</span><span class=na>each</span> <span class=o>{</span>
        <span class=n>String</span> <span class=n>variantName</span> <span class=o>=</span> <span class=n>it</span><span class=o>.</span><span class=na>name</span><span class=o>.</span><span class=na>capitalize</span><span class=o>()</span>
        <span class=k>if</span> <span class=o>(</span><span class=n>variantName</span> <span class=o>==</span> <span class=s1>&#39;Release&#39;</span><span class=o>)</span> <span class=o>{</span>
            <span class=kt>def</span> <span class=n>assembleTask</span> <span class=o>=</span> <span class=n>project</span><span class=o>.</span><span class=na>tasks</span><span class=o>.</span><span class=na>getByName</span><span class=o>(</span><span class=s2>&quot;assemble${variantName}&quot;</span><span class=o>)</span>
            <span class=n>assembleTask</span><span class=o>.</span><span class=na>doLast</span> <span class=o>{</span>
                <span class=n>copy</span> <span class=o>{</span>
                    <span class=n>from</span><span class=o>(</span><span class=s1>&#39;build/outputs/aar/&#39;</span><span class=o>)</span>
                    <span class=n>into</span><span class=o>(</span><span class=s1>&#39;../app/libs/&#39;</span><span class=o>)</span>
                    <span class=n>include</span><span class=o>(</span><span class=s2>&quot;*-release.aar&quot;</span><span class=o>)</span>
                <span class=o>}</span>
            <span class=o>}</span>
        <span class=o>}</span>
    <span class=o>}</span>
<span class=o>}</span>
</pre></div> <h2 id=scrollviewscrollbar>ScrollView始终显示scrollbar<a class=headerlink href=#scrollviewscrollbar title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span>android:scrollbars=&quot;vertical&quot;
android:fadeScrollbars=&quot;false&quot;
</pre></div> <p>实践效果：当可以滑动的时候会显示scollbar，不能滑动的时候不会显示。</p> <h2 id=alertdialog>AlertDialog消息换行<a class=headerlink href=#alertdialog title="Permanent link">&para;</a></h2> <p>AlertDialog中<code>\n</code>不换行，调用<code>create().show()</code>就可以了。</p> <h2 id=accentcolor>accentColor<a class=headerlink href=#accentcolor title="Permanent link">&para;</a></h2> <p>基础库中UI的style最好不要加上accentColor属性，不然上层可能TextView等各种崩溃</p> <h2 id=zipunzip>zip/unzip<a class=headerlink href=#zipunzip title="Permanent link">&para;</a></h2> <p>zip -q -r \&lt;zip_file_name> *</p> <p>unzip \&lt;zip_file_name> -d \&lt;path></p> <h2 id=maclauncher>Mac调整Launcher行列数<a class=headerlink href=#maclauncher title="Permanent link">&para;</a></h2> <p>Mac调整Launcher一屏显示多少行、多少列，比如7行10列。 </p> <div class=codehilite><pre><span></span>defaults write com.apple.dock springboard-rows -int 7
defaults write com.apple.dock springboard-columns -int 10
defaults write com.apple.dock ResetLaunchPad -bool TRUE;killall Dock
</pre></div> <h2 id=okhttp>OkHttp下载文件<a class=headerlink href=#okhttp title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span><span class=n>@Suppress</span><span class=p>(</span><span class=s>&quot;DEPRECATION&quot;</span><span class=p>)</span>
<span class=k>private</span> <span class=k>var</span> <span class=py>progressDialog</span><span class=p>:</span> <span class=n>ProgressDialog</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
<span class=k>private</span> <span class=k>var</span> <span class=py>apkFile</span><span class=p>:</span> <span class=n>File</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
<span class=k>private</span> <span class=k>fun</span> <span class=nf>doDownloadApk</span><span class=p>(</span><span class=n>versionRes</span><span class=p>:</span> <span class=n>VersionRes</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>apkFile</span> <span class=p>=</span> <span class=n>File</span><span class=p>(</span><span class=n>getExternalFilesDir</span><span class=p>(</span><span class=n>Environment</span><span class=p>.</span><span class=n>DIRECTORY_DOWNLOADS</span><span class=p>),</span> <span class=s>&quot;${BuildConfig.APPLICATION_ID}_${versionRes.version}.apk&quot;</span><span class=p>)</span>
    <span class=c1>// check file is exists or not</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>apkFile</span><span class=o>?.</span><span class=n>exists</span><span class=p>()</span> <span class=p>==</span> <span class=k>true</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>val</span> <span class=py>deleted</span> <span class=p>=</span> <span class=n>apkFile</span><span class=o>?.</span><span class=n>delete</span><span class=p>()</span>
        <span class=n>Logger</span><span class=p>.</span><span class=n>dTag</span><span class=p>(</span><span class=n>TAG_APP</span><span class=p>,</span> <span class=s>&quot;[SplashActivity] [doDownloadApk] apkFile exists, delete=$deleted&quot;</span><span class=p>)</span>
    <span class=p>}</span>

    <span class=c1>// check download url is illegal</span>
    <span class=k>val</span> <span class=py>apkUrl</span> <span class=p>=</span> <span class=n>versionRes</span><span class=p>.</span><span class=n>channelUrl</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>apkUrl</span><span class=p>.</span><span class=n>isNullOrEmpty</span><span class=p>())</span> <span class=p>{</span>
        <span class=n>Logger</span><span class=p>.</span><span class=n>eTag</span><span class=p>(</span><span class=n>TAG_APP</span><span class=p>,</span> <span class=s>&quot;[SplashActivity] [doDownloadApk] apkUrl isNullOrEmpty &gt;&gt;&gt;&gt;&gt;&gt; &quot;</span><span class=p>)</span>
        <span class=n>viewModel</span><span class=p>.</span><span class=n>checkSwitchEnable</span><span class=p>()</span>
        <span class=k>return</span>
    <span class=p>}</span>

    <span class=c1>// show progress dialog</span>
    <span class=n>@Suppress</span><span class=p>(</span><span class=s>&quot;DEPRECATION&quot;</span><span class=p>)</span>
    <span class=n>progressDialog</span> <span class=p>=</span> <span class=n>ProgressDialog</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=n>R</span><span class=p>.</span><span class=n>style</span><span class=p>.</span><span class=n>HddAlertDialog</span><span class=p>).</span><span class=n>apply</span> <span class=p>{</span>
        <span class=n>setMessage</span><span class=p>(</span><span class=n>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=n>string</span><span class=p>.</span><span class=n>download_apk_title</span><span class=p>))</span>
        <span class=n>setProgressStyle</span><span class=p>(</span><span class=n>ProgressDialog</span><span class=p>.</span><span class=n>STYLE_HORIZONTAL</span><span class=p>)</span>
        <span class=n>setCancelable</span><span class=p>(</span><span class=k>false</span><span class=p>)</span>
        <span class=n>setCanceledOnTouchOutside</span><span class=p>(</span><span class=k>false</span><span class=p>)</span>
        <span class=n>show</span><span class=p>()</span>
    <span class=p>}</span>

    <span class=c1>// begin download</span>
    <span class=n>Schedulers</span><span class=p>.</span><span class=n>newThread</span><span class=p>().</span><span class=n>createWorker</span><span class=p>().</span><span class=n>schedule</span> <span class=p>{</span>
        <span class=k>try</span> <span class=p>{</span>
            <span class=n>Logger</span><span class=p>.</span><span class=n>dTag</span><span class=p>(</span><span class=n>TAG_APP</span><span class=p>,</span> <span class=s>&quot;[SplashActivity] [doDownloadApk] download begin&quot;</span><span class=p>)</span>
            <span class=k>val</span> <span class=py>request</span> <span class=p>=</span> <span class=n>Request</span><span class=p>.</span><span class=n>Builder</span><span class=p>()</span>
                <span class=p>.</span><span class=n>url</span><span class=p>(</span><span class=n>apkUrl</span><span class=p>)</span>
                <span class=p>.</span><span class=n>build</span><span class=p>()</span>
            <span class=k>val</span> <span class=py>response</span> <span class=p>=</span> <span class=n>OkHttpClient</span><span class=p>.</span><span class=n>Builder</span><span class=p>().</span><span class=n>build</span><span class=p>().</span><span class=n>newCall</span><span class=p>(</span><span class=n>request</span><span class=p>).</span><span class=n>execute</span><span class=p>()</span>

            <span class=c1>// check response body</span>
            <span class=k>val</span> <span class=py>responseBody</span> <span class=p>=</span> <span class=n>response</span><span class=p>.</span><span class=n>body</span><span class=p>()</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>responseBody</span> <span class=p>==</span> <span class=k>null</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>viewModel</span><span class=p>.</span><span class=n>checkSwitchEnable</span><span class=p>()</span>
                <span class=k>return</span><span class=n>@schedule</span>
            <span class=p>}</span>
            <span class=k>val</span> <span class=py>inputStream</span> <span class=p>=</span> <span class=n>responseBody</span><span class=p>.</span><span class=n>byteStream</span><span class=p>()</span>
            <span class=c1>// get file size</span>
            <span class=k>val</span> <span class=py>contentLength</span> <span class=p>=</span> <span class=n>responseBody</span><span class=p>.</span><span class=n>contentLength</span><span class=p>()</span>
            <span class=c1>// set progress dialog max progress (shown in the bottom-right corner)</span>
            <span class=c1>// percent will be calculated by system</span>
            <span class=n>progressDialog</span><span class=o>?.</span><span class=n>max</span> <span class=p>=</span> <span class=n>contentLength</span><span class=p>.</span><span class=n>toInt</span><span class=p>()</span>
            <span class=n>Logger</span><span class=p>.</span><span class=n>dTag</span><span class=p>(</span><span class=n>TAG_APP</span><span class=p>,</span> <span class=s>&quot;[SplashActivity] [doDownloadApk] contentLength=$contentLength&quot;</span><span class=p>)</span>

            <span class=c1>// ready write files</span>
            <span class=k>val</span> <span class=py>fileOutputStream</span> <span class=p>=</span> <span class=n>FileOutputStream</span><span class=p>(</span><span class=n>apkFile</span><span class=p>)</span>
            <span class=k>val</span> <span class=py>bis</span> <span class=p>=</span> <span class=n>BufferedInputStream</span><span class=p>(</span><span class=n>inputStream</span><span class=p>)</span>
            <span class=k>val</span> <span class=py>buffer</span> <span class=p>=</span> <span class=n>ByteArray</span><span class=p>(</span><span class=m>1024</span><span class=p>)</span>
            <span class=k>var</span> <span class=py>length</span><span class=p>:</span> <span class=n>Int</span>
            <span class=k>var</span> <span class=py>downloaded</span> <span class=p>=</span> <span class=m>0</span>

            <span class=c1>// write files</span>
            <span class=k>do</span> <span class=p>{</span>
                <span class=n>length</span> <span class=p>=</span> <span class=n>bis</span><span class=p>.</span><span class=n>read</span><span class=p>(</span><span class=n>buffer</span><span class=p>)</span>
                <span class=k>if</span> <span class=p>(</span><span class=n>length</span> <span class=p>!=</span> <span class=p>-</span><span class=m>1</span><span class=p>)</span> <span class=p>{</span>
                    <span class=n>fileOutputStream</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=n>length</span><span class=p>)</span>
                    <span class=c1>// update progress</span>
                    <span class=n>downloaded</span> <span class=p>+=</span> <span class=n>length</span>
                    <span class=k>val</span> <span class=py>percent</span> <span class=p>=</span> <span class=p>(</span><span class=n>downloaded</span> <span class=p>*</span> <span class=m>100F</span> <span class=p>/</span> <span class=n>contentLength</span><span class=p>).</span><span class=n>toInt</span><span class=p>()</span>
                    <span class=n>progressDialog</span><span class=o>?.</span><span class=n>progress</span> <span class=p>=</span> <span class=n>downloaded</span>
                    <span class=n>Logger</span><span class=p>.</span><span class=n>dTag</span><span class=p>(</span><span class=n>TAG_APP</span><span class=p>,</span> <span class=s>&quot;[SplashActivity] [onProgress] progress = $percent&quot;</span><span class=p>)</span>
                <span class=p>}</span>
            <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=n>length</span> <span class=p>!=</span> <span class=p>-</span><span class=m>1</span><span class=p>)</span>
            <span class=n>fileOutputStream</span><span class=p>.</span><span class=n>flush</span><span class=p>()</span>
            <span class=n>fileOutputStream</span><span class=p>.</span><span class=n>close</span><span class=p>()</span>
            <span class=n>bis</span><span class=p>.</span><span class=n>close</span><span class=p>()</span>
            <span class=n>inputStream</span><span class=p>.</span><span class=n>close</span><span class=p>()</span>
            <span class=n>Logger</span><span class=p>.</span><span class=n>dTag</span><span class=p>(</span><span class=n>TAG_APP</span><span class=p>,</span> <span class=s>&quot;[SplashActivity] [doDownloadApk] download end&quot;</span><span class=p>)</span>

            <span class=c1>// write files done</span>
            <span class=n>progressDialog</span><span class=o>?.</span><span class=n>dismiss</span><span class=p>()</span>
            <span class=c1>// install apk</span>
            <span class=k>if</span> <span class=p>(</span><span class=n>FileUtils</span><span class=p>.</span><span class=n>isFileExists</span><span class=p>(</span><span class=n>apkFile</span><span class=p>))</span> <span class=p>{</span>
                <span class=n>@Suppress</span><span class=p>(</span><span class=s>&quot;DEPRECATION&quot;</span><span class=p>)</span>
                <span class=n>AppUtils</span><span class=p>.</span><span class=n>installApp</span><span class=p>(</span><span class=k>this</span><span class=n>@SplashActivity</span><span class=p>,</span> <span class=n>apkFile</span><span class=p>,</span> <span class=n>Constants</span><span class=p>.</span><span class=n>FILE_PROVIDER</span><span class=p>,</span> <span class=n>REQUEST_INSTALL_APP</span><span class=p>)</span>
            <span class=p>}</span>
        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=n>e</span><span class=p>:</span> <span class=n>Exception</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>e</span><span class=p>.</span><span class=n>printStackTrace</span><span class=p>()</span>
            <span class=n>runOnUiThread</span> <span class=p>{</span>
                <span class=n>YLToastUtils</span><span class=p>.</span><span class=n>showToast</span><span class=p>(</span>
                    <span class=n>getString</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=n>string</span><span class=p>.</span><span class=n>download_apk_error_try_again</span><span class=p>,</span> <span class=n>e</span><span class=p>.</span><span class=n>message</span><span class=p>),</span>
                    <span class=n>duration</span> <span class=p>=</span> <span class=n>Toast</span><span class=p>.</span><span class=n>LENGTH_LONG</span>
                <span class=p>)</span>
                <span class=n>viewModel</span><span class=p>.</span><span class=n>checkSwitchEnable</span><span class=p>()</span>
            <span class=p>}</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div> <h2 id=monkey>monkey测试：<a class=headerlink href=#monkey title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span>adb shell monkey -p &lt;package-name&gt; --throttle <span class=m>100</span> --pct-touch <span class=m>50</span> --pct-motion <span class=m>50</span> -v -v &lt;count&gt; &gt; &lt;file_path&gt;
</pre></div> <h2 id=app>App物料尺寸<a class=headerlink href=#app title="Permanent link">&para;</a></h2> <p>app icon的尺寸：</p> <p>logo (3:4:6:8:12:16)</p> <table> <thead> <tr> <th>name</th> <th>scale</th> <th>普通</th> <th>adaptive icon</th> </tr> </thead> <tbody> <tr> <td>ldip</td> <td>0.75</td> <td>108</td> <td>81</td> </tr> <tr> <td>mdpi</td> <td>1</td> <td>144</td> <td>108</td> </tr> <tr> <td>hdpi</td> <td>1.5</td> <td>192</td> <td>162</td> </tr> <tr> <td>xhdpi</td> <td>2</td> <td>256</td> <td>216</td> </tr> <tr> <td>xxhdpi</td> <td>3</td> <td>384</td> <td>324</td> </tr> <tr> <td>xxxhdpi</td> <td>4</td> <td>512</td> <td>432</td> </tr> </tbody> </table> <p>adaptive icon直接采用Android Studio中Image Asset工具进行生成即可。</p> <p>两者可以共存：</p> <ol> <li>在mipmap-*dpi中放入普通的icon，取名为ic_launcher</li> <li>使用Image Asset工具生成adaptive icon，在Legacy选项卡中去除不需要的icon。这样会生成会在mipmap-*dpi目录下生成一套ic_launcher_foreground和一套ic_launcher_background，同时会在mipmap-anydpi-v26中生成一个ic_launcher.xml文件，里面会引用ic_launcher_foreground和ic_launcher_background资源。</li> </ol> <p>引导页 - 2160×1080（适配全面屏） - 1920x1080 - 720x1280</p> <p>屏幕快照 - 480x800 (vivo) - 1080x1920</p> <h2 id=statusbarnavigationbar>StatusBar和NavigationBar完全透明<a class=headerlink href=#statusbarnavigationbar title="Permanent link">&para;</a></h2> <p>代码方式：</p> <div class=codehilite><pre><span></span><span class=k>if</span> <span class=p>(</span><span class=n>Build</span><span class=p>.</span><span class=n>VERSION</span><span class=p>.</span><span class=n>SDK_INT</span> <span class=p>&gt;=</span> <span class=n>Build</span><span class=p>.</span><span class=n>VERSION_CODES</span><span class=p>.</span><span class=n>LOLLIPOP</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>window</span><span class=p>.</span><span class=n>statusBarColor</span> <span class=p>=</span> <span class=n>Color</span><span class=p>.</span><span class=n>TRANSPARENT</span>
    <span class=n>window</span><span class=p>.</span><span class=n>navigationBarColor</span> <span class=p>=</span> <span class=n>Color</span><span class=p>.</span><span class=n>TRANSPARENT</span>
<span class=p>}</span>
<span class=n>window</span><span class=p>.</span><span class=n>setFlags</span><span class=p>(</span>
    <span class=n>WindowManager</span><span class=p>.</span><span class=n>LayoutParams</span><span class=p>.</span><span class=n>FLAG_LAYOUT_NO_LIMITS</span><span class=p>,</span>
    <span class=n>WindowManager</span><span class=p>.</span><span class=n>LayoutParams</span><span class=p>.</span><span class=n>FLAG_LAYOUT_NO_LIMITS</span>
<span class=p>)</span>
<span class=n>StatusBarUtil</span><span class=p>.</span><span class=n>setTransparent</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=k>false</span><span class=p>)</span>
</pre></div> <p>From <a href=https://stackoverflow.com/a/31596735/7440866>StackOverflow</a></p> <h2 id=_5>查看签名证书信息<a class=headerlink href=#_5 title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span>keytool -v -list -keystore &lt;keystore&gt;
</pre></div> <p>然后输入密码即可。</p> <h2 id=dynamic-permission>Dynamic Permission<a class=headerlink href=#dynamic-permission title="Permanent link">&para;</a></h2> <p><a href=https://developer.android.com/training/permissions/requesting>Request App Permissions</a></p> <p>Android在6.0及后对于危险权限需要动态申请，目前(<em>2019-06-24</em>)动态权限有以下10组共计26个权限，表格如下：</p> <p><a href=https://developer.android.com/guide/topics/permissions/overview.html#perm-groups>Permission groups</a></p> <figcaption>Dangerous permissions and permission groups.</figcaption> <table> <thead> <tr> <th>Permission Group</th> <th>Permissions</th> </tr> </thead> <tbody> <tr> <td>CALENDAR</td> <td>READ_CALENDAR<br>WRITE_CALENDAR</td> </tr> <tr> <td>CALL_LOG</td> <td>READ_CALL_LOG<br>WRITE_CALL_LOG<br>PROCESS_OUTGOING_CALLS</td> </tr> <tr> <td>CAMERA</td> <td>CAMERA</td> </tr> <tr> <td>CONTACTS</td> <td>READ_CONTACTS<br>WRITE_CONTACTS<br>GET_ACCOUNTS</td> </tr> <tr> <td>LOCATION</td> <td>ACCESS_FINE_LOCATION<br>ACCESS_COARSE_LOCATION</td> </tr> <tr> <td>MICROPHONE</td> <td>RECORD_AUDIO</td> </tr> <tr> <td>PHONE</td> <td>READ_PHONE_STATE<br>READ_PHONE_NUMBERS<br>CALL_PHONE<br>ANSWER_PHONE_CALLS<br>ADD_VOICEMAIL<br>USE_SIP</td> </tr> <tr> <td>SENSORS</td> <td>BODY_SENSORS</td> </tr> <tr> <td>SMS</td> <td>SEND_SMS<br>RECEIVE_SMS<br>READ_SMS<br>RECEIVE_WAP_PUSH<br>RECEIVE_MMS</td> </tr> <tr> <td>STORAGE</td> <td>READ_EXTERNAL_STORAGE<br>WRITE_EXTERNAL_STORAGE</td> </tr> </tbody> </table> <p><strong>注</strong>：您的应用仍需要明确请求其需要的每项权限，即使用户已向应用授予该权限组中的其他权限。此外，权限分组在将来的 Android 版本中可能会发生变化。您的代码不应依赖特定权限属于或不属于相同组这种假设。</p> <p>运行时权限的处理涉及到以下四个方法：</p> <ul> <li><code>ContextCompat.checkSelfPermission</code><br> 检查权限是否已经授予</li> <li><code>ActivityCompat.shouldShowRequestPermissionRationale</code> 在用户已经拒绝某项权限时，用来向用户解释为什么需要权限。<br> 如果用户没有申请过、或者第二次或以上拒绝时选择了<code>Don't ask again</code>选项，此方法会返回false<br> 如果用户拒绝了权限请求，此方法会返回true</li> <li><code>ActivityCompat.requestPermissions</code><br> 申请权限</li> <li><code>onRequestPermissionsResult</code><br> 申请权限的回调</li> </ul> <p>动态权限申请流程代码片段如下：</p> <div class=codehilite><pre><span></span><span class=k>private</span> <span class=k>fun</span> <span class=nf>permission</span><span class=p>()</span> <span class=p>{</span>
    <span class=k>val</span> <span class=py>thisActivity</span> <span class=p>=</span> <span class=k>this</span>

    <span class=c1>// Here, thisActivity is the current activity</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>ContextCompat</span><span class=p>.</span><span class=n>checkSelfPermission</span><span class=p>(</span><span class=n>thisActivity</span><span class=p>,</span>
            <span class=n>Manifest</span><span class=p>.</span><span class=n>permission</span><span class=p>.</span><span class=n>READ_CONTACTS</span><span class=p>)</span>
        <span class=p>!=</span> <span class=n>PackageManager</span><span class=p>.</span><span class=n>PERMISSION_GRANTED</span><span class=p>)</span> <span class=p>{</span>

        <span class=c1>// Permission is not granted</span>
        <span class=c1>// Should we show an explanation?</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>ActivityCompat</span><span class=p>.</span><span class=n>shouldShowRequestPermissionRationale</span><span class=p>(</span><span class=n>thisActivity</span><span class=p>,</span>
                <span class=n>Manifest</span><span class=p>.</span><span class=n>permission</span><span class=p>.</span><span class=n>READ_CONTACTS</span><span class=p>))</span> <span class=p>{</span>
            <span class=c1>// Show an explanation to the user *asynchronously* -- don&#39;t block</span>
            <span class=c1>// this thread waiting for the user&#39;s response! After the user</span>
            <span class=c1>// sees the explanation, try again to request the permission.</span>

            <span class=c1>// @@@ add by author</span>
            <span class=n>showRequestPermissionRationale</span><span class=p>()</span>
            <span class=c1>// @@@</span>
        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
            <span class=c1>// No explanation needed, we can request the permission.</span>
            <span class=n>ActivityCompat</span><span class=p>.</span><span class=n>requestPermissions</span><span class=p>(</span><span class=n>thisActivity</span><span class=p>,</span>
                <span class=n>arrayOf</span><span class=p>(</span><span class=n>Manifest</span><span class=p>.</span><span class=n>permission</span><span class=p>.</span><span class=n>READ_CONTACTS</span><span class=p>),</span>
                <span class=n>MY_PERMISSIONS_REQUEST_READ_CONTACTS</span><span class=p>)</span>

            <span class=c1>// MY_PERMISSIONS_REQUEST_READ_CONTACTS is an</span>
            <span class=c1>// app-defined int constant. The callback method gets the</span>
            <span class=c1>// result of the request.</span>
        <span class=p>}</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
        <span class=c1>// Permission has already been granted</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>override</span> <span class=k>fun</span> <span class=nf>onRequestPermissionsResult</span><span class=p>(</span><span class=n>requestCode</span><span class=p>:</span> <span class=n>Int</span><span class=p>,</span>
                                        <span class=n>permissions</span><span class=p>:</span> <span class=n>Array</span><span class=p>&lt;</span><span class=n>String</span><span class=p>&gt;,</span> <span class=n>grantResults</span><span class=p>:</span> <span class=n>IntArray</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>when</span> <span class=p>(</span><span class=n>requestCode</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>MY_PERMISSIONS_REQUEST_READ_CONTACTS</span> <span class=p>-&gt;</span> <span class=p>{</span>

            <span class=c1>// If request is cancelled, the result arrays are empty.</span>
            <span class=k>if</span> <span class=p>((</span><span class=n>grantResults</span><span class=p>.</span><span class=n>isNotEmpty</span><span class=p>()</span> <span class=p>&amp;&amp;</span> <span class=n>grantResults</span><span class=p>[</span><span class=m>0</span><span class=p>]</span> <span class=p>==</span> <span class=n>PackageManager</span><span class=p>.</span><span class=n>PERMISSION_GRANTED</span><span class=p>))</span> <span class=p>{</span>
                <span class=c1>// permission was granted, yay! Do the</span>
                <span class=c1>// contacts-related task you need to do.</span>
            <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                <span class=c1>// permission denied, boo! Disable the</span>
                <span class=c1>// functionality that depends on this permission.</span>
            <span class=p>}</span>
            <span class=k>return</span>
        <span class=p>}</span>

        <span class=c1>// Add other &#39;when&#39; lines to check for other</span>
        <span class=c1>// permissions this app might request.</span>
        <span class=k>else</span> <span class=p>-&gt;</span> <span class=p>{</span>
            <span class=c1>// Ignore all other requests.</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>

<span class=k>private</span> <span class=k>fun</span> <span class=nf>showRequestPermissionRationale</span><span class=p>()</span> <span class=p>{</span>
    <span class=n>AlertDialog</span><span class=p>.</span><span class=n>Builder</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
        <span class=p>.</span><span class=n>setTitle</span><span class=p>(</span><span class=s>&quot;RequestPermissionRationale&quot;</span><span class=p>)</span>
        <span class=p>.</span><span class=n>setMessage</span><span class=p>(</span><span class=s>&quot;This is the message&quot;</span><span class=p>)</span>
        <span class=p>.</span><span class=n>setPositiveButton</span><span class=p>(</span><span class=n>android</span><span class=p>.</span><span class=n>R</span><span class=p>.</span><span class=n>string</span><span class=p>.</span><span class=n>ok</span><span class=p>)</span> <span class=p>{</span> <span class=n>_</span><span class=p>,</span> <span class=n>_</span> <span class=p>-&gt;</span>
            <span class=n>ActivityCompat</span><span class=p>.</span><span class=n>requestPermissions</span><span class=p>(</span><span class=k>this</span><span class=p>,</span>
                <span class=n>arrayOf</span><span class=p>(</span><span class=n>Manifest</span><span class=p>.</span><span class=n>permission</span><span class=p>.</span><span class=n>READ_CONTACTS</span><span class=p>),</span>
                <span class=n>MY_PERMISSIONS_REQUEST_READ_CONTACTS</span><span class=p>)</span>
        <span class=p>}.</span><span class=n>setNegativeButton</span><span class=p>(</span><span class=n>android</span><span class=p>.</span><span class=n>R</span><span class=p>.</span><span class=n>string</span><span class=p>.</span><span class=n>cancel</span><span class=p>,</span> <span class=k>null</span><span class=p>)</span>
        <span class=p>.</span><span class=n>create</span><span class=p>()</span>
        <span class=p>.</span><span class=n>show</span><span class=p>()</span>
<span class=p>}</span>

<span class=k>companion</span> <span class=k>object</span> <span class=p>{</span>
    <span class=k>private</span> <span class=k>const</span> <span class=k>val</span> <span class=py>MY_PERMISSIONS_REQUEST_READ_CONTACTS</span> <span class=p>=</span> <span class=m>0</span><span class=n>x1111</span>
<span class=p>}</span>
</pre></div> <p><a href=/assets/images/android/dynamic-permission-flow.png><img alt=动态权限流程图 src=/assets/images/android/dynamic-permission-flow.png></a></p> <blockquote> <p>BTW，在权限请求回调的权限拒绝的分支中，此时我们再次调用<code>ActivityCompat.shouldShowRequestPermissionRationale</code>方法，如果返回true表示用户拒绝了权限；如果返回了false，表示用户拒绝了权限且勾选了不再提醒，此时我们弹框提醒用户。<br> 可以参考PermissionDispatcher中生成的辅助代码——<a href=/android/3rd-library/permissiondispatcher/#kt>MainActivity.kt对应的辅助代码</a></p> </blockquote> <h2 id=google-chromedarkmode>Google Chrome强制禁用darkmode<a class=headerlink href=#google-chromedarkmode title="Permanent link">&para;</a></h2> <div class=codehilite><pre><span></span>defaults write com.google.Chrome NSRequiresAquaSystemAppearance -bool YES
</pre></div> <h2 id=anr>ANR的判定<a class=headerlink href=#anr title="Permanent link">&para;</a></h2> <ol> <li>Activity超过5秒无响应</li> <li>BroadcastReceiver超过10秒无响应</li> <li>Service超过20秒无响应</li> </ol> <h2 id=recyclerview>RecyclerView是否到顶部<a class=headerlink href=#recyclerview title="Permanent link">&para;</a></h2> <p><code>RecyclerView.canScrollVertically(-1)</code> </p> <ul> <li><code>true</code> 表示还没有到顶部</li> <li><code>false</code> 表示到顶部了</li> </ul> <h2 id=_6>判断程序是否运行在主进程<a class=headerlink href=#_6 title="Permanent link">&para;</a></h2> <p>私有多进程下，pid相等的进程可能是主进程或者子进程。获取当前进程id对应的进程，判断进程名是否是包名即可。</p> <div class=codehilite><pre><span></span><span class=k>private</span> <span class=k>fun</span> <span class=nf>isMainProcess</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=n>Context</span><span class=p>)</span> <span class=p>:</span> <span class=n>Boolean</span> <span class=p>{</span>
    <span class=k>val</span> <span class=py>activityManager</span> <span class=p>=</span> <span class=n>context</span><span class=p>.</span><span class=n>getSystemService</span><span class=p>(</span><span class=n>Context</span><span class=p>.</span><span class=n>ACTIVITY_SERVICE</span><span class=p>)</span> <span class=k>as</span><span class=p>?</span> <span class=n>ActivityManager</span>

    <span class=n>activityManager</span><span class=o>?.</span><span class=n>runningAppProcesses</span><span class=o>?.</span><span class=n>find</span> <span class=p>{</span>
        <span class=n>it</span><span class=p>.</span><span class=n>pid</span> <span class=p>==</span> <span class=n>Process</span><span class=p>.</span><span class=n>myPid</span><span class=p>()</span>
    <span class=p>}</span><span class=o>?.</span><span class=n>let</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>it</span><span class=p>.</span><span class=n>processName</span> <span class=p>==</span> <span class=n>context</span><span class=p>.</span><span class=n>packageName</span>
    <span class=p>}</span>

    <span class=k>return</span> <span class=k>false</span>
<span class=p>}</span>
</pre></div> <h2 id=drawable2bitmap>Drawable2Bitmap<a class=headerlink href=#drawable2bitmap title="Permanent link">&para;</a></h2> <p>通过Canvas将Drawable画到空白的Bitmap上。</p> <div class=codehilite><pre><span></span><span class=k>private</span> <span class=k>fun</span> <span class=nf>getBitmapFromDrawableResourceId</span><span class=p>(</span><span class=n>context</span><span class=p>:</span> <span class=n>Context</span><span class=p>,</span> <span class=n>@DrawableRes</span> <span class=n>drawableId</span><span class=p>:</span> <span class=n>Int</span><span class=p>):</span> <span class=n>Bitmap</span> <span class=p>{</span>
    <span class=k>val</span> <span class=py>drawable</span> <span class=p>=</span> <span class=n>ContextCompat</span><span class=p>.</span><span class=n>getDrawable</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=n>drawableId</span><span class=p>)</span><span class=o>!!</span>
    <span class=k>val</span> <span class=py>bitmap</span> <span class=p>=</span> <span class=n>Bitmap</span><span class=p>.</span><span class=n>createBitmap</span><span class=p>(</span><span class=n>drawable</span><span class=p>.</span><span class=n>intrinsicWidth</span><span class=p>,</span> <span class=n>drawable</span><span class=p>.</span><span class=n>intrinsicHeight</span><span class=p>,</span> <span class=n>Bitmap</span><span class=p>.</span><span class=n>Config</span><span class=p>.</span><span class=n>ARGB_8888</span><span class=p>)</span>
    <span class=k>val</span> <span class=py>canvas</span> <span class=p>=</span> <span class=n>Canvas</span><span class=p>(</span><span class=n>bitmap</span><span class=p>)</span>
    <span class=n>drawable</span><span class=p>.</span><span class=n>setBounds</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=n>drawable</span><span class=p>.</span><span class=n>intrinsicWidth</span><span class=p>,</span> <span class=n>drawable</span><span class=p>.</span><span class=n>intrinsicHeight</span><span class=p>)</span>
    <span class=n>drawable</span><span class=p>.</span><span class=n>draw</span><span class=p>(</span><span class=n>canvas</span><span class=p>)</span>

    <span class=k>return</span> <span class=n>bitmap</span>
<span class=p>}</span>
</pre></div> <h2 id=gravity>Gravity的妙用<a class=headerlink href=#gravity title="Permanent link">&para;</a></h2> <p>在一个小红点需求中，由于想封装的更完整一点，所以设计了一个包裹普通View的小红点FrameLayout，该FrameLayout监听对应的小红点事件，从而显示或隐藏小红点。这样业务上的View一般情况无需处理小红点的相关逻辑。<br> 所以在设计BadgeFrameLayout时，需要事先设置好小红点需要显示的位置，这里参考了gravity的一些实现：</p> <p>BadgeFrameLayout使用下面属性来指定小红点的位置：</p> <div class=codehilite><pre><span></span><span class=nt>&lt;declare-styleable</span> <span class=na>name=</span><span class=s>&quot;BadgeFrameLayout&quot;</span><span class=nt>&gt;</span>
    <span class=c>&lt;!-- badge的方位 --&gt;</span>
    <span class=nt>&lt;attr</span> <span class=na>name=</span><span class=s>&quot;badgeGravity&quot;</span> <span class=na>format=</span><span class=s>&quot;flags&quot;</span><span class=nt>&gt;</span>
        <span class=nt>&lt;flag</span> <span class=na>name=</span><span class=s>&quot;top&quot;</span> <span class=na>value=</span><span class=s>&quot;0x30&quot;</span> <span class=nt>/&gt;</span>
        <span class=nt>&lt;flag</span> <span class=na>name=</span><span class=s>&quot;bottom&quot;</span> <span class=na>value=</span><span class=s>&quot;0x50&quot;</span> <span class=nt>/&gt;</span>
        <span class=nt>&lt;flag</span> <span class=na>name=</span><span class=s>&quot;left&quot;</span> <span class=na>value=</span><span class=s>&quot;0x03&quot;</span> <span class=nt>/&gt;</span>
        <span class=nt>&lt;flag</span> <span class=na>name=</span><span class=s>&quot;right&quot;</span> <span class=na>value=</span><span class=s>&quot;0x05&quot;</span> <span class=nt>/&gt;</span>
        <span class=nt>&lt;flag</span> <span class=na>name=</span><span class=s>&quot;center_vertical&quot;</span> <span class=na>value=</span><span class=s>&quot;0x10&quot;</span> <span class=nt>/&gt;</span>
        <span class=nt>&lt;flag</span> <span class=na>name=</span><span class=s>&quot;center_horizontal&quot;</span> <span class=na>value=</span><span class=s>&quot;0x01&quot;</span> <span class=nt>/&gt;</span>
        <span class=nt>&lt;flag</span> <span class=na>name=</span><span class=s>&quot;center&quot;</span> <span class=na>value=</span><span class=s>&quot;0x11&quot;</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;/attr&gt;</span>
    <span class=c>&lt;!-- badge在X-Y方向上的偏移量，follow gravity --&gt;</span>
    <span class=nt>&lt;attr</span> <span class=na>name=</span><span class=s>&quot;badgeXAdj&quot;</span> <span class=na>format=</span><span class=s>&quot;dimension&quot;</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;attr</span> <span class=na>name=</span><span class=s>&quot;badgeYAdj&quot;</span> <span class=na>format=</span><span class=s>&quot;dimension&quot;</span> <span class=nt>/&gt;</span>
    ...
<span class=nt>&lt;/declare-styleable&gt;</span>
</pre></div> <p>在代码中这样来确定小红点的rect：</p> <div class=codehilite><pre><span></span><span class=k>override</span> <span class=k>fun</span> <span class=nf>onMeasure</span><span class=p>(</span><span class=n>widthMeasureSpec</span><span class=p>:</span> <span class=n>Int</span><span class=p>,</span> <span class=n>heightMeasureSpec</span><span class=p>:</span> <span class=n>Int</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>super</span><span class=p>.</span><span class=n>onMeasure</span><span class=p>(</span><span class=n>widthMeasureSpec</span><span class=p>,</span> <span class=n>heightMeasureSpec</span><span class=p>)</span>

    <span class=c1>// 容器的rect</span>
    <span class=n>mBadgeContainer</span><span class=p>.</span><span class=k>set</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=n>measuredWidth</span><span class=p>,</span> <span class=n>measuredHeight</span><span class=p>)</span>
    <span class=c1>// mBadgeRadius为小红点的半径，mBadgeRect就是计算出来的小红点的rect</span>
    <span class=n>Gravity</span><span class=p>.</span><span class=n>apply</span><span class=p>(</span><span class=n>mGravity</span><span class=p>,</span>
        <span class=n>mBadgeRadius</span> <span class=n>shl</span> <span class=m>1</span><span class=p>,</span>
        <span class=n>mBadgeRadius</span> <span class=n>shl</span> <span class=m>1</span><span class=p>,</span>
        <span class=n>mBadgeContainer</span><span class=p>,</span>
        <span class=n>mBadgeXAdj</span><span class=p>,</span>
        <span class=n>mBadgeYAdj</span><span class=p>,</span>
        <span class=n>mBadgeRect</span>
    <span class=p>)</span>
<span class=p>}</span>
</pre></div> <p><code>Gravity.apply</code>方法可以避免绘制超过边界，不需要我们自己做一些麻烦的运算，还是相当方便的。方法解释见： <a href="https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/view/Gravity.java;l=186?q=Gravity.apply">https://cs.android.com/android/platform/superproject/+/master:frameworks/base/core/java/android/view/Gravity.java;l=186?q=Gravity.apply</a></p> <h2 id=9patch>9patch<a class=headerlink href=#9patch title="Permanent link">&para;</a></h2> <p>长期不用还是会忘记，具体来说可以参考<a href="https://developer.android.google.cn/studio/write/draw9patch?hl=zh_cn">Google官网</a></p> <p>左边上边的线条决定哪些区域可以被缩放，右边下边的线条决定哪个区域显示内容。</p> <hr> <div class=md-source-date> <small> 最后更新: 2020年2月13日 </small> </div> <h2 id=__comments>评论</h2> <div id=disqus_thread></div> <script>
    var disqus_config = function () {
      this.page.url = "https://blog.yorek.xyz/about-me/android/other/琐碎知识点/";
      this.page.identifier =
        "/android/other/琐碎知识点/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//yorekliu.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../腾讯X5内核入坑指南/ title="腾讯TBS X5浏览器内核入坑指南" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> 上一页 </span> 腾讯TBS X5浏览器内核入坑指南 </span> </div> </a> <a href=../../../flutter/flutter_first_project_1/ title=年轻人的第一个Flutter程序(1) class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> 下一页 </span> 年轻人的第一个Flutter程序(1) </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> &copy; 2020 Yorek </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../../assets/fonts/font-awesome.css> <a href=https://github.com/YorekLiu class="md-footer-social__link fa fa-github"></a> <a href=lyytogether@gmail.com class="md-footer-social__link fa fa-email"></a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/application.808e90bb.js></script> <script src=../../../assets/javascripts/lunr/lunr.stemmer.support.js></script> <script src=../../../assets/javascripts/lunr/tinyseg.js></script> <script src=../../../assets/javascripts/lunr/lunr.ja.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>