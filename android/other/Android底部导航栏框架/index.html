<!--
  Copyright (c) 2016-2020 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=description content="An Android Developer."><link href=https://blog.yorek.xyz/about-me/android/other/Android底部导航栏框架/ rel=canonical><meta name=author content="Yorek Liu"><meta name=lang:clipboard.copy content=复制><meta name=lang:clipboard.copied content=已复制><meta name=lang:search.language content=ja><meta name=lang:search.pipeline.stopwords content=True><meta name=lang:search.pipeline.trimmer content=True><meta name=lang:search.result.none content=没有找到符合条件的结果><meta name=lang:search.result.one content="找到 1 个符合条件的结果"><meta name=lang:search.result.other content="# 个符合条件的结果"><meta name=lang:search.tokenizer content=[\uff0c\u3002]+><link rel="shortcut icon" href=../../../assets/images/favicon.ico><meta name=generator content="mkdocs-1.0.4, mkdocs-material-4.6.0"><title>Android原生底部导航栏</title><link rel=stylesheet href=../../../assets/stylesheets/application.1b62728e.css><link rel=stylesheet href=../../../assets/stylesheets/application-palette.a8b3c06d.css><meta name=theme-color content><script src=../../../assets/javascripts/modernizr.268332fc.js></script><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel=stylesheet href=../../../assets/fonts/material-icons.css><link rel=manifest href=../../../manifest.webmanifest><script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-155096376-1", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script><script async src=https://www.google-analytics.com/analytics.js></script><!-- Determine title --><!-- The image needs to have an absolute URL --><!-- Open graph meta tags --><meta property=og:type content=website><meta property=og:title content="Yorek's - Android原生底部导航栏"><meta property=og:description content="An Android Developer."><meta content=https://blog.yorek.xyz/about-me/android/other/Android底部导航栏框架/ property=og:url><meta property=og:image content=https://blog.yorek.xyz/about-meassets/images/banner.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><!-- Twitter meta tags --><meta name=twitter:card content=summary_large_image><meta name=twitter:site content=@squidfunk><meta name=twitter:creator content=@squidfunk><meta name=twitter:title content="Yorek's - Android原生底部导航栏"><meta name=twitter:description content="An Android Developer."><meta name=twitter:image content=https://blog.yorek.xyz/about-meassets/images/banner.png></head> <body dir=ltr data-md-color-primary=white data-md-color-accent=blue> <svg class=md-svg> <defs> </defs> </svg> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay data-md-component=overlay for=__drawer></label> <a href=#1-bottomnavigationview tabindex=1 class=md-skip> 跳转至 </a> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid"> <div class=md-flex> <div class="md-flex__cell md-flex__cell--shrink"> <a href=https://blog.yorek.xyz/about-me title="Yorek's" class="md-header-nav__button md-logo"> <img src=../../../assets/images/favicon.ico width=24 height=24> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title> <span class=md-header-nav__topic> Yorek's </span> <span class=md-header-nav__topic> Android原生底部导航栏 </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search></label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=query data-md-state=active> <label class="md-icon md-search__icon" for=__search></label> <button type=reset class="md-icon md-search__icon" data-md-component=reset tabindex=-1> &#xE5CD; </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=result> <div class=md-search-result__meta> 键入以开始搜索 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container> <nav class="md-tabs md-tabs--active" data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../3rd-library/3rd-library-source-code/ class=md-tabs__link> Android </a> </li> <li class=md-tabs__item> <a href=../../../flutter/flutter_first_project_1/ class=md-tabs__link> Flutter </a> </li> <li class=md-tabs__item> <a href=../../../leetcode/ class=md-tabs__link> LeetCode </a> </li> <li class=md-tabs__item> <a href=../../../design-pattern/design-pattern/ class=md-tabs__link> Books </a> </li> </ul> </div> </nav> <main class=md-main role=main> <div class="md-main__inner md-grid" data-md-component=container> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" data-md-level=0> <label class="md-nav__title md-nav__title--site" for=__drawer> <a href=https://blog.yorek.xyz/about-me title="Yorek's" class="md-nav__button md-logo"> <img src=../../../assets/images/favicon.ico width=48 height=48> </a> Yorek's </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. title=Home class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2 type=checkbox id=nav-2 checked> <label class=md-nav__link for=nav-2> Android </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-2> Android </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-1 type=checkbox id=nav-2-1> <label class=md-nav__link for=nav-2-1> 三方库源码解析 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-1> 三方库源码解析 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../3rd-library/3rd-library-source-code/ title=Android三方库源码分析 class=md-nav__link> Android三方库源码分析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/matrix/ title="微信APM Matrix解析" class=md-nav__link> 微信APM Matrix解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/matrix-trace/ title=Matrix-TraceCanary解析 class=md-nav__link> Matrix-TraceCanary解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/matrix-io/ title=Matrix-IOCanary解析 class=md-nav__link> Matrix-IOCanary解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/matrix-resource/ title=Matrix-ResourceCanary解析 class=md-nav__link> Matrix-ResourceCanary解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/matrix-sqlitelint/ title=Matrix-SQLiteLint解析 class=md-nav__link> Matrix-SQLiteLint解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/okhttp/ title=OkHttp3源码解析 class=md-nav__link> OkHttp3源码解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/retrofit/ title=Retrofit2源码解析 class=md-nav__link> Retrofit2源码解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/rxjava&rxandroid/ title=RxJava源码解析及使用实例 class=md-nav__link> RxJava源码解析及使用实例 </a> </li> <li class=md-nav__item> <a href=../RxJava/ title=RxJava操作符大全 class=md-nav__link> RxJava操作符大全 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide1/ title="Glide v4 源码解析（一）" class=md-nav__link> Glide v4 源码解析（一） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide2/ title="Glide v4 源码解析（二）" class=md-nav__link> Glide v4 源码解析（二） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide3/ title="Glide v4 源码解析（三）" class=md-nav__link> Glide v4 源码解析（三） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide4/ title="Glide v4 源码解析（四）" class=md-nav__link> Glide v4 源码解析（四） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide5/ title="Glide v4 源码解析（五）" class=md-nav__link> Glide v4 源码解析（五） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide6/ title="Glide v4 源码解析（六）" class=md-nav__link> Glide v4 源码解析（六） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/glide7/ title="Glide v4 源码解析（七）" class=md-nav__link> Glide v4 源码解析（七） </a> </li> <li class=md-nav__item> <a href=../../3rd-library/migrate-to-glide/ title=杂记：从Picasso迁移至Glide class=md-nav__link> 杂记：从Picasso迁移至Glide </a> </li> <li class=md-nav__item> <a href=../../3rd-library/eventbus/ title=EventBus源码解析 class=md-nav__link> EventBus源码解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/leakcanary/ title=LeakCanary2源码解析 class=md-nav__link> LeakCanary2源码解析 </a> </li> <li class=md-nav__item> <a href=../../3rd-library/permissiondispatcher/ title=PermissionDispatcher源码解析 class=md-nav__link> PermissionDispatcher源码解析 </a> </li> <li class=md-nav__item> <a href=../constraintlayout/ title=ConstraintLayout使用大全 class=md-nav__link> ConstraintLayout使用大全 </a> </li> <li class=md-nav__item> <a href=../dagger2/ title=初学者的Dagger2教程 class=md-nav__link> 初学者的Dagger2教程 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-2 type=checkbox id=nav-2-2> <label class=md-nav__link for=nav-2-2> Android开发高手课 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-2> Android开发高手课 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../paid/master/ title=Android开发高手课 class=md-nav__link> Android开发高手课 </a> </li> <li class=md-nav__item> <a href=../../paid/master/crash_1/ title="01 | 崩溃优化（上）：关于“崩溃”那些事儿" class=md-nav__link> 01 | 崩溃优化（上）：关于“崩溃”那些事儿 </a> </li> <li class=md-nav__item> <a href=../../paid/master/crash_2/ title="02 | 崩溃优化（下）：应用崩溃了，你应该如何去分析？" class=md-nav__link> 02 | 崩溃优化（下）：应用崩溃了，你应该如何去分析？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/memory_1/ title="03 | 内存优化（上）：4GB内存时代，再谈内存优化" class=md-nav__link> 03 | 内存优化（上）：4GB内存时代，再谈内存优化 </a> </li> <li class=md-nav__item> <a href=../../paid/master/memory_2/ title="04 | 内存优化（下）：内存优化这件事，应该从哪里着手？" class=md-nav__link> 04 | 内存优化（下）：内存优化这件事，应该从哪里着手？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/stuck_1/ title="05 | 卡顿优化（上）：你要掌握的卡顿分析方法" class=md-nav__link> 05 | 卡顿优化（上）：你要掌握的卡顿分析方法 </a> </li> <li class=md-nav__item> <a href=../../paid/master/stuck_2/ title="06 | 卡顿优化（下）：如何监控应用卡顿？" class=md-nav__link> 06 | 卡顿优化（下）：如何监控应用卡顿？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/stuck_3/ title="06补充篇 | 卡顿优化：卡顿现场与卡顿分析" class=md-nav__link> 06补充篇 | 卡顿优化：卡顿现场与卡顿分析 </a> </li> <li class=md-nav__item> <a href=../../paid/master/start_1/ title="07 | 启动优化（上）：从启动过程看启动速度优化" class=md-nav__link> 07 | 启动优化（上）：从启动过程看启动速度优化 </a> </li> <li class=md-nav__item> <a href=../../paid/master/start_2/ title="08 | 启动优化（下）：优化启动速度的进阶方法" class=md-nav__link> 08 | 启动优化（下）：优化启动速度的进阶方法 </a> </li> <li class=md-nav__item> <a href=../../paid/master/io_1/ title="09 | I/O优化（上）：开发工程师必备的I/O优化知识" class=md-nav__link> 09 | I/O优化（上）：开发工程师必备的I/O优化知识 </a> </li> <li class=md-nav__item> <a href=../../paid/master/io_2/ title="10 | I/O优化（中）：不同I/O方式的使用场景是什么？" class=md-nav__link> 10 | I/O优化（中）：不同I/O方式的使用场景是什么？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/io_3/ title="11 | I/O优化（下）：如何监控线上I/O操作？" class=md-nav__link> 11 | I/O优化（下）：如何监控线上I/O操作？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/storage_1/ title="12 | 存储优化（上）：常见的数据存储方法有哪些？" class=md-nav__link> 12 | 存储优化（上）：常见的数据存储方法有哪些？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/storage_2/ title="13 | 存储优化（中）：如何优化数据存储？" class=md-nav__link> 13 | 存储优化（中）：如何优化数据存储？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/storage_3/ title="14 | 存储优化（下）：数据库SQLite的使用和优化" class=md-nav__link> 14 | 存储优化（下）：数据库SQLite的使用和优化 </a> </li> <li class=md-nav__item> <a href=../../paid/master/network_1/ title="15 | 网络优化（上）：移动开发工程师必备的网络优化知识" class=md-nav__link> 15 | 网络优化（上）：移动开发工程师必备的网络优化知识 </a> </li> <li class=md-nav__item> <a href=../../paid/master/network_2/ title="16 | 网络优化（中）：复杂多变的移动网络该如何优化？" class=md-nav__link> 16 | 网络优化（中）：复杂多变的移动网络该如何优化？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/network_3/ title="17 | 网络优化（下）：大数据下网络该如何监控？" class=md-nav__link> 17 | 网络优化（下）：大数据下网络该如何监控？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/battery_1/ title="18 | 耗电优化（上）：从电量优化的演进看耗电分析" class=md-nav__link> 18 | 耗电优化（上）：从电量优化的演进看耗电分析 </a> </li> <li class=md-nav__item> <a href=../../paid/master/battery_2/ title="19 | 耗电优化（下）：耗电的优化方法与线上监控" class=md-nav__link> 19 | 耗电优化（下）：耗电的优化方法与线上监控 </a> </li> <li class=md-nav__item> <a href=../../paid/master/ui_1/ title="20 | UI 优化（上）：UI 渲染的几个关键概念" class=md-nav__link> 20 | UI 优化（上）：UI 渲染的几个关键概念 </a> </li> <li class=md-nav__item> <a href=../../paid/master/ui_2/ title="21 | UI 优化（下）：如何优化 UI 渲染？" class=md-nav__link> 21 | UI 优化（下）：如何优化 UI 渲染？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/package_1/ title="22 | 包体积优化（上）：如何减少安装包大小？" class=md-nav__link> 22 | 包体积优化（上）：如何减少安装包大小？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/package_2/ title="23 | 包体积优化（下）：资源优化的进阶实践" class=md-nav__link> 23 | 包体积优化（下）：资源优化的进阶实践 </a> </li> <li class=md-nav__item> <a href=../../paid/master/compile/ title="26 | 关于编译，你需要了解什么？" class=md-nav__link> 26 | 关于编译，你需要了解什么？ </a> </li> <li class=md-nav__item> <a href=../../paid/master/bytecode/ title="27 | 编译插桩的三种方法：AspectJ、ASM、ReDex" class=md-nav__link> 27 | 编译插桩的三种方法：AspectJ、ASM、ReDex </a> </li> <li class=md-nav__item> <a href=../../paid/master/native_hook/ title="35 | Native Hook 技术，天使还是魔鬼？" class=md-nav__link> 35 | Native Hook 技术，天使还是魔鬼？ </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-3 type=checkbox id=nav-2-3> <label class=md-nav__link for=nav-2-3> Framework系列 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-3> Framework系列 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../framework/Android四大组件(1)/ title=Activity class=md-nav__link> Activity </a> </li> <li class=md-nav__item> <a href=../../framework/Android四大组件(2)/ title=Service class=md-nav__link> Service </a> </li> <li class=md-nav__item> <a href=../../framework/Android四大组件(3)/ title=Broadcasts class=md-nav__link> Broadcasts </a> </li> <li class=md-nav__item> <a href=../../framework/Android四大组件(4)/ title="Content Providers与Fragment" class=md-nav__link> Content Providers与Fragment </a> </li> <li class=md-nav__item> <a href=../../framework/IPC机制/ title=IPC机制 class=md-nav__link> IPC机制 </a> </li> <li class=md-nav__item> <a href=../../framework/View的事件体系/ title=View的事件体系 class=md-nav__link> View的事件体系 </a> </li> <li class=md-nav__item> <a href=../../framework/View的绘制原理/ title=View的绘制原理 class=md-nav__link> View的绘制原理 </a> </li> <li class=md-nav__item> <a href=../../framework/RemoteViews/ title=RemoteViews class=md-nav__link> RemoteViews </a> </li> <li class=md-nav__item> <a href=../../framework/Drawable/ title=Android中的Drawable资源 class=md-nav__link> Android中的Drawable资源 </a> </li> <li class=md-nav__item> <a href=../../framework/Android动画/ title=Android动画 class=md-nav__link> Android动画 </a> </li> <li class=md-nav__item> <a href=../../framework/Window与WindowManager/ title=Window与WindowManager class=md-nav__link> Window与WindowManager </a> </li> <li class=md-nav__item> <a href=../../framework/四大组件启动过程/ title=四大组件启动过程 class=md-nav__link> 四大组件启动过程 </a> </li> <li class=md-nav__item> <a href=../../framework/Android消息机制/ title=Android消息机制 class=md-nav__link> Android消息机制 </a> </li> <li class=md-nav__item> <a href=../../framework/Android线程与线程池/ title=Android线程与线程池 class=md-nav__link> Android线程与线程池 </a> </li> <li class=md-nav__item> <a href=../../framework/Bitmap的缓存与加载/ title=Bitmap的缓存与加载 class=md-nav__link> Bitmap的缓存与加载 </a> </li> <li class=md-nav__item> <a href=../../framework/JNI与NDK/ title=JNI与NDK编程简介 class=md-nav__link> JNI与NDK编程简介 </a> </li> <li class=md-nav__item> <a href=../../framework/性能优化/ title=Android性能优化 class=md-nav__link> Android性能优化 </a> </li> <li class=md-nav__item> <a href=../../framework/binder1-mediaservice/ title=Binder深入理解——以MediaService为例 class=md-nav__link> Binder深入理解——以MediaService为例 </a> </li> <li class=md-nav__item> <a href=../../framework/binder2/ title=Binder深入理解——罗老师系列 class=md-nav__link> Binder深入理解——罗老师系列 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-4 type=checkbox id=nav-2-4> <label class=md-nav__link for=nav-2-4> 付费知识归档 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-4> 付费知识归档 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-4-1 type=checkbox id=nav-2-4-1> <label class=md-nav__link for=nav-2-4-1> 某圈问题索引 </label> <nav class=md-nav data-md-component=collapsible data-md-level=3> <label class=md-nav__title for=nav-2-4-1> 某圈问题索引 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../paid/zsxq/zsxq_index/ title=某圈问题索引 class=md-nav__link> 某圈问题索引 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week1-synchronized/ title=理解Java中synchronized关键词 class=md-nav__link> 理解Java中synchronized关键词 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week2-service/ title=理解Service class=md-nav__link> 理解Service </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week3-activity/ title=理解Activity的启动模式 class=md-nav__link> 理解Activity的启动模式 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week4-startActivityForResult/ title=关于startActivityForResult class=md-nav__link> 关于startActivityForResult </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week5-view/ title=关于View的知识 class=md-nav__link> 关于View的知识 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week6-gradle/ title=关于Gradle的知识 class=md-nav__link> 关于Gradle的知识 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week7-serialization/ title=关于序列化的知识 class=md-nav__link> 关于序列化的知识 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week10-classloader/ title=Android中的ClassLoader class=md-nav__link> Android中的ClassLoader </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week11-binder/ title=Binder简介 class=md-nav__link> Binder简介 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week12-retrofit-okhttp/ title=OkHttp和Retrofit的作用以及两者之间的联系 class=md-nav__link> OkHttp和Retrofit的作用以及两者之间的联系 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week14-jvm-gc/ title=JVM中垃圾回收策略 class=md-nav__link> JVM中垃圾回收策略 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week16-keep-app-alive/ title=进程保活 class=md-nav__link> 进程保活 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week17-android-components/ title=四大组件的作用以及多进程 class=md-nav__link> 四大组件的作用以及多进程 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week20-network-protocol/ title=网络协议 class=md-nav__link> 网络协议 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week21-mvc&amp;mvp&mvvm/ title=MVC、MVP和MVVM class=md-nav__link> MVC、MVP和MVVM </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week22-android-studio-build/ title="Android Studio build过程" class=md-nav__link> Android Studio build过程 </a> </li> <li class=md-nav__item> <a href=../../paid/zsxq/week23-load-large-bitmap/ title=大尺寸图片加载问题 class=md-nav__link> 大尺寸图片加载问题 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-2-5 type=checkbox id=nav-2-5 checked> <label class=md-nav__link for=nav-2-5> 日常记录 </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-2-5> 日常记录 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../annotation/ title=注解的定义及解析 class=md-nav__link> 注解的定义及解析 </a> </li> <li class=md-nav__item> <a href=../best_throttle_in_mvvm/ title=这可能是MVVM中最优雅的按键防抖方案 class=md-nav__link> 这可能是MVVM中最优雅的按键防抖方案 </a> </li> <li class=md-nav__item> <a href=../android-jenkins/ title="Jenkins for android" class=md-nav__link> Jenkins for android </a> </li> <li class=md-nav__item> <a href=../SystemProrities/ title=普通Android程序使用SystemProrities class=md-nav__link> 普通Android程序使用SystemProrities </a> </li> <li class=md-nav__item> <a href=../recyclerview-cache/ title=ListView、RecyclerView缓存策略解析 class=md-nav__link> ListView、RecyclerView缓存策略解析 </a> </li> <li class=md-nav__item> <a href=../recyclerview-item-docoration/ title=RecyclerView高级特性——ItemDecoration class=md-nav__link> RecyclerView高级特性——ItemDecoration </a> </li> <li class=md-nav__item> <a href=../recyclerview-others/ title=RecyclerView的一些使用细节 class=md-nav__link> RecyclerView的一些使用细节 </a> </li> <li class=md-nav__item> <a href=../RecyclerView-Sort&Delete/ title=RecyclerView高级特性——拖拽排序以及滑动删除 class=md-nav__link> RecyclerView高级特性——拖拽排序以及滑动删除 </a> </li> <li class=md-nav__item> <a href=../FAB-Behavior/ title=FloatingActionButton上滑隐藏下滑显示 class=md-nav__link> FloatingActionButton上滑隐藏下滑显示 </a> </li> <li class=md-nav__item> <a href=../nestedscrolling/ title=NestedScrolling机制 class=md-nav__link> NestedScrolling机制 </a> </li> <li class=md-nav__item> <a href=../porterduff/ title=使用Porter-Duff合成数字图像 class=md-nav__link> 使用Porter-Duff合成数字图像 </a> </li> <li class=md-nav__item> <a href=../runtime/ title="Android Runtime" class=md-nav__link> Android Runtime </a> </li> <li class=md-nav__item> <a href=../android_alias/ title=Android马甲包的那些事儿 class=md-nav__link> Android马甲包的那些事儿 </a> </li> <li class=md-nav__item> <a href=../Android-Development-Tool/ title=Android神兵利器 class=md-nav__link> Android神兵利器 </a> </li> <li class=md-nav__item> <a href=../FileProvider/ title=FileProvider class=md-nav__link> FileProvider </a> </li> <li class=md-nav__item> <a href=../Android判断导航栏高度/ title=Android判断虚拟按键(导航栏)显示与否、高度以及获取屏幕实际高度 class=md-nav__link> Android判断虚拟按键(导航栏)显示与否、高度以及获取屏幕实际高度 </a> </li> <li class=md-nav__item> <a href=../Android图片选择器/ title=Android图片选择器 class=md-nav__link> Android图片选择器 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-toggle md-nav__toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Android原生底部导航栏 </label> <a href=./ title=Android原生底部导航栏 class="md-nav__link md-nav__link--active"> Android原生底部导航栏 </a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>目录</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#1-bottomnavigationview class=md-nav__link> 1 BottomNavigationView实现底部导航栏 </a> </li> <li class=md-nav__item> <a href=#2-bottomnavigationview class=md-nav__link> 2 BottomNavigationView的细节调整 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-shiftingmode class=md-nav__link> 2.1 禁用ShiftingMode模式 </a> </li> <li class=md-nav__item> <a href=#22-bottomnavigationview class=md-nav__link> 2.2 BottomNavigationView源码解析 </a> </li> <li class=md-nav__item> <a href=#23 class=md-nav__link> 2.3 禁用选中项文字变大 </a> </li> <li class=md-nav__item> <a href=#24-menuicon class=md-nav__link> 2.4 控制Menu选中、未选中状态ICON、文字颜色 </a> </li> <li class=md-nav__item> <a href=#25-tint-icon class=md-nav__link> 2.5 禁止tint icon </a> </li> <li class=md-nav__item> <a href=#26-ripple class=md-nav__link> 2.6 禁止点击ripple </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-materialbnv class=md-nav__link> 3. Material库中的BNV </a> </li> <li class=md-nav__item> <a href=#__comments class="md-nav__link md-nav__link--active"> 评论 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../Android搜索栏的实现/ title=Android搜索栏的实现 class=md-nav__link> Android搜索栏的实现 </a> </li> <li class=md-nav__item> <a href=../Android暂停音乐播放器的播放/ title=Android暂停酷狗、网易云音乐等音乐播放器的播放 class=md-nav__link> Android暂停酷狗、网易云音乐等音乐播放器的播放 </a> </li> <li class=md-nav__item> <a href=../Android滑动返回实践/ title=Android滑动返回实践 class=md-nav__link> Android滑动返回实践 </a> </li> <li class=md-nav__item> <a href=../Android程序反编译/ title=MacOS下Android程序反编译 class=md-nav__link> MacOS下Android程序反编译 </a> </li> <li class=md-nav__item> <a href=../Android通讯录快速读取/ title=Android通讯录快速读取 class=md-nav__link> Android通讯录快速读取 </a> </li> <li class=md-nav__item> <a href=../soft-keyboard-in-app/ title=App内自定义软键盘 class=md-nav__link> App内自定义软键盘 </a> </li> <li class=md-nav__item> <a href=../腾讯X5内核入坑指南/ title="腾讯TBS X5浏览器内核入坑指南" class=md-nav__link> 腾讯TBS X5浏览器内核入坑指南 </a> </li> <li class=md-nav__item> <a href=../琐碎知识点/ title=琐碎知识点 class=md-nav__link> 琐碎知识点 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> Flutter </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-3> Flutter </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../flutter/flutter_first_project_1/ title=年轻人的第一个Flutter程序(1) class=md-nav__link> 年轻人的第一个Flutter程序(1) </a> </li> <li class=md-nav__item> <a href=../../../flutter/flutter_first_project_2/ title=年轻人的第一个Flutter程序(2) class=md-nav__link> 年轻人的第一个Flutter程序(2) </a> </li> <li class=md-nav__item> <a href=../../../flutter/flutter_first_project_3/ title=年轻人的第一个Flutter程序(3) class=md-nav__link> 年轻人的第一个Flutter程序(3) </a> </li> <li class=md-nav__item> <a href=../../../flutter/flutter_first_project_4/ title=年轻人的第一个Flutter程序(4) class=md-nav__link> 年轻人的第一个Flutter程序(4) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> LeetCode </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-4> LeetCode </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../leetcode/ title=算法目录 class=md-nav__link> 算法目录 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/code_interviews_1/ title=数据结构、算法和数据操作 class=md-nav__link> 数据结构、算法和数据操作 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/code_interviews_3/ title=高质量的代码 class=md-nav__link> 高质量的代码 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/code_interviews_4/ title=解决问题的思路 class=md-nav__link> 解决问题的思路 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/code_interviews_5/ title=优化时间和空间效率 class=md-nav__link> 优化时间和空间效率 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/code_interviews_6/ title=面试中的各项能力 class=md-nav__link> 面试中的各项能力 </a> </li> <li class=md-nav__item> <a href=../../../leetcode/array/ title=Array class=md-nav__link> Array </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode1-10/ title=LeetCode(1-10) class=md-nav__link> LeetCode(1-10) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode11-20/ title=LeetCode(11-20) class=md-nav__link> LeetCode(11-20) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode21-30/ title=LeetCode(21-30) class=md-nav__link> LeetCode(21-30) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode31-40/ title=LeetCode(31-40) class=md-nav__link> LeetCode(31-40) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode41-50/ title=LeetCode(41-50) class=md-nav__link> LeetCode(41-50) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode51-60/ title=LeetCode(51-60) class=md-nav__link> LeetCode(51-60) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode61-70/ title=LeetCode(61-70) class=md-nav__link> LeetCode(61-70) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode71-80/ title=LeetCode(71-80) class=md-nav__link> LeetCode(71-80) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode81-90/ title=LeetCode(81-90) class=md-nav__link> LeetCode(81-90) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode91-100/ title=LeetCode(91-100) class=md-nav__link> LeetCode(91-100) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode101-110/ title=LeetCode(101-110) class=md-nav__link> LeetCode(101-110) </a> </li> <li class=md-nav__item> <a href=../../../leetcode/leetcode111-120/ title=LeetCode(111-120) class=md-nav__link> LeetCode(111-120) </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> Books </label> <nav class=md-nav data-md-component=collapsible data-md-level=1> <label class=md-nav__title for=nav-5> Books </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-1 type=checkbox id=nav-5-1> <label class=md-nav__link for=nav-5-1> Design Pattern </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-1> Design Pattern </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../design-pattern/design-pattern/ title=设计模式概述 class=md-nav__link> 设计模式概述 </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/design-principle/ title=面向对象的六大原则 class=md-nav__link> 面向对象的六大原则 </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/singleton/ title=单例模式(Singleton) class=md-nav__link> 单例模式(Singleton) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/builder/ title=建造者模式(Builder) class=md-nav__link> 建造者模式(Builder) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/prototype/ title=原型模式(Prototype) class=md-nav__link> 原型模式(Prototype) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/factory-method/ title="工厂方法模式(Factory method)" class=md-nav__link> 工厂方法模式(Factory method) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/abstract-factory/ title="抽象工厂模式(Abstract factory)" class=md-nav__link> 抽象工厂模式(Abstract factory) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/proxy/ title=代理模式(Proxy) class=md-nav__link> 代理模式(Proxy) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/composite/ title=组合模式(Composite) class=md-nav__link> 组合模式(Composite) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/adapter/ title=适配器模式(Adapter) class=md-nav__link> 适配器模式(Adapter) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/decorator/ title=装饰模式(Decorator) class=md-nav__link> 装饰模式(Decorator) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/flyweight/ title=享元模式(Flyweight) class=md-nav__link> 享元模式(Flyweight) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/facade/ title=外观模式(Facade) class=md-nav__link> 外观模式(Facade) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/bridge/ title=桥接模式(Bridge) class=md-nav__link> 桥接模式(Bridge) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/strategy/ title=策略模式(Strategy) class=md-nav__link> 策略模式(Strategy) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/state/ title=状态模式(State) class=md-nav__link> 状态模式(State) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/chain-of-responsibility/ title="责任链模式(Chain of responsibility)" class=md-nav__link> 责任链模式(Chain of responsibility) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/interpreter/ title=解释器模式(Interpreter) class=md-nav__link> 解释器模式(Interpreter) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/command/ title=命令模式(Command) class=md-nav__link> 命令模式(Command) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/observer/ title=观察者模式(Observer) class=md-nav__link> 观察者模式(Observer) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/memento/ title=备忘录模式(Memento) class=md-nav__link> 备忘录模式(Memento) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/iterator/ title=迭代器模式(Iterator) class=md-nav__link> 迭代器模式(Iterator) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/template-method/ title="模版方法模式(Template method)" class=md-nav__link> 模版方法模式(Template method) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/visitor/ title=访问者模式(Visitor) class=md-nav__link> 访问者模式(Visitor) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/mediator/ title=中介者模式(Mediator) class=md-nav__link> 中介者模式(Mediator) </a> </li> <li class=md-nav__item> <a href=../../../design-pattern/confusing-design-pattern/ title=易混淆的设计模式 class=md-nav__link> 易混淆的设计模式 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-2 type=checkbox id=nav-5-2> <label class=md-nav__link for=nav-5-2> Effective Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-2> Effective Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../effective-java/effective-java/ title="Effective Java概述" class=md-nav__link> Effective Java概述 </a> </li> <li class=md-nav__item> <a href=../../../effective-java/chapter1/ title=创建和销毁对象 class=md-nav__link> 创建和销毁对象 </a> </li> <li class=md-nav__item> <a href=../../../effective-java/chapter2/ title=对于所有对象都通用的方法 class=md-nav__link> 对于所有对象都通用的方法 </a> </li> <li class=md-nav__item> <a href=../../../effective-java/chapter3/ title=类和接口 class=md-nav__link> 类和接口 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-3 type=checkbox id=nav-5-3> <label class=md-nav__link for=nav-5-3> JVM </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-3> JVM </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../jvm/jvm-content/ title=深入理解Java虚拟机 class=md-nav__link> 深入理解Java虚拟机 </a> </li> <li class=md-nav__item> <a href=../../../jvm/java-memory-area-oom/ title=Java内存区域与内存溢出异常 class=md-nav__link> Java内存区域与内存溢出异常 </a> </li> <li class=md-nav__item> <a href=../../../jvm/java-gc/ title=垃圾收集器与内存分配策略 class=md-nav__link> 垃圾收集器与内存分配策略 </a> </li> <li class=md-nav__item> <a href=../../../jvm/class-struct/ title=类文件结构 class=md-nav__link> 类文件结构 </a> </li> <li class=md-nav__item> <a href=../../../jvm/load-class/ title=虚拟机类加载机制 class=md-nav__link> 虚拟机类加载机制 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-4 type=checkbox id=nav-5-4> <label class=md-nav__link for=nav-5-4> Java </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-4> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../java/generics-java-kotlin/ title=Java&Kotlin在泛型方面的区别 class=md-nav__link> Java&Kotlin在泛型方面的区别 </a> </li> <li class=md-nav__item> <a href=../../../java/java-collections/ title=Java集合总结 class=md-nav__link> Java集合总结 </a> </li> <li class=md-nav__item> <a href=../../../java/java-foundation/ title=Java常见概念 class=md-nav__link> Java常见概念 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-toggle md-nav__toggle" data-md-toggle=nav-5-5 type=checkbox id=nav-5-5> <label class=md-nav__link for=nav-5-5> Refactoring </label> <nav class=md-nav data-md-component=collapsible data-md-level=2> <label class=md-nav__title for=nav-5-5> Refactoring </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../refactoring/refactoring/ title=重构：改善既有代码的设计 class=md-nav__link> 重构：改善既有代码的设计 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title for=__toc>目录</label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#1-bottomnavigationview class=md-nav__link> 1 BottomNavigationView实现底部导航栏 </a> </li> <li class=md-nav__item> <a href=#2-bottomnavigationview class=md-nav__link> 2 BottomNavigationView的细节调整 </a> <nav class=md-nav> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-shiftingmode class=md-nav__link> 2.1 禁用ShiftingMode模式 </a> </li> <li class=md-nav__item> <a href=#22-bottomnavigationview class=md-nav__link> 2.2 BottomNavigationView源码解析 </a> </li> <li class=md-nav__item> <a href=#23 class=md-nav__link> 2.3 禁用选中项文字变大 </a> </li> <li class=md-nav__item> <a href=#24-menuicon class=md-nav__link> 2.4 控制Menu选中、未选中状态ICON、文字颜色 </a> </li> <li class=md-nav__item> <a href=#25-tint-icon class=md-nav__link> 2.5 禁止tint icon </a> </li> <li class=md-nav__item> <a href=#26-ripple class=md-nav__link> 2.6 禁止点击ripple </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#3-materialbnv class=md-nav__link> 3. Material库中的BNV </a> </li> <li class=md-nav__item> <a href=#__comments class="md-nav__link md-nav__link--active"> 评论 </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1>Android原生底部导航栏</h1> <p>BottomNavigationView+ViewPager+Fragment可以用来实现常见的底部导航的UI架构。本章的主要内容就是讲解这个UI样式的详细实现过程。</p> <p>此外BottomNavigationView使用起来还是有一些值得摸索的小细节，本章也会在下部分内容结合BottomNavigationView的源码进行解释，这些细节包括：</p> <ul> <li>Menu数据超过3个会启用ShiftingMode，如何禁用这种讨厌的效果？</li> <li>点击Menu进行切换时，选中的Menu的文字会变大，如何禁用这种UI设计师觉得不OK的效果（我觉得很OK啊）？</li> <li>控制Menu选中、未选中状态ICON、文字颜色</li> <li>阴影问题（全文搜索“阴影”）</li> </ul> <p>话不多说，先上最终效果图。<br> <img alt=BottomNavigationView实现底部导航栏 src=/assets/images/android/BottomNavigationView实现底部导航栏.png></p> <h2 id=1-bottomnavigationview>1 BottomNavigationView实现底部导航栏<a class=headerlink href=#1-bottomnavigationview title="Permanent link">&para;</a></h2> <p>首先简单说说这种效果的编写流程。 </p> <p>I. 在<code>build.gradle</code>中引入 <strong>最新</strong> 的<code>design</code>以及<code>appcompat</code>库 <div class=codehilite><pre><span></span><span class=n>dependencies</span> <span class=p>{</span>
    <span class=n>compile</span> <span class=err>&#39;</span><span class=n>com</span><span class=p>.</span><span class=na>android</span><span class=p>.</span><span class=na>support</span><span class=p>:</span><span class=n>appcompat</span><span class=o>-</span><span class=n>v7</span><span class=p>:</span><span class=mf>25.0.1</span><span class=err>&#39;</span>
    <span class=n>compile</span> <span class=err>&#39;</span><span class=n>com</span><span class=p>.</span><span class=na>android</span><span class=p>.</span><span class=na>support</span><span class=p>:</span><span class=n>design</span><span class=p>:</span><span class=mf>25.1.1</span><span class=err>&#39;</span>
<span class=p>}</span>
</pre></div></p> <p>II. 保证Activity继承至<code>android.support.v7.app.AppCompatActivity</code> <div class=codehilite><pre><span></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BottomNavigationViewActivity</span> <span class=kd>extends</span> <span class=n>AppCompatActivity</span>
</pre></div></p> <p>III. 在<code>menu</code>文件中定义导航Menu <div class=codehilite><pre><span></span><span class=nt>&lt;menu</span> <span class=na>xmlns:android=</span><span class=s>&quot;http://schemas.android.com/apk/res/android&quot;</span><span class=nt>&gt;</span>
    <span class=nt>&lt;item</span> <span class=na>android:id=</span><span class=s>&quot;@+id/action_credit_accelerate&quot;</span>
          <span class=na>android:title=</span><span class=s>&quot;信用加速&quot;</span>
          <span class=na>android:icon=</span><span class=s>&quot;@drawable/btn_video_mode&quot;</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;item</span> <span class=na>android:id=</span><span class=s>&quot;@+id/action_repay_calendar&quot;</span>
          <span class=na>android:title=</span><span class=s>&quot;还款日历&quot;</span>
          <span class=na>android:icon=</span><span class=s>&quot;@drawable/btn_video_mode&quot;</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;item</span> <span class=na>android:id=</span><span class=s>&quot;@+id/action_mine&quot;</span>
          <span class=na>android:title=</span><span class=s>&quot;我的&quot;</span>
          <span class=na>android:icon=</span><span class=s>&quot;@drawable/btn_video_mode&quot;</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;item</span> <span class=na>android:id=</span><span class=s>&quot;@+id/action_test&quot;</span>
          <span class=na>android:title=</span><span class=s>&quot;测试&quot;</span>
          <span class=na>android:icon=</span><span class=s>&quot;@drawable/btn_video_mode&quot;</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/menu&gt;</span>
</pre></div></p> <p>IV. 写Activity的布局文件 <div class=codehilite><pre><span></span><span class=cp>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class=nt>&lt;RelativeLayout</span> <span class=na>xmlns:android=</span><span class=s>&quot;http://schemas.android.com/apk/res/android&quot;</span>
                <span class=na>xmlns:app=</span><span class=s>&quot;http://schemas.android.com/apk/res-auto&quot;</span>
                <span class=na>android:layout_width=</span><span class=s>&quot;match_parent&quot;</span>
                <span class=na>android:layout_height=</span><span class=s>&quot;match_parent&quot;</span><span class=nt>&gt;</span>

    <span class=nt>&lt;android.support.design.widget.BottomNavigationView</span>
        <span class=na>android:id=</span><span class=s>&quot;@+id/bottom_navigation&quot;</span>
        <span class=na>android:layout_width=</span><span class=s>&quot;match_parent&quot;</span>
        <span class=na>android:layout_height=</span><span class=s>&quot;wrap_content&quot;</span>
        <span class=na>android:layout_alignParentBottom=</span><span class=s>&quot;true&quot;</span>
        <span class=na>android:background=</span><span class=s>&quot;@color/white&quot;</span>
        <span class=na>app:menu=</span><span class=s>&quot;@menu/menu_bottom_navigation&quot;</span><span class=nt>/&gt;</span>

    <span class=nt>&lt;android.support.v4.view.ViewPager</span>
        <span class=na>android:id=</span><span class=s>&quot;@+id/viewpager&quot;</span>
        <span class=na>android:layout_width=</span><span class=s>&quot;match_parent&quot;</span>
        <span class=na>android:layout_height=</span><span class=s>&quot;match_parent&quot;</span>
        <span class=na>android:layout_above=</span><span class=s>&quot;@id/bottom_navigation&quot;</span><span class=nt>/&gt;</span>

    <span class=nt>&lt;View</span>
        <span class=na>android:id=</span><span class=s>&quot;@+id/view_shadow&quot;</span>
        <span class=na>android:layout_width=</span><span class=s>&quot;match_parent&quot;</span>
        <span class=na>android:layout_height=</span><span class=s>&quot;4dp&quot;</span>
        <span class=na>android:alpha=</span><span class=s>&quot;0.6&quot;</span>
        <span class=na>android:layout_above=</span><span class=s>&quot;@id/bottom_navigation&quot;</span>
        <span class=na>android:background=</span><span class=s>&quot;@drawable/shadow_bottom_navigation&quot;</span><span class=nt>/&gt;</span>

<span class=nt>&lt;/RelativeLayout&gt;</span>
</pre></div> 这个布局比较简单，也很清晰。最底部是BottomNavigationView，用来导航。最上面是一个ViewPager，里面用来填充若干个Fragment。<code>view_shadow</code>是BottomNavigationView上面的一个阴影效果，设置alpha是为了让ViewPager里面的内容不会被阴影完全遮挡，阴影效果的drawable文件如下： <div class=codehilite><pre><span></span><span class=cp>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class=nt>&lt;shape</span> <span class=na>xmlns:android=</span><span class=s>&quot;http://schemas.android.com/apk/res/android&quot;</span>
    <span class=na>android:shape=</span><span class=s>&quot;rectangle&quot;</span><span class=nt>&gt;</span>
    <span class=nt>&lt;gradient</span>
        <span class=na>android:startColor=</span><span class=s>&quot;#00ffffff&quot;</span>
        <span class=na>android:endColor=</span><span class=s>&quot;#D1D1D1&quot;</span>
        <span class=na>android:angle=</span><span class=s>&quot;270&quot;</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/shape&gt;</span>
</pre></div> 也可以使用<code>BottomNavigationView</code>的<code>app:elevation="8dp"</code>属性为其加上阴影，但是个人觉得效果不理想。若使用这种方式， <strong>还要注意为其加上<code>android:background</code>属性，不然阴影不会出现。</strong> 另外elevation没效果的bug已经修复了，将<code>design</code>库更新到<code>25.0.1</code>可以解决这个问题<a href=https://issuetracker.google.com/issues/37124558>This has been released in support library 25.0.1</a>。</p> <p>下面上一张对比图，左边是系统自带的，右边是通过View实现的。 <img alt=左边为elevation实现、右边为View实现 src=/assets/images/android/bottomnavigationbar-shadow.png></p> <p>V. 写Activity的代码 <div class=codehilite><pre><span></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BottomNavigationViewActivity</span> <span class=kd>extends</span> <span class=n>ActivityBase</span>
    <span class=kd>implements</span> <span class=n>BottomNavigationView</span><span class=p>.</span><span class=na>OnNavigationItemSelectedListener</span><span class=p>,</span>
    <span class=n>ViewPager</span><span class=p>.</span><span class=na>OnPageChangeListener</span><span class=p>{</span>

    <span class=n>BottomNavigationView</span> <span class=n>mBottomNavigation</span><span class=p>;</span>
    <span class=n>ViewPager</span> <span class=n>mViewPager</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>CreditAccelerateFragment</span> <span class=n>mCreditAccelerateFragment</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>RepayCalendarFragment</span> <span class=n>mRepayCalendarFragment</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>MineFragment</span> <span class=n>mMineFragment</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>TestFragment</span> <span class=n>mTestFragment</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>List</span><span class=o>&lt;</span><span class=n>BaseFragment</span><span class=o>&gt;</span> <span class=n>mFragmentList</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>PagerAdapter</span> <span class=n>mPagerAdapter</span><span class=p>;</span>

    <span class=kd>private</span> <span class=n>SparseIntArray</span> <span class=n>id2pos</span><span class=p>;</span>

    <span class=nd>@Override</span>
    <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span> <span class=n>savedInstanceState</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span>
        <span class=n>setContentView</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>layout</span><span class=p>.</span><span class=na>activity_bottom_navigation_view</span><span class=p>);</span>

        <span class=n>mBottomNavigation</span> <span class=o>=</span> <span class=p>(</span><span class=n>BottomNavigationView</span><span class=p>)</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>bottom_navigation</span><span class=p>);</span>
        <span class=n>mViewPager</span> <span class=o>=</span> <span class=p>(</span><span class=n>ViewPager</span><span class=p>)</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>viewpager</span><span class=p>);</span>

        <span class=n>initData</span><span class=p>();</span>
        <span class=n>initAdapter</span><span class=p>();</span>
        <span class=n>initEvent</span><span class=p>();</span>
    <span class=p>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>initData</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>mFragmentList</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;</span><span class=p>();</span>
        <span class=n>mCreditAccelerateFragment</span> <span class=o>=</span> <span class=n>CreditAccelerateFragment</span><span class=p>.</span><span class=na>newInstance</span><span class=p>(</span><span class=s>&quot;&quot;</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>);</span>
        <span class=n>mRepayCalendarFragment</span> <span class=o>=</span> <span class=n>RepayCalendarFragment</span><span class=p>.</span><span class=na>newInstance</span><span class=p>(</span><span class=s>&quot;&quot;</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>);</span>
        <span class=n>mMineFragment</span> <span class=o>=</span> <span class=n>MineFragment</span><span class=p>.</span><span class=na>newInstance</span><span class=p>(</span><span class=s>&quot;&quot;</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>);</span>
        <span class=n>mTestFragment</span> <span class=o>=</span> <span class=n>TestFragment</span><span class=p>.</span><span class=na>newInstance</span><span class=p>(</span><span class=s>&quot;&quot;</span><span class=p>,</span> <span class=s>&quot;&quot;</span><span class=p>);</span>
        <span class=n>mFragmentList</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>mCreditAccelerateFragment</span><span class=p>);</span>
        <span class=n>mFragmentList</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>mRepayCalendarFragment</span><span class=p>);</span>
        <span class=n>mFragmentList</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>mMineFragment</span><span class=p>);</span>
        <span class=n>mFragmentList</span><span class=p>.</span><span class=na>add</span><span class=p>(</span><span class=n>mTestFragment</span><span class=p>);</span>

        <span class=n>id2pos</span> <span class=o>=</span> <span class=k>new</span> <span class=n>SparseIntArray</span><span class=p>(</span><span class=n>mFragmentList</span><span class=p>.</span><span class=na>size</span><span class=p>());</span>
        <span class=n>id2pos</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>action_credit_accelerate</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>id2pos</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>action_repay_calendar</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
        <span class=n>id2pos</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>action_mine</span><span class=p>,</span> <span class=mi>2</span><span class=p>);</span>
        <span class=n>id2pos</span><span class=p>.</span><span class=na>put</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>action_test</span><span class=p>,</span> <span class=mi>3</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>initAdapter</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>mPagerAdapter</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HomePageFragmentAdapter</span><span class=p>(</span><span class=n>getSupportFragmentManager</span><span class=p>());</span>
        <span class=n>mViewPager</span><span class=p>.</span><span class=na>setAdapter</span><span class=p>(</span><span class=n>mPagerAdapter</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=kd>private</span> <span class=kt>void</span> <span class=nf>initEvent</span><span class=p>()</span> <span class=p>{</span>
        <span class=n>mBottomNavigation</span><span class=p>.</span><span class=na>setOnNavigationItemSelectedListener</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
        <span class=n>mViewPager</span><span class=p>.</span><span class=na>addOnPageChangeListener</span><span class=p>(</span><span class=k>this</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>onNavigationItemSelected</span><span class=p>(</span><span class=nd>@NonNull</span> <span class=n>MenuItem</span> <span class=n>item</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>mViewPager</span><span class=p>.</span><span class=na>setCurrentItem</span><span class=p>(</span><span class=n>id2pos</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>getItemId</span><span class=p>()));</span>
        <span class=k>return</span> <span class=kc>true</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onPageScrolled</span><span class=p>(</span><span class=kt>int</span> <span class=n>position</span><span class=p>,</span> <span class=kt>float</span> <span class=n>positionOffset</span><span class=p>,</span> <span class=kt>int</span> <span class=n>positionOffsetPixels</span><span class=p>)</span> <span class=p>{}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onPageSelected</span><span class=p>(</span><span class=kt>int</span> <span class=n>position</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>mBottomNavigation</span><span class=p>.</span><span class=na>getMenu</span><span class=p>().</span><span class=na>getItem</span><span class=p>(</span><span class=n>position</span><span class=p>).</span><span class=na>setChecked</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onPageScrollStateChanged</span><span class=p>(</span><span class=kt>int</span> <span class=n>state</span><span class=p>)</span> <span class=p>{}</span>

    <span class=kd>private</span> <span class=kd>class</span> <span class=nc>HomePageFragmentAdapter</span> <span class=kd>extends</span> <span class=n>FragmentPagerAdapter</span> <span class=p>{</span>
        <span class=kd>public</span> <span class=nf>HomePageFragmentAdapter</span><span class=p>(</span><span class=n>FragmentManager</span> <span class=n>fm</span><span class=p>)</span> <span class=p>{</span>
            <span class=kd>super</span><span class=p>(</span><span class=n>fm</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=nd>@Override</span>
        <span class=kd>public</span> <span class=n>Fragment</span> <span class=nf>getItem</span><span class=p>(</span><span class=kt>int</span> <span class=n>position</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=n>mFragmentList</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>position</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=nd>@Override</span>
        <span class=kd>public</span> <span class=kt>int</span> <span class=nf>getCount</span><span class=p>()</span> <span class=p>{</span>
            <span class=k>return</span> <span class=n>HOMEPAGE_FRAGMENT_COUNT</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div> 这段代码也比较简单。</p> <p><code>initData</code>中完成了4个Fragment的创建，并将其保存到数据中；另外，还将每个Menu的id以及其position保存起来，以免后面点击BottomNavigationView时需要switch case判断点击了哪个Menu，这只是个人喜欢的写法，仅供参考。</p> <p><code>initAdapter</code>中创建并设置了ViewPager的Adapter，ViewPager的Adapter有两个可以选择，一个是FragmentPagerAdapter，还有一个是FragmentStatePagerAdapter。</p> <p><code>initEvent</code>里面分别给ViewPager和BottomNavigationView绑定了一个Listener。这两个Listener就是ViewPager和BottomNavigationView联动的关键。<br> 首先看一下BottomNavigationView的OnNavigationItemSelectedListener，它就只有一个方法<code>onNavigationItemSelected</code>。在这个方法里面我们控制ViewPager切换到对应的Fragment。 然后在看一下ViewPager的OnPageChangeListener，这里我们只用到了<code>onPageSelected</code>方法。同样，这里控制BottomNavigationView选择对应的Menu。</p> <p>另外：由于ViewPager的特性，会导致有些fragment不断的销毁，重建。在需要的时候，我们可以重写<code>FragmentPagerAdapter</code>的<code>destroyItem方法</code>，将里面调用父类的方法删除，这样可以阻止Fragment的销毁。 <div class=codehilite><pre><span></span><span class=kd>private</span> <span class=kd>class</span> <span class=nc>HomePageFragmentAdapter</span> <span class=kd>extends</span> <span class=n>FragmentPagerAdapter</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=nf>HomePageFragmentAdapter</span><span class=p>(</span><span class=n>FragmentManager</span> <span class=n>fm</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>(</span><span class=n>fm</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>Fragment</span> <span class=nf>getItem</span><span class=p>(</span><span class=kt>int</span> <span class=n>position</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>mFragmentList</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=n>position</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>int</span> <span class=nf>getCount</span><span class=p>()</span> <span class=p>{</span>
        <span class=k>return</span> <span class=n>HOMEPAGE_FRAGMENT_COUNT</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>Object</span> <span class=nf>instantiateItem</span><span class=p>(</span><span class=n>ViewGroup</span> <span class=n>container</span><span class=p>,</span> <span class=kt>int</span> <span class=n>position</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>return</span> <span class=kd>super</span><span class=p>.</span><span class=na>instantiateItem</span><span class=p>(</span><span class=n>container</span><span class=p>,</span> <span class=n>position</span><span class=p>);</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>destroyItem</span><span class=p>(</span><span class=n>ViewGroup</span> <span class=n>container</span><span class=p>,</span> <span class=kt>int</span> <span class=n>position</span><span class=p>,</span> <span class=n>Object</span> <span class=n>object</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>//super.destroyItem(container, position, object);</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div></p> <p>VI. 下面最后看一下DEMO里面Fragment的写法，这些都是一样的，随便挑一个： <div class=codehilite><pre><span></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>RepayCalendarFragment</span> <span class=kd>extends</span> <span class=n>BaseFragment</span> <span class=p>{</span>
    <span class=c1>// TODO: Rename parameter arguments, choose names that match</span>
    <span class=c1>// the fragment initialization parameters, e.g. ARG_ITEM_NUMBER</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>ARG_PARAM1</span> <span class=o>=</span> <span class=s>&quot;param1&quot;</span><span class=p>;</span>
    <span class=kd>private</span> <span class=kd>static</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>ARG_PARAM2</span> <span class=o>=</span> <span class=s>&quot;param2&quot;</span><span class=p>;</span>

    <span class=c1>// TODO: Rename and change types of parameters</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>mParam1</span><span class=p>;</span>
    <span class=kd>private</span> <span class=n>String</span> <span class=n>mParam2</span><span class=p>;</span>


    <span class=kd>public</span> <span class=nf>RepayCalendarFragment</span><span class=p>()</span> <span class=p>{</span>
        <span class=c1>// Required empty public constructor</span>
    <span class=p>}</span>

    <span class=cm>/**</span>
<span class=cm>     * Use this factory method to create a new instance of</span>
<span class=cm>     * this fragment using the provided parameters.</span>
<span class=cm>     *</span>
<span class=cm>     * @param param1 Parameter 1.</span>
<span class=cm>     * @param param2 Parameter 2.</span>
<span class=cm>     * @return A new instance of fragment CreditAccelerateFragment.</span>
<span class=cm>     */</span>
    <span class=c1>// TODO: Rename and change types and number of parameters</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=n>RepayCalendarFragment</span> <span class=nf>newInstance</span><span class=p>(</span><span class=n>String</span> <span class=n>param1</span><span class=p>,</span> <span class=n>String</span> <span class=n>param2</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>RepayCalendarFragment</span> <span class=n>fragment</span> <span class=o>=</span> <span class=k>new</span> <span class=n>RepayCalendarFragment</span><span class=p>();</span>
        <span class=n>Bundle</span> <span class=n>args</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Bundle</span><span class=p>();</span>
        <span class=n>args</span><span class=p>.</span><span class=na>putString</span><span class=p>(</span><span class=n>ARG_PARAM1</span><span class=p>,</span> <span class=n>param1</span><span class=p>);</span>
        <span class=n>args</span><span class=p>.</span><span class=na>putString</span><span class=p>(</span><span class=n>ARG_PARAM2</span><span class=p>,</span> <span class=n>param2</span><span class=p>);</span>
        <span class=n>fragment</span><span class=p>.</span><span class=na>setArguments</span><span class=p>(</span><span class=n>args</span><span class=p>);</span>
        <span class=k>return</span> <span class=n>fragment</span><span class=p>;</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onCreate</span><span class=p>(</span><span class=n>Bundle</span> <span class=n>savedInstanceState</span><span class=p>)</span> <span class=p>{</span>
        <span class=kd>super</span><span class=p>.</span><span class=na>onCreate</span><span class=p>(</span><span class=n>savedInstanceState</span><span class=p>);</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>getArguments</span><span class=p>()</span> <span class=o>!=</span> <span class=kc>null</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>mParam1</span> <span class=o>=</span> <span class=n>getArguments</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>ARG_PARAM1</span><span class=p>);</span>
            <span class=n>mParam2</span> <span class=o>=</span> <span class=n>getArguments</span><span class=p>().</span><span class=na>getString</span><span class=p>(</span><span class=n>ARG_PARAM2</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=nd>@Override</span>
    <span class=kd>public</span> <span class=n>View</span> <span class=nf>onCreateView</span><span class=p>(</span><span class=n>LayoutInflater</span> <span class=n>inflater</span><span class=p>,</span> <span class=n>ViewGroup</span> <span class=n>container</span><span class=p>,</span>
                             <span class=n>Bundle</span> <span class=n>savedInstanceState</span><span class=p>)</span> <span class=p>{</span>
        <span class=c1>// Inflate the layout for this fragment</span>
        <span class=k>return</span> <span class=n>inflater</span><span class=p>.</span><span class=na>inflate</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>layout</span><span class=p>.</span><span class=na>fragment_repay_calendar</span><span class=p>,</span> <span class=n>container</span><span class=p>,</span> <span class=kc>false</span><span class=p>);</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div> 上面的代码就是Android Studio自动生成的，具体页面的逻辑就要写在这里了。但是由于我们这只是一个DEMO，所以什么也没写。fragment_repay_calendar布局文件只是一个TextView而已。</p> <blockquote> <p>到此，第一节就已经结束了。这个控件还是挺方便的。但是，还是有一些坑啊，比如最开始提到的三个细节。下面这一节来讲解如何达到这些效果。</p> </blockquote> <h2 id=2-bottomnavigationview>2 BottomNavigationView的细节调整<a class=headerlink href=#2-bottomnavigationview title="Permanent link">&para;</a></h2> <h3 id=21-shiftingmode>2.1 禁用ShiftingMode模式<a class=headerlink href=#21-shiftingmode title="Permanent link">&para;</a></h3> <p>如果你的Menu超过三个，那么需要此步骤。否则，不需要。因为控件内部会根据<code>mShiftingMode = mMenu.size() &gt; 3;</code>决定启不启用mShiftingMode。</p> <p>我们先看禁用ShiftingMode前后对比图： <img alt=禁用ShiftingMode前后对比图.png src=/assets/images/android/禁用ShiftingMode前后对比图.png></p> <p>禁用代码： <div class=codehilite><pre><span></span><span class=kd>public</span> <span class=kd>class</span> <span class=nc>BottomNavigationViewHelper</span> <span class=p>{</span>
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>disableShiftMode</span><span class=p>(</span><span class=n>BottomNavigationView</span> <span class=n>view</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>BottomNavigationMenuView</span> <span class=n>menuView</span> <span class=o>=</span> <span class=p>(</span><span class=n>BottomNavigationMenuView</span><span class=p>)</span> <span class=n>view</span><span class=p>.</span><span class=na>getChildAt</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
        <span class=k>try</span> <span class=p>{</span>
            <span class=n>Field</span> <span class=n>shiftingMode</span> <span class=o>=</span> <span class=n>menuView</span><span class=p>.</span><span class=na>getClass</span><span class=p>().</span><span class=na>getDeclaredField</span><span class=p>(</span><span class=s>&quot;mShiftingMode&quot;</span><span class=p>);</span>
            <span class=n>shiftingMode</span><span class=p>.</span><span class=na>setAccessible</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
            <span class=n>shiftingMode</span><span class=p>.</span><span class=na>setBoolean</span><span class=p>(</span><span class=n>menuView</span><span class=p>,</span> <span class=kc>false</span><span class=p>);</span>
            <span class=n>shiftingMode</span><span class=p>.</span><span class=na>setAccessible</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>menuView</span><span class=p>.</span><span class=na>getChildCount</span><span class=p>();</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
                <span class=n>BottomNavigationItemView</span> <span class=n>item</span> <span class=o>=</span> <span class=p>(</span><span class=n>BottomNavigationItemView</span><span class=p>)</span> <span class=n>menuView</span><span class=p>.</span><span class=na>getChildAt</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
                <span class=c1>//noinspection RestrictedApi</span>
                <span class=n>item</span><span class=p>.</span><span class=na>setShiftingMode</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
                <span class=c1>// set once again checked value, so view will be updated</span>
                <span class=c1>//noinspection RestrictedApi</span>
                <span class=n>item</span><span class=p>.</span><span class=na>setChecked</span><span class=p>(</span><span class=n>item</span><span class=p>.</span><span class=na>getItemData</span><span class=p>().</span><span class=na>isChecked</span><span class=p>());</span>
            <span class=p>}</span>
        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=n>NoSuchFieldException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>Log</span><span class=p>.</span><span class=na>e</span><span class=p>(</span><span class=s>&quot;BNVHelper&quot;</span><span class=p>,</span> <span class=s>&quot;Unable to get shift mode field&quot;</span><span class=p>,</span> <span class=n>e</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>catch</span> <span class=p>(</span><span class=n>IllegalAccessException</span> <span class=n>e</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>Log</span><span class=p>.</span><span class=na>e</span><span class=p>(</span><span class=s>&quot;BNVHelper&quot;</span><span class=p>,</span> <span class=s>&quot;Unable to change value of shift mode&quot;</span><span class=p>,</span> <span class=n>e</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div> 只需要在获得BottomNavigationView后，调用上述方法即可： <div class=codehilite><pre><span></span><span class=n>BottomNavigationView</span> <span class=n>bottomNavigationView</span> <span class=o>=</span> <span class=p>(</span><span class=n>BottomNavigationView</span><span class=p>)</span> <span class=n>findViewById</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>id</span><span class=p>.</span><span class=na>bottom_navigation_bar</span><span class=p>);</span>
<span class=n>BottomNavigationViewHelper</span><span class=p>.</span><span class=na>disableShiftMode</span><span class=p>(</span><span class=n>bottomNavigationView</span><span class=p>);</span>
</pre></div> 来自StackOverflow的传送门：<a href=https://stackoverflow.com/questions/40176244/how-to-disable-bottomnavigationview-shift-mode>How to disable BottomNavigationView shift mode?</a></p> <p>想要知道为什么这样做可以解决这个问题，我们需要查看源码了。</p> <h3 id=22-bottomnavigationview>2.2 BottomNavigationView源码解析<a class=headerlink href=#22-bottomnavigationview title="Permanent link">&para;</a></h3> <p>首先看一下BottomNavigationView里面几个类成员变量：</p> <p><div class=codehilite><pre><span></span><span class=kd>private</span> <span class=kd>final</span> <span class=n>MenuBuilder</span> <span class=n>mMenu</span><span class=p>;</span>
<span class=kd>private</span> <span class=kd>final</span> <span class=n>BottomNavigationMenuView</span> <span class=n>mMenuView</span><span class=p>;</span>
<span class=kd>private</span> <span class=kd>final</span> <span class=n>BottomNavigationPresenter</span> <span class=n>mPresenter</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BottomNavigationPresenter</span><span class=p>();</span>
<span class=kd>private</span> <span class=n>MenuInflater</span> <span class=n>mMenuInflater</span><span class=p>;</span>

<span class=kd>private</span> <span class=n>OnNavigationItemSelectedListener</span> <span class=n>mListener</span><span class=p>;</span>
</pre></div> <code>mMenuInflater</code>用来将menu资源填充给<code>mMenu</code>，而<code>mPresenter</code>会在<code>BottomNavigationPresenter</code>内部调用<code>mMenuView.initialize(mMenu)</code>，将<code>mMenuView</code>与<code>mMenu</code>联系起来，这是一个简单的MVP模式的应用。<code>mListener</code>则是导航栏的回调接口了。</p> <p>我们接着看BottomNavigationView的构造方法： <div class=codehilite><pre><span></span><span class=kd>public</span> <span class=nf>BottomNavigationView</span><span class=p>(</span><span class=n>Context</span> <span class=n>context</span><span class=p>,</span> <span class=n>AttributeSet</span> <span class=n>attrs</span><span class=p>,</span> <span class=kt>int</span> <span class=n>defStyleAttr</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>super</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=n>attrs</span><span class=p>,</span> <span class=n>defStyleAttr</span><span class=p>);</span>

    <span class=c1>// Create the menu</span>
    <span class=n>mMenu</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BottomNavigationMenu</span><span class=p>(</span><span class=n>context</span><span class=p>);</span>

    <span class=n>mMenuView</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BottomNavigationMenuView</span><span class=p>(</span><span class=n>context</span><span class=p>);</span>
    <span class=n>FrameLayout</span><span class=p>.</span><span class=na>LayoutParams</span> <span class=n>params</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FrameLayout</span><span class=p>.</span><span class=na>LayoutParams</span><span class=p>(</span>
            <span class=n>ViewGroup</span><span class=p>.</span><span class=na>LayoutParams</span><span class=p>.</span><span class=na>WRAP_CONTENT</span><span class=p>,</span> <span class=n>ViewGroup</span><span class=p>.</span><span class=na>LayoutParams</span><span class=p>.</span><span class=na>WRAP_CONTENT</span><span class=p>);</span>
    <span class=n>params</span><span class=p>.</span><span class=na>gravity</span> <span class=o>=</span> <span class=n>Gravity</span><span class=p>.</span><span class=na>CENTER</span><span class=p>;</span>
    <span class=n>mMenuView</span><span class=p>.</span><span class=na>setLayoutParams</span><span class=p>(</span><span class=n>params</span><span class=p>);</span>

    <span class=n>mPresenter</span><span class=p>.</span><span class=na>setBottomNavigationMenuView</span><span class=p>(</span><span class=n>mMenuView</span><span class=p>);</span>
    <span class=n>mMenuView</span><span class=p>.</span><span class=na>setPresenter</span><span class=p>(</span><span class=n>mPresenter</span><span class=p>);</span>
    <span class=n>mMenu</span><span class=p>.</span><span class=na>addMenuPresenter</span><span class=p>(</span><span class=n>mPresenter</span><span class=p>);</span>
    <span class=n>mPresenter</span><span class=p>.</span><span class=na>initForMenu</span><span class=p>(</span><span class=n>getContext</span><span class=p>(),</span> <span class=n>mMenu</span><span class=p>);</span>

    <span class=c1>// Custom attributes</span>
    <span class=n>TintTypedArray</span> <span class=n>a</span> <span class=o>=</span> <span class=n>TintTypedArray</span><span class=p>.</span><span class=na>obtainStyledAttributes</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=n>attrs</span><span class=p>,</span>
            <span class=n>R</span><span class=p>.</span><span class=na>styleable</span><span class=p>.</span><span class=na>BottomNavigationView</span><span class=p>,</span> <span class=n>defStyleAttr</span><span class=p>,</span>
            <span class=n>R</span><span class=p>.</span><span class=na>style</span><span class=p>.</span><span class=na>Widget_Design_BottomNavigationView</span><span class=p>);</span>
    <span class=p>...</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=na>hasValue</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>styleable</span><span class=p>.</span><span class=na>BottomNavigationView_menu</span><span class=p>))</span> <span class=p>{</span>
        <span class=n>inflateMenu</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=na>getResourceId</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>styleable</span><span class=p>.</span><span class=na>BottomNavigationView_menu</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
    <span class=p>}</span>
    <span class=n>a</span><span class=p>.</span><span class=na>recycle</span><span class=p>();</span>
    <span class=p>...</span>
    <span class=n>mMenu</span><span class=p>.</span><span class=na>setCallback</span><span class=p>(</span><span class=k>new</span> <span class=n>MenuBuilder</span><span class=p>.</span><span class=na>Callback</span><span class=p>()</span> <span class=p>{</span>
        <span class=nd>@Override</span>
        <span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>onMenuItemSelected</span><span class=p>(</span><span class=n>MenuBuilder</span> <span class=n>menu</span><span class=p>,</span> <span class=n>MenuItem</span> <span class=n>item</span><span class=p>)</span> <span class=p>{</span>
            <span class=k>return</span> <span class=n>mListener</span> <span class=o>!=</span> <span class=kc>null</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>mListener</span><span class=p>.</span><span class=na>onNavigationItemSelected</span><span class=p>(</span><span class=n>item</span><span class=p>);</span>
        <span class=p>}</span>

        <span class=nd>@Override</span>
        <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onMenuModeChange</span><span class=p>(</span><span class=n>MenuBuilder</span> <span class=n>menu</span><span class=p>)</span> <span class=p>{}</span>
    <span class=p>});</span>
<span class=p>}</span>
</pre></div> 其构造方法就清晰的展示了<code>mMenu</code>、<code>mMenuView</code>的创建，<code>mPresenter</code>与两者的联系，以及如何填充menu，如何设置点击回调。</p> <p>我们看一下<code>mPresenter.initForMenu(getContext(), mMenu)</code>相关代码： <div class=codehilite><pre><span></span><span class=c1>// BottomNavigationPresenter#initForMenu</span>
<span class=nd>@Override</span>
<span class=kd>public</span> <span class=kt>void</span> <span class=nf>initForMenu</span><span class=p>(</span><span class=n>Context</span> <span class=n>context</span><span class=p>,</span> <span class=n>MenuBuilder</span> <span class=n>menu</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>mMenuView</span><span class=p>.</span><span class=na>initialize</span><span class=p>(</span><span class=n>mMenu</span><span class=p>);</span>
    <span class=n>mMenu</span> <span class=o>=</span> <span class=n>menu</span><span class=p>;</span>
<span class=p>}</span>

<span class=c1>// BottomNavigationMenuView#initialize</span>
<span class=nd>@Override</span>
<span class=kd>public</span> <span class=kt>void</span> <span class=nf>initialize</span><span class=p>(</span><span class=n>MenuBuilder</span> <span class=n>menu</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>mMenu</span> <span class=o>=</span> <span class=n>menu</span><span class=p>;</span>
<span class=p>}</span>
</pre></div> 我们可以看到，这个初始化操作只是将MenuBuilder传递到了BottomNavigationMenuView而已，并没有发生关键的操作。</p> <p>关键操作的发生来自于<code>BottomNavigationView</code>构造方法中填充menu的一段代码，我们跟踪一下。 <div class=codehilite><pre><span></span><span class=c1>// BottomNavigationView#BottomNavigationView(Context, AttributeSet, int)</span>
<span class=n>inflateMenu</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=na>getResourceId</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>styleable</span><span class=p>.</span><span class=na>BottomNavigationView_menu</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>

<span class=kd>public</span> <span class=kt>void</span> <span class=nf>inflateMenu</span><span class=p>(</span><span class=kt>int</span> <span class=n>resId</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>mPresenter</span><span class=p>.</span><span class=na>setUpdateSuspended</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
    <span class=n>getMenuInflater</span><span class=p>().</span><span class=na>inflate</span><span class=p>(</span><span class=n>resId</span><span class=p>,</span> <span class=n>mMenu</span><span class=p>);</span>
    <span class=n>mPresenter</span><span class=p>.</span><span class=na>setUpdateSuspended</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
    <span class=n>mPresenter</span><span class=p>.</span><span class=na>updateMenuView</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=p>}</span>
</pre></div> 我们可以看到在填充menu刚开始时，会置mUpdateSuspended为true，这样在填充menu未完成时，如果调用了<code>updateMenuView</code>，那么<code>updateMenuView</code>方法会立刻返回，不会往下面执行。这样可以避免异常情况出现。 接着，就会调用<code>getMenuInflater().inflate(resId, mMenu)</code>进行menu的填充。然后会置mUpdateSuspended为false，这样<code>updateMenuView</code>方法可以真正执行。</p> <p>在最后会调用<code>mPresenter.updateMenuView(true);</code>方法进行BottomNavigationMenuView的构建。我看看一下这个方法： <div class=codehilite><pre><span></span><span class=nd>@Override</span>
<span class=kd>public</span> <span class=kt>void</span> <span class=nf>updateMenuView</span><span class=p>(</span><span class=kt>boolean</span> <span class=n>cleared</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>mUpdateSuspended</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>cleared</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>mMenuView</span><span class=p>.</span><span class=na>buildMenuView</span><span class=p>();</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
        <span class=n>mMenuView</span><span class=p>.</span><span class=na>updateMenuView</span><span class=p>();</span>
    <span class=p>}</span>
<span class=p>}</span>
</pre></div></p> <p>接着就是BottomNavigationView控件的重头戏了，我们来到了BottomNavigationMenuView。我们看一下其<code>buildMenuView</code>方法： <div class=codehilite><pre><span></span><span class=kd>public</span> <span class=kt>void</span> <span class=nf>buildMenuView</span><span class=p>()</span> <span class=p>{</span>
    <span class=p>...</span>
    <span class=n>mButtons</span> <span class=o>=</span> <span class=k>new</span> <span class=n>BottomNavigationItemView</span><span class=o>[</span><span class=n>mMenu</span><span class=p>.</span><span class=na>size</span><span class=p>()</span><span class=o>]</span><span class=p>;</span>
    <span class=n>mShiftingMode</span> <span class=o>=</span> <span class=n>mMenu</span><span class=p>.</span><span class=na>size</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>;</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>mMenu</span><span class=p>.</span><span class=na>size</span><span class=p>();</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
        <span class=n>mPresenter</span><span class=p>.</span><span class=na>setUpdateSuspended</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
        <span class=n>mMenu</span><span class=p>.</span><span class=na>getItem</span><span class=p>(</span><span class=n>i</span><span class=p>).</span><span class=na>setCheckable</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
        <span class=n>mPresenter</span><span class=p>.</span><span class=na>setUpdateSuspended</span><span class=p>(</span><span class=kc>false</span><span class=p>);</span>
        <span class=n>BottomNavigationItemView</span> <span class=n>child</span> <span class=o>=</span> <span class=n>getNewItem</span><span class=p>();</span>
        <span class=n>mButtons</span><span class=o>[</span><span class=n>i</span><span class=o>]</span> <span class=o>=</span> <span class=n>child</span><span class=p>;</span>
        <span class=n>child</span><span class=p>.</span><span class=na>setIconTintList</span><span class=p>(</span><span class=n>mItemIconTint</span><span class=p>);</span>
        <span class=n>child</span><span class=p>.</span><span class=na>setTextColor</span><span class=p>(</span><span class=n>mItemTextColor</span><span class=p>);</span>
        <span class=n>child</span><span class=p>.</span><span class=na>setItemBackground</span><span class=p>(</span><span class=n>mItemBackgroundRes</span><span class=p>);</span>
        <span class=n>child</span><span class=p>.</span><span class=na>setShiftingMode</span><span class=p>(</span><span class=n>mShiftingMode</span><span class=p>);</span>
        <span class=n>child</span><span class=p>.</span><span class=na>initialize</span><span class=p>((</span><span class=n>MenuItemImpl</span><span class=p>)</span> <span class=n>mMenu</span><span class=p>.</span><span class=na>getItem</span><span class=p>(</span><span class=n>i</span><span class=p>),</span> <span class=mi>0</span><span class=p>);</span>
        <span class=n>child</span><span class=p>.</span><span class=na>setItemPosition</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
        <span class=n>child</span><span class=p>.</span><span class=na>setOnClickListener</span><span class=p>(</span><span class=n>mOnClickListener</span><span class=p>);</span>
        <span class=n>addView</span><span class=p>(</span><span class=n>child</span><span class=p>);</span>
    <span class=p>}</span>
    <span class=n>mActiveButton</span> <span class=o>=</span> <span class=n>Math</span><span class=p>.</span><span class=na>min</span><span class=p>(</span><span class=n>mMenu</span><span class=p>.</span><span class=na>size</span><span class=p>()</span> <span class=o>-</span> <span class=mi>1</span><span class=p>,</span> <span class=n>mActiveButton</span><span class=p>);</span>
    <span class=n>mMenu</span><span class=p>.</span><span class=na>getItem</span><span class=p>(</span><span class=n>mActiveButton</span><span class=p>).</span><span class=na>setChecked</span><span class=p>(</span><span class=kc>true</span><span class=p>);</span>
<span class=p>}</span>
</pre></div> 这里首先会根据menu的个数创建一个BottomNavigationItemView数组，每一个menu对应一个BottomNavigationItemView。然后会根据menu的个数是否大于3，来决定是否处于ShiftingMode。 <div class=codehilite><pre><span></span><span class=n>mShiftingMode</span> <span class=o>=</span> <span class=n>mMenu</span><span class=p>.</span><span class=na>size</span><span class=p>()</span> <span class=o>&gt;</span> <span class=mi>3</span><span class=p>;</span>
</pre></div> 然后循环给每一个Item设置ShiftingMode、OnClickListener等等属性。<br> 最后会设置初始的选中的Button，通过调用其<code>setChecked(boolean)</code>方法。</p> <p>我们看一下这个方法，该方法展示了ShiftingMode与非ShiftingMode下的动画效果。 <div class=codehilite><pre><span></span><span class=nd>@Override</span>
<span class=kd>public</span> <span class=kt>void</span> <span class=nf>setChecked</span><span class=p>(</span><span class=kt>boolean</span> <span class=n>checked</span><span class=p>)</span> <span class=p>{</span>
    <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setPivotX</span><span class=p>(</span><span class=n>mLargeLabel</span><span class=p>,</span> <span class=n>mLargeLabel</span><span class=p>.</span><span class=na>getWidth</span><span class=p>()</span> <span class=o>/</span> <span class=mi>2</span><span class=p>);</span>
    <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setPivotY</span><span class=p>(</span><span class=n>mLargeLabel</span><span class=p>,</span> <span class=n>mLargeLabel</span><span class=p>.</span><span class=na>getBaseline</span><span class=p>());</span>
    <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setPivotX</span><span class=p>(</span><span class=n>mSmallLabel</span><span class=p>,</span> <span class=n>mSmallLabel</span><span class=p>.</span><span class=na>getWidth</span><span class=p>()</span> <span class=o>/</span> <span class=mi>2</span><span class=p>);</span>
    <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setPivotY</span><span class=p>(</span><span class=n>mSmallLabel</span><span class=p>,</span> <span class=n>mSmallLabel</span><span class=p>.</span><span class=na>getBaseline</span><span class=p>());</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>mShiftingMode</span><span class=p>)</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>checked</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>LayoutParams</span> <span class=n>iconParams</span> <span class=o>=</span> <span class=p>(</span><span class=n>LayoutParams</span><span class=p>)</span> <span class=n>mIcon</span><span class=p>.</span><span class=na>getLayoutParams</span><span class=p>();</span>
            <span class=n>iconParams</span><span class=p>.</span><span class=na>gravity</span> <span class=o>=</span> <span class=n>Gravity</span><span class=p>.</span><span class=na>CENTER_HORIZONTAL</span> <span class=o>|</span> <span class=n>Gravity</span><span class=p>.</span><span class=na>TOP</span><span class=p>;</span>
            <span class=n>iconParams</span><span class=p>.</span><span class=na>topMargin</span> <span class=o>=</span> <span class=n>mDefaultMargin</span><span class=p>;</span>
            <span class=n>mIcon</span><span class=p>.</span><span class=na>setLayoutParams</span><span class=p>(</span><span class=n>iconParams</span><span class=p>);</span>
            <span class=n>mLargeLabel</span><span class=p>.</span><span class=na>setVisibility</span><span class=p>(</span><span class=n>VISIBLE</span><span class=p>);</span>
            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleX</span><span class=p>(</span><span class=n>mLargeLabel</span><span class=p>,</span> <span class=mf>1f</span><span class=p>);</span>
            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleY</span><span class=p>(</span><span class=n>mLargeLabel</span><span class=p>,</span> <span class=mf>1f</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
            <span class=n>LayoutParams</span> <span class=n>iconParams</span> <span class=o>=</span> <span class=p>(</span><span class=n>LayoutParams</span><span class=p>)</span> <span class=n>mIcon</span><span class=p>.</span><span class=na>getLayoutParams</span><span class=p>();</span>
            <span class=n>iconParams</span><span class=p>.</span><span class=na>gravity</span> <span class=o>=</span> <span class=n>Gravity</span><span class=p>.</span><span class=na>CENTER</span><span class=p>;</span>
            <span class=n>iconParams</span><span class=p>.</span><span class=na>topMargin</span> <span class=o>=</span> <span class=n>mDefaultMargin</span><span class=p>;</span>
            <span class=n>mIcon</span><span class=p>.</span><span class=na>setLayoutParams</span><span class=p>(</span><span class=n>iconParams</span><span class=p>);</span>
            <span class=n>mLargeLabel</span><span class=p>.</span><span class=na>setVisibility</span><span class=p>(</span><span class=n>INVISIBLE</span><span class=p>);</span>
            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleX</span><span class=p>(</span><span class=n>mLargeLabel</span><span class=p>,</span> <span class=mf>0.5f</span><span class=p>);</span>
            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleY</span><span class=p>(</span><span class=n>mLargeLabel</span><span class=p>,</span> <span class=mf>0.5f</span><span class=p>);</span>
        <span class=p>}</span>
        <span class=n>mSmallLabel</span><span class=p>.</span><span class=na>setVisibility</span><span class=p>(</span><span class=n>INVISIBLE</span><span class=p>);</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
        <span class=k>if</span> <span class=p>(</span><span class=n>checked</span><span class=p>)</span> <span class=p>{</span>
            <span class=n>LayoutParams</span> <span class=n>iconParams</span> <span class=o>=</span> <span class=p>(</span><span class=n>LayoutParams</span><span class=p>)</span> <span class=n>mIcon</span><span class=p>.</span><span class=na>getLayoutParams</span><span class=p>();</span>
            <span class=n>iconParams</span><span class=p>.</span><span class=na>gravity</span> <span class=o>=</span> <span class=n>Gravity</span><span class=p>.</span><span class=na>CENTER_HORIZONTAL</span> <span class=o>|</span> <span class=n>Gravity</span><span class=p>.</span><span class=na>TOP</span><span class=p>;</span>
            <span class=n>iconParams</span><span class=p>.</span><span class=na>topMargin</span> <span class=o>=</span> <span class=n>mDefaultMargin</span> <span class=o>+</span> <span class=n>mShiftAmount</span><span class=p>;</span>
            <span class=n>mIcon</span><span class=p>.</span><span class=na>setLayoutParams</span><span class=p>(</span><span class=n>iconParams</span><span class=p>);</span>
            <span class=n>mLargeLabel</span><span class=p>.</span><span class=na>setVisibility</span><span class=p>(</span><span class=n>VISIBLE</span><span class=p>);</span>
            <span class=n>mSmallLabel</span><span class=p>.</span><span class=na>setVisibility</span><span class=p>(</span><span class=n>INVISIBLE</span><span class=p>);</span>

            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleX</span><span class=p>(</span><span class=n>mLargeLabel</span><span class=p>,</span> <span class=mf>1f</span><span class=p>);</span>
            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleY</span><span class=p>(</span><span class=n>mLargeLabel</span><span class=p>,</span> <span class=mf>1f</span><span class=p>);</span>
            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleX</span><span class=p>(</span><span class=n>mSmallLabel</span><span class=p>,</span> <span class=n>mScaleUpFactor</span><span class=p>);</span>
            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleY</span><span class=p>(</span><span class=n>mSmallLabel</span><span class=p>,</span> <span class=n>mScaleUpFactor</span><span class=p>);</span>
        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
            <span class=n>LayoutParams</span> <span class=n>iconParams</span> <span class=o>=</span> <span class=p>(</span><span class=n>LayoutParams</span><span class=p>)</span> <span class=n>mIcon</span><span class=p>.</span><span class=na>getLayoutParams</span><span class=p>();</span>
            <span class=n>iconParams</span><span class=p>.</span><span class=na>gravity</span> <span class=o>=</span> <span class=n>Gravity</span><span class=p>.</span><span class=na>CENTER_HORIZONTAL</span> <span class=o>|</span> <span class=n>Gravity</span><span class=p>.</span><span class=na>TOP</span><span class=p>;</span>
            <span class=n>iconParams</span><span class=p>.</span><span class=na>topMargin</span> <span class=o>=</span> <span class=n>mDefaultMargin</span><span class=p>;</span>
            <span class=n>mIcon</span><span class=p>.</span><span class=na>setLayoutParams</span><span class=p>(</span><span class=n>iconParams</span><span class=p>);</span>
            <span class=n>mLargeLabel</span><span class=p>.</span><span class=na>setVisibility</span><span class=p>(</span><span class=n>INVISIBLE</span><span class=p>);</span>
            <span class=n>mSmallLabel</span><span class=p>.</span><span class=na>setVisibility</span><span class=p>(</span><span class=n>VISIBLE</span><span class=p>);</span>

            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleX</span><span class=p>(</span><span class=n>mLargeLabel</span><span class=p>,</span> <span class=n>mScaleDownFactor</span><span class=p>);</span>
            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleY</span><span class=p>(</span><span class=n>mLargeLabel</span><span class=p>,</span> <span class=n>mScaleDownFactor</span><span class=p>);</span>
            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleX</span><span class=p>(</span><span class=n>mSmallLabel</span><span class=p>,</span> <span class=mf>1f</span><span class=p>);</span>
            <span class=n>ViewCompat</span><span class=p>.</span><span class=na>setScaleY</span><span class=p>(</span><span class=n>mSmallLabel</span><span class=p>,</span> <span class=mf>1f</span><span class=p>);</span>
        <span class=p>}</span>
    <span class=p>}</span>

    <span class=n>refreshDrawableState</span><span class=p>();</span>
<span class=p>}</span>
</pre></div> 这里我们可以看出，上一小节就是mShiftingMode为true时产生的效果，所以我们只需要取消该模式即可。</p> <p>另外，强调一下，BottomNavigationView官方建议3~5个Item，如果超过五个会报错，代码在<code>BottomNavigationMenu#addInternal</code> <div class=codehilite><pre><span></span>@Override
protected MenuItem addInternal(int group, int id, int categoryOrder, CharSequence title) {
    if (size() + 1 &gt; MAX_ITEM_COUNT) {
        throw new IllegalArgumentException(
                &quot;Maximum number of items supported by BottomNavigationView is &quot; + MAX_ITEM_COUNT
                        + &quot;. Limit can be checked with BottomNavigationView#getMaxItemCount()&quot;);
    }
    ...
}
</pre></div></p> <h3 id=23>2.3 禁用选中项文字变大<a class=headerlink href=#23 title="Permanent link">&para;</a></h3> <p>另外我们关注第二个细节。</p> <p><img alt=第二个细节对比.png src=/assets/images/android/bottomnavigationbar-text-scale.png></p> <p>选中的Item，底下的文字会比没有选中的大一号。如果我们想改，也是有办法的。</p> <p>我们只需要在我们工程的<code>dimens.xml</code>中加入一行代码就OK了。 <div class=codehilite><pre><span></span><span class=nt>&lt;dimen</span> <span class=na>name=</span><span class=s>&quot;design_bottom_navigation_active_text_size&quot;</span><span class=nt>&gt;</span>12sp<span class=nt>&lt;/dimen&gt;</span>
</pre></div> 因为<code>design_bottom_navigation_text_size</code>表示未选择时文字的大小，这个值是12sp，而<code>design_bottom_navigation_active_text_size</code>表示选中的文字大小，这个值是14sp。<br> 我们只需要在我们自己的资源文件中取一个同名的资源就可以覆盖系统资源，这样就可以解决掉这个问题。</p> <p>具体可以从<code>BottomNavigationItemView</code>的构造方法中可以看出来： <div class=codehilite><pre><span></span><span class=kd>public</span> <span class=nf>BottomNavigationItemView</span><span class=p>(</span><span class=n>Context</span> <span class=n>context</span><span class=p>,</span> <span class=n>AttributeSet</span> <span class=n>attrs</span><span class=p>,</span> <span class=kt>int</span> <span class=n>defStyleAttr</span><span class=p>)</span> <span class=p>{</span>
    <span class=kd>super</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=n>attrs</span><span class=p>,</span> <span class=n>defStyleAttr</span><span class=p>);</span>
    <span class=kd>final</span> <span class=n>Resources</span> <span class=n>res</span> <span class=o>=</span> <span class=n>getResources</span><span class=p>();</span>
    <span class=kt>int</span> <span class=n>inactiveLabelSize</span> <span class=o>=</span>
            <span class=n>res</span><span class=p>.</span><span class=na>getDimensionPixelSize</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>dimen</span><span class=p>.</span><span class=na>design_bottom_navigation_text_size</span><span class=p>);</span>
    <span class=kt>int</span> <span class=n>activeLabelSize</span> <span class=o>=</span> <span class=n>res</span><span class=p>.</span><span class=na>getDimensionPixelSize</span><span class=p>(</span>
            <span class=n>R</span><span class=p>.</span><span class=na>dimen</span><span class=p>.</span><span class=na>design_bottom_navigation_active_text_size</span><span class=p>);</span>
    <span class=p>...</span>
    <span class=n>mScaleUpFactor</span> <span class=o>=</span> <span class=mf>1f</span> <span class=o>*</span> <span class=n>activeLabelSize</span> <span class=o>/</span> <span class=n>inactiveLabelSize</span><span class=p>;</span>
    <span class=n>mScaleDownFactor</span> <span class=o>=</span> <span class=mf>1f</span> <span class=o>*</span> <span class=n>inactiveLabelSize</span> <span class=o>/</span> <span class=n>activeLabelSize</span><span class=p>;</span>
    <span class=p>...</span>
<span class=p>}</span>
</pre></div> 结合上面贴出来的<code>setChecked</code>方法，可以判定是design_bottom_navigation_text_size与design_bottom_navigation_active_text_size不一样导致的。</p> <p>我们从AOSP源码中可以看到这两个值的大小：<a href=http://androidxref.com/7.1.1_r6/xref/frameworks/support/design/res/values/dimens.xml#62>frameworks/support/design/res/values/dimens.xml</a> <div class=codehilite><pre><span></span><span class=nt>&lt;dimen</span> <span class=na>name=</span><span class=s>&quot;design_bottom_navigation_text_size&quot;</span><span class=nt>&gt;</span>12sp<span class=nt>&lt;/dimen&gt;</span>
<span class=nt>&lt;dimen</span> <span class=na>name=</span><span class=s>&quot;design_bottom_navigation_active_text_size&quot;</span><span class=nt>&gt;</span>14sp<span class=nt>&lt;/dimen&gt;</span>
</pre></div> 所以我们只需要修改其中一个值，让其与另外一个相等就OK了。我选择修改选中状态的值，也就是design_bottom_navigation_active_text_size。</p> <h3 id=24-menuicon>2.4 控制Menu选中、未选中状态ICON、文字颜色<a class=headerlink href=#24-menuicon title="Permanent link">&para;</a></h3> <p>按照在本文第一节中的配置，系统会自动按照主题色给选中的Menu的ICON、文字渲染颜色。给文字渲染颜色很OK，但是给Menu渲染的时候，有可能不是我们想要的效果。</p> <p>按照第一节的设置，BottomNavigationView的表现如下：</p> <p><img alt=没有特意控制Menu渲染前 src=/assets/images/android/bottomnavigationbar未设置前.png></p> <p>在控制渲染后： <img alt=控制Menu渲染后 src=/assets/images/android/bottomnavigationbar未设置后.png></p> <p>通过上面对比知道，我们可以精确的控制Menu的文字、ICON在各种状态下显示的样子。</p> <p>具体实现其实很简单，可以使用selector控制，代码如下： <div class=codehilite><pre><span></span><span class=nt>&lt;android.support.design.widget.BottomNavigationView</span>
    <span class=na>android:id=</span><span class=s>&quot;@+id/bottom_navigation&quot;</span>
    <span class=na>android:layout_width=</span><span class=s>&quot;match_parent&quot;</span>
    <span class=na>android:layout_height=</span><span class=s>&quot;wrap_content&quot;</span>
    <span class=na>android:layout_alignParentBottom=</span><span class=s>&quot;true&quot;</span>
    <span class=na>android:background=</span><span class=s>&quot;@color/white&quot;</span>
    <span class=na>app:itemIconTint=</span><span class=s>&quot;@drawable/tab_text_color_selector&quot;</span>
    <span class=na>app:itemTextColor=</span><span class=s>&quot;@drawable/tab_text_color_selector&quot;</span>
    <span class=na>app:menu=</span><span class=s>&quot;@menu/menu_bottom_navigation&quot;</span> <span class=nt>/&gt;</span>
</pre></div> 上面新增了两个控制属性：<code>app:itemIconTint</code>以及<code>app:itemTextColor</code>，这两个分别控制各种状态下 <strong>非透明部分</strong> 图标的渲染以及文字的渲染。 </p> <p>也就是说想要达到上面渲染后的效果，还需要改menu文件里面的<code>android:icon</code>部分： <div class=codehilite><pre><span></span><span class=cp>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class=nt>&lt;menu</span> <span class=na>xmlns:android=</span><span class=s>&quot;http://schemas.android.com/apk/res/android&quot;</span><span class=nt>&gt;</span>
    <span class=nt>&lt;item</span>
        <span class=na>android:id=</span><span class=s>&quot;@+id/action_loan&quot;</span>
        <span class=na>android:icon=</span><span class=s>&quot;@drawable/tab_icon_bill_selector&quot;</span>
        <span class=na>android:title=</span><span class=s>&quot;账单&quot;</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;item</span>
        <span class=na>android:id=</span><span class=s>&quot;@+id/action_credit&quot;</span>
        <span class=na>android:icon=</span><span class=s>&quot;@drawable/tab_icon_credit_selector&quot;</span>
        <span class=na>android:title=</span><span class=s>&quot;信用&quot;</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;item</span>
        <span class=na>android:id=</span><span class=s>&quot;@+id/action_mine&quot;</span>
        <span class=na>android:icon=</span><span class=s>&quot;@drawable/tab_icon_me_selector&quot;</span>
        <span class=na>android:title=</span><span class=s>&quot;我&quot;</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/menu&gt;</span>
</pre></div></p> <p>icon的drawable如下： <div class=codehilite><pre><span></span><span class=cp>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class=nt>&lt;selector</span> <span class=na>xmlns:android=</span><span class=s>&quot;http://schemas.android.com/apk/res/android&quot;</span><span class=nt>&gt;</span>
    <span class=nt>&lt;item</span> <span class=na>android:drawable=</span><span class=s>&quot;@drawable/ic_tab_bill_s&quot;</span> <span class=na>android:state_checked=</span><span class=s>&quot;true&quot;</span> <span class=nt>/&gt;</span>
    <span class=nt>&lt;item</span> <span class=na>android:drawable=</span><span class=s>&quot;@drawable/ic_tab_bill_n&quot;</span> <span class=na>android:state_checked=</span><span class=s>&quot;false&quot;</span> <span class=nt>/&gt;</span>
<span class=nt>&lt;/selector&gt;</span>
</pre></div></p> <p>至此，三个麻烦的问题都解决了。BottomNavigationView的工作原理大致也过了一遍。</p> <h3 id=25-tint-icon>2.5 禁止tint icon<a class=headerlink href=#25-tint-icon title="Permanent link">&para;</a></h3> <p><code>BottomNavigationView</code>会默认给icon tint上颜色，即使没有指定<code>app:itemIconTint</code>。代码片段如下：</p> <div class=codehilite><pre><span></span><span class=k>if</span> <span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=na>hasValue</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>styleable</span><span class=p>.</span><span class=na>BottomNavigationView_itemIconTint</span><span class=p>))</span> <span class=p>{</span>
    <span class=n>mMenuView</span><span class=p>.</span><span class=na>setIconTintList</span><span class=p>(</span>
            <span class=n>a</span><span class=p>.</span><span class=na>getColorStateList</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>styleable</span><span class=p>.</span><span class=na>BottomNavigationView_itemIconTint</span><span class=p>));</span>
<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
    <span class=n>mMenuView</span><span class=p>.</span><span class=na>setIconTintList</span><span class=p>(</span>
            <span class=n>createDefaultColorStateList</span><span class=p>(</span><span class=n>android</span><span class=p>.</span><span class=na>R</span><span class=p>.</span><span class=na>attr</span><span class=p>.</span><span class=na>textColorSecondary</span><span class=p>));</span>
<span class=p>}</span>
</pre></div> <p>所以我们可以在代码中手动调用<code>setItemIconTintList(null)</code>来禁止tint icon。</p> <div class=codehilite><pre><span></span><span class=n>bottomNavigationView</span><span class=p>.</span><span class=n>itemIconTintList</span> <span class=p>=</span> <span class=k>null</span>
</pre></div> <p>该方法即使在Material库中的BNV也适用。</p> <p>BTW，禁用点击ripple效果可以设置<code>app:itemBackground="@null"</code>。</p> <h3 id=26-ripple>2.6 禁止点击ripple<a class=headerlink href=#26-ripple title="Permanent link">&para;</a></h3> <p><code>android.support.design.widget.BottomNavigationView</code>控件如果想禁止点击时的ripple效果，只需要设置<code>app:itemBackground</code>的值和<code>android:background</code>一样即可。</p> <h2 id=3-materialbnv>3. Material库中的BNV<a class=headerlink href=#3-materialbnv title="Permanent link">&para;</a></h2> <p>自从Google推出了androidx之后，原来design库有了新的替代品，而BottomNavigationView也有了新的包名<code>com.google.android.material.bottomnavigation.BottomNavigationView</code>。该组件在<code>com.google.android.material:material:x.x.x</code>中。 </p> <p>Material库中的BNV使用和之前的差不多，不过2.1节的<a href=#21-shiftingmode>禁用ShiftingMode模式</a>反射修改方式已经失效，毕竟两个库内部不太一样。新BNV提供了<code>app:itemHorizontalTranslationEnabled</code>和<code>app:labelVisibilityMode</code>方便开发者选择需要的样式。<br> <code>app:itemHorizontalTranslationEnabled</code>可以简单粗暴的控制ShiftingMode是否开启。<code>app:labelVisibilityMode</code>有四种值可以设置，对应的xml选项如下：</p> <table> <thead> <tr> <th>LabelVisibilityMode</th> <th>xml选项</th> <th>UI表现</th> </tr> </thead> <tbody> <tr> <td>LABEL_VISIBILITY_AUTO</td> <td>auto</td> <td>当item数量小于等于3时，表现和<code>labeled</code>一致；否则和<code>selected</code>一致</td> </tr> <tr> <td>LABEL_VISIBILITY_SELECTED</td> <td>selected</td> <td>label只会在选中的item上显示</td> </tr> <tr> <td>LABEL_VISIBILITY_LABELED</td> <td>labeled</td> <td>label会在所有的item上显示</td> </tr> <tr> <td>LABEL_VISIBILITY_UNLABELED</td> <td>unlabeled</td> <td>label会在所有的item上都不显示</td> </tr> </tbody> </table> <p>毫无疑问，我们只需要令<code>app:itemHorizontalTranslationEnabled="false"</code>和<code>app:labelVisibilityMode="labeled"</code>即可完成<a href=#21-shiftingmode>禁用ShiftingMode模式</a>的效果。 </p> <p>实际上，只需要令<code>app:labelVisibilityMode="labeled"</code>即可。因为，此时<code>BottomNavigationMenuView.isShifting</code>会返回false，轮不到短路与后面的<code>itemHorizontalTranslationEnabled</code>出手。</p> <figcaption>BottomNavigationMenuView代码片段</figcaption> <div class=codehilite><pre><span></span>  <span class=nd>@Override</span>
  <span class=kd>protected</span> <span class=kt>void</span> <span class=nf>onMeasure</span><span class=p>(</span><span class=kt>int</span> <span class=n>widthMeasureSpec</span><span class=p>,</span> <span class=kt>int</span> <span class=n>heightMeasureSpec</span><span class=p>)</span> <span class=p>{</span>
    <span class=p>...</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>isShifting</span><span class=p>(</span><span class=n>labelVisibilityMode</span><span class=p>,</span> <span class=n>visibleCount</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=n>itemHorizontalTranslationEnabled</span><span class=p>)</span> <span class=p>{</span>
      <span class=p>...</span>
    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
        <span class=p>...</span>
    <span class=p>}</span>
    <span class=p>...</span>
  <span class=p>}</span>

  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>buildMenuView</span><span class=p>()</span> <span class=p>{</span>
    <span class=p>...</span>
    <span class=kt>boolean</span> <span class=n>shifting</span> <span class=o>=</span> <span class=n>isShifting</span><span class=p>(</span><span class=n>labelVisibilityMode</span><span class=p>,</span> <span class=n>menu</span><span class=p>.</span><span class=na>getVisibleItems</span><span class=p>().</span><span class=na>size</span><span class=p>());</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>menu</span><span class=p>.</span><span class=na>size</span><span class=p>();</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
      <span class=p>...</span>
      <span class=n>child</span><span class=p>.</span><span class=na>setShifting</span><span class=p>(</span><span class=n>shifting</span><span class=p>);</span>
      <span class=p>...</span>
    <span class=p>}</span>
  <span class=p>}</span>

  <span class=kd>public</span> <span class=kt>void</span> <span class=nf>updateMenuView</span><span class=p>()</span> <span class=p>{</span>
    <span class=p>...</span>
    <span class=kt>boolean</span> <span class=n>shifting</span> <span class=o>=</span> <span class=n>isShifting</span><span class=p>(</span><span class=n>labelVisibilityMode</span><span class=p>,</span> <span class=n>menu</span><span class=p>.</span><span class=na>getVisibleItems</span><span class=p>().</span><span class=na>size</span><span class=p>());</span>
    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>menuSize</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
      <span class=p>...</span>
      <span class=n>buttons</span><span class=o>[</span><span class=n>i</span><span class=o>]</span><span class=p>.</span><span class=na>setShifting</span><span class=p>(</span><span class=n>shifting</span><span class=p>);</span>
      <span class=p>...</span>
    <span class=p>}</span>
  <span class=p>}</span>

  <span class=kd>private</span> <span class=kt>boolean</span> <span class=nf>isShifting</span><span class=p>(</span><span class=nd>@LabelVisibilityMode</span> <span class=kt>int</span> <span class=n>labelVisibilityMode</span><span class=p>,</span> <span class=kt>int</span> <span class=n>childCount</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=n>labelVisibilityMode</span> <span class=o>==</span> <span class=n>LabelVisibilityMode</span><span class=p>.</span><span class=na>LABEL_VISIBILITY_AUTO</span>
        <span class=o>?</span> <span class=n>childCount</span> <span class=o>&gt;</span> <span class=mi>3</span>
        <span class=p>:</span> <span class=n>labelVisibilityMode</span> <span class=o>==</span> <span class=n>LabelVisibilityMode</span><span class=p>.</span><span class=na>LABEL_VISIBILITY_SELECTED</span><span class=p>;</span>
  <span class=p>}</span>
</pre></div> <p>2.3节的<a href=#23>禁用选中项文字变大</a>仍然实用于新BNV中。因为<code>design_bottom_navigation_item.xml</code>中仍然使用了<code>design_bottom_navigation_text_size</code>、<code>design_bottom_navigation_active_text_size</code>作为两个label的默认大小。<br> 当然，我们也可以使用新BNV提供的<code>app:itemTextAppearanceActive</code>、<code>app:itemTextAppearanceInactive</code>来控制文字大小。</p> <p>此外，新BNV还提供了<code>app:itemIconSize</code>控制icon的大小。这样一来新BNV的可定制性就更强了。</p> <p>小结一下新BNV提供的常用可定制项：</p> <ul> <li>app:itemHorizontalTranslationEnabled</li> <li>app:labelVisibilityMode</li> <li>app:itemTextAppearanceActive</li> <li>app:itemTextAppearanceInactive</li> <li>app:itemIconSize</li> </ul> <hr> <div class=md-source-date> <small> 最后更新: 2020年1月14日 </small> </div> <h2 id=__comments>评论</h2> <div id=disqus_thread></div> <script>
    var disqus_config = function () {
      this.page.url = "https://blog.yorek.xyz/about-me/android/other/Android底部导航栏框架/";
      this.page.identifier =
        "/android/other/Android底部导航栏框架/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//yorekliu.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid"> <a href=../Android图片选择器/ title=Android图片选择器 class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> 上一页 </span> Android图片选择器 </span> </div> </a> <a href=../Android搜索栏的实现/ title=Android搜索栏的实现 class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis> <span class=md-footer-nav__direction> 下一页 </span> Android搜索栏的实现 </span> </div> <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> &copy; 2020 Yorek </div> powered by <a href=https://www.mkdocs.org>MkDocs</a> and <a href=https://squidfunk.github.io/mkdocs-material/ > Material for MkDocs</a> </div> <div class=md-footer-social> <link rel=stylesheet href=../../../assets/fonts/font-awesome.css> <a href=https://github.com/YorekLiu class="md-footer-social__link fa fa-github"></a> <a href=lyytogether@gmail.com class="md-footer-social__link fa fa-email"></a> </div> </div> </div> </footer> </div> <script src=../../../assets/javascripts/application.808e90bb.js></script> <script src=../../../assets/javascripts/lunr/lunr.stemmer.support.js></script> <script src=../../../assets/javascripts/lunr/tinyseg.js></script> <script src=../../../assets/javascripts/lunr/lunr.ja.js></script> <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>